diff --git a/programs/sndfile-deinterleave.c b/programs/sndfile-deinterleave.c
index e27593e..5cd52cc 100644
--- a/programs/sndfile-deinterleave.c
+++ b/programs/sndfile-deinterleave.c
@@ -89,6 +89,18 @@ main (int argc, char **argv)
 		exit (1) ;
 		} ;
 
+	/*
+	** state.outfile is a fixed-size array. A malformed input file can claim an
+	** arbitrarily large channel count which would otherwise cause out-of-bounds
+	** accesses of state.outfile and eventually pass an invalid SNDFILE* into
+	** sf_write_*(), crashing inside libsndfile.
+	*/
+	if (sfinfo.channels > MAX_CHANNELS)
+	{	printf ("\nError : Input file '%s' has too many channels (%d > %d).\n",
+				argv [1], sfinfo.channels, MAX_CHANNELS) ;
+		exit (0) ;
+		} ;
+
 	state.channels = sfinfo.channels ;
 	sfinfo.channels = 1 ;