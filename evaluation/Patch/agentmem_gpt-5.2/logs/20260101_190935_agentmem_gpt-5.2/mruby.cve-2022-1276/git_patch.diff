diff --git a/src/class.c b/src/class.c
index 37fc4e68a..0c3915cbe 100644
--- a/src/class.c
+++ b/src/class.c
@@ -1003,8 +1003,21 @@ mrb_get_args(mrb_state *mrb, const char *format, ...)
     mrb_assert(mrb_hash_p(kdict));
   }
 
+  /*
+   * Keyword-argument normalization/packing above can allocate objects and may
+   * grow/relocate the VM stack, invalidating cached pointers to callinfo/stack
+   * (ci/argv). Refresh them before dereferencing argv.
+   */
+  ci = mrb->c->ci;
+  argc = ci->n;
+  argv = ci->stack+1;
+
   argv_on_stack = argc < 15;
   if (!argv_on_stack) {
+    /* In packed-args mode, ci->stack[1] must be an Array. */
+    if (!mrb_array_p(*argv)) {
+      mrb_raise(mrb, E_ARGUMENT_ERROR, "invalid packed arguments");
+    }
     struct RArray *a = mrb_ary_ptr(*argv);
     argv = ARY_PTR(a);
     argc = ARY_LEN(a);