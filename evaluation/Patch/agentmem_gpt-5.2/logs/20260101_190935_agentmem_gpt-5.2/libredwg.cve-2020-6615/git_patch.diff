diff --git a/examples/dwg2svg2.c b/examples/dwg2svg2.c
index 60e38888..78df21ed 100644
--- a/examples/dwg2svg2.c
+++ b/examples/dwg2svg2.c
@@ -332,6 +332,15 @@ output_BLOCK_HEADER (dwg_object_ref *ref)
     }
 
   _hdr = dwg_object_to_BLOCK_HEADER (hdr);
+  if (!_hdr)
+    {
+      /* Malformed/corrupt input may reference objects which cannot be cast
+         to the requested type. Avoid passing NULL into dynapi accessors. */
+      fprintf (stderr,
+               "Invalid BLOCK_HEADER reference (could not cast object)\n");
+      return;
+    }
+
   dynget (_hdr, "BLOCK_HEADER", "name", &name);
   // name = dwg_obj_block_header_get_name (_hdr, &error);
   // log_if_error ("block_header_get_name");
diff --git a/src/dynapi.c b/src/dynapi.c
index 082d1784..f6211f31 100644
--- a/src/dynapi.c
+++ b/src/dynapi.c
@@ -7756,10 +7756,12 @@ dwg_dynapi_entity_value (void *restrict _obj, const char *restrict name,
                          const char *restrict fieldname,
                          void *restrict out, Dwg_DYNAPI_field *restrict fp)
 {
-#ifndef HAVE_NONNULL
+  /* Defensive: callers may pass NULL (or invalid) pointers.
+   * Do not compile out these checks; otherwise we may memcpy from near-NULL
+   * addresses (e.g. _obj==NULL and f->offset==0x10 -> read at 0x10).
+   */
   if (!_obj || !name || !fieldname || !out)
     return false;
-#endif
   {
     int error;
     const Dwg_Object* obj = dwg_obj_generic_to_object (_obj, &error);
@@ -7795,10 +7797,12 @@ dwg_dynapi_entity_utf8text (void *restrict _obj, const char *restrict name,
                             const char *restrict fieldname,
                             char **restrict out, Dwg_DYNAPI_field *restrict fp)
 {
-#ifndef HAVE_NONNULL
+  /* Defensive: callers may pass NULL (or invalid) pointers.
+   * Do not compile out these checks; otherwise we may memcpy from near-NULL
+   * addresses (e.g. _obj==NULL and f->offset==0x10 -> read at 0x10).
+   */
   if (!_obj || !name || !fieldname || !out)
     return false;
-#endif
   {
     int error;
     const Dwg_Object* obj = dwg_obj_generic_to_object (_obj, &error);