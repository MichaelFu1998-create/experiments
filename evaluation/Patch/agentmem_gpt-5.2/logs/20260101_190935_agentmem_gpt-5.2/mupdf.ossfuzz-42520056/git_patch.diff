diff --git a/source/pdf/pdf-cmap-parse.c b/source/pdf/pdf-cmap-parse.c
index 07881da5a..97775184a 100644
--- a/source/pdf/pdf-cmap-parse.c
+++ b/source/pdf/pdf-cmap-parse.c
@@ -243,7 +243,12 @@ pdf_parse_bf_range_array(fz_context *ctx, pdf_cmap *cmap, fz_stream *file, pdf_l
 			for (i = 0; i < len; i++)
 				dst[i] = pdf_code_from_string(&buf->scratch[i * 2], 2);
 
-			pdf_map_one_to_many(ctx, cmap, lo, dst, buf->len / 2);
+			/*
+			 * dst is a fixed-size stack buffer. We may have clamped the number of
+			 * converted 2-byte codes to fit; make sure we pass the clamped length
+			 * through to avoid out-of-bounds reads/writes in pdf_map_one_to_many.
+			 */
+			pdf_map_one_to_many(ctx, cmap, lo, dst, len);
 		}
 
 		lo ++;