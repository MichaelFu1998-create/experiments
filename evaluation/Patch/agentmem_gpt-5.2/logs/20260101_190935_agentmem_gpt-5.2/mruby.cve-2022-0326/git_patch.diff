diff --git a/src/variable.c b/src/variable.c
index 53b760d0f..32bb6e169 100644
--- a/src/variable.c
+++ b/src/variable.c
@@ -229,7 +229,17 @@ iv_copy(mrb_state *mrb, iv_tbl *t)
 static void
 iv_free(mrb_state *mrb, iv_tbl *t)
 {
-  mrb_free(mrb, t->ptr);
+  /*
+   * Hardening: `iv_tbl*` must be either NULL or a valid heap pointer.
+   * During shutdown/GC, stale or tagged/invalid values can reach here and
+   * would crash when dereferencing `t->ptr`.
+   */
+  if (t == NULL) return;
+  if ((uintptr_t)t < 0x1000) return; /* avoid zero-page / tagged pointers */
+
+  if (t->ptr) {
+    mrb_free(mrb, t->ptr);
+  }
   mrb_free(mrb, t);
 }
 
@@ -255,8 +265,11 @@ mrb_gc_mark_gv(mrb_state *mrb)
 void
 mrb_gc_free_gv(mrb_state *mrb)
 {
-  if (mrb->globals)
-    iv_free(mrb, mrb->globals);
+  if (mrb->globals) {
+    iv_tbl *t = mrb->globals;
+    mrb->globals = NULL;          /* make teardown idempotent */
+    iv_free(mrb, t);
+  }
 }
 
 void
@@ -275,7 +288,9 @@ void
 mrb_gc_free_iv(mrb_state *mrb, struct RObject *obj)
 {
   if (obj->iv) {
-    iv_free(mrb, obj->iv);
+    iv_tbl *t = obj->iv;
+    obj->iv = NULL;               /* make teardown idempotent */
+    iv_free(mrb, t);
   }
 }