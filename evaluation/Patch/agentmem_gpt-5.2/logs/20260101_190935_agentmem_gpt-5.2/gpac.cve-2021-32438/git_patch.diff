diff --git a/src/media_tools/media_export.c b/src/media_tools/media_export.c
index b89936f83..dce7f55db 100644
--- a/src/media_tools/media_export.c
+++ b/src/media_tools/media_export.c
@@ -1108,11 +1108,16 @@ static GF_Err gf_media_export_filters(GF_MediaExporter *dumper)
 		}
 		esd = gf_media_map_esd(dumper->file, track_num, 0);
 		sample_count = gf_isom_get_sample_count(dumper->file, dumper->trackID);
-		if (esd) {
+		/* Some malformed files may provide an ESD without a DecoderConfig.
+		   Do not assume nested pointers are valid. */
+		if (esd && esd->decoderConfig) {
 			if (esd->decoderConfig->objectTypeIndication<GF_CODECID_LAST_MPEG4_MAPPING) {
 				codec_id = gf_codecid_from_oti(esd->decoderConfig->streamType, esd->decoderConfig->objectTypeIndication);
 #ifndef GPAC_DISABLE_AV_PARSERS
-				if (esd->decoderConfig->decoderSpecificInfo && (codec_id==GF_CODECID_AAC_MPEG4)) {
+				if (esd->decoderConfig->decoderSpecificInfo
+					&& esd->decoderConfig->decoderSpecificInfo->data
+					&& esd->decoderConfig->decoderSpecificInfo->dataLength
+					&& (codec_id==GF_CODECID_AAC_MPEG4)) {
 					GF_M4ADecSpecInfo acfg;
 					gf_m4a_get_config(esd->decoderConfig->decoderSpecificInfo->data, esd->decoderConfig->decoderSpecificInfo->dataLength, &acfg);
 					if (acfg.base_object_type == GF_M4A_USAC)