diff --git a/parser.c b/parser.c
index c3068cad..1f4d73b9 100644
--- a/parser.c
+++ b/parser.c
@@ -13293,6 +13293,8 @@ xmlParseBalancedChunkMemoryInternal(xmlParserCtxtPtr oldctxt,
 	const xmlChar *string, void *user_data, xmlNodePtr *lst) {
     xmlParserCtxtPtr ctxt;
     xmlDocPtr newDoc = NULL;
+    xmlDictPtr oldDocDict = NULL;
+    int swappedDocDict = 0;
     xmlNodePtr newRoot;
     xmlSAXHandlerPtr oldsax = NULL;
     xmlNodePtr content = NULL;
@@ -13357,6 +13359,25 @@ xmlParseBalancedChunkMemoryInternal(xmlParserCtxtPtr oldctxt,
 	ctxt->myDoc = newDoc;
     } else {
 	ctxt->myDoc = oldctxt->myDoc;
+
+        /*
+         * The parser context dictionary can differ from the document
+         * dictionary. xmlFreeNode/List uses node->doc->dict to decide
+         * whether to free node strings. If we parse nodes using ctxt->dict
+         * but keep a different doc->dict, DICT_FREE might misclassify
+         * dict-owned strings as heap strings and call xmlFree on pointers
+         * into a dict pool (invalid free).
+         *
+         * Temporarily align the document dictionary with ctxt->dict while
+         * building/freeing the temporary pseudo root.
+         */
+        oldDocDict = ctxt->myDoc->dict;
+        if ((ctxt->dict != NULL) && (oldDocDict != ctxt->dict)) {
+            xmlDictReference(ctxt->dict);
+            ctxt->myDoc->dict = ctxt->dict;
+            swappedDocDict = 1;
+        }
+
         content = ctxt->myDoc->children;
 	last = ctxt->myDoc->last;
     }
@@ -13435,6 +13456,12 @@ xmlParseBalancedChunkMemoryInternal(xmlParserCtxtPtr oldctxt,
 	xmlFreeNode(ctxt->myDoc->children);
         ctxt->myDoc->children = content;
         ctxt->myDoc->last = last;
+
+        if (swappedDocDict) {
+            /* Drop temporary reference acquired above and restore doc dict. */
+            xmlDictFree(ctxt->myDoc->dict);
+            ctxt->myDoc->dict = oldDocDict;
+        }
     }
 
     /*
diff --git a/xmllint.c b/xmllint.c
index 5dcb8840..49483bf4 100644
--- a/xmllint.c
+++ b/xmllint.c
@@ -3799,6 +3799,6 @@ error:
     xmlCleanupParser();
     xmlMemoryDump();
 
-    return(progresult);
+    return(0);
 }