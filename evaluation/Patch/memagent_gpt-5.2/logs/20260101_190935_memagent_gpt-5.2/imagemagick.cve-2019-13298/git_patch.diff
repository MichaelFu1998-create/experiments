diff --git a/MagickCore/enhance.c b/MagickCore/enhance.c
index ed3202757..fd4c313e0 100644
--- a/MagickCore/enhance.c
+++ b/MagickCore/enhance.c
@@ -1973,7 +1973,14 @@ MagickExport Image *EnhanceImage(const Image *image,ExceptionInfo *exception)
           pixel.black=((aggregate.black+total_weight/2.0)/total_weight);
           pixel.alpha=((aggregate.alpha+total_weight/2.0)/total_weight);
         }
-      SetPixelViaPixelInfo(image,&pixel,q);
+      /*
+        q points into enhance_image's pixel cache.  SetPixelViaPixelInfo()
+        indexes into the pixel buffer using the Image's channel map/offsets,
+        so we must pass the destination image (enhance_image) to avoid
+        out-of-bounds writes when the source and destination channel layouts
+        differ.
+      */
+      SetPixelViaPixelInfo(enhance_image,&pixel,q);
       p+=GetPixelChannels(image);
       q+=GetPixelChannels(enhance_image);
     }