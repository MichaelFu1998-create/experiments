diff --git a/coders/pnm.c b/coders/pnm.c
index a54bc60c3..1e280b6f2 100644
--- a/coders/pnm.c
+++ b/coders/pnm.c
@@ -1759,12 +1759,18 @@ static MagickBooleanType WritePNMImage(const ImageInfo *image_info,Image *image,
             *q++=' ';
             if ((q-pixels+1) >= (ssize_t) sizeof(pixels))
               {
-                *q++='\n';
+                /* Buffer full: flush without appending another byte. */
                 (void) WriteBlob(image,q-pixels,pixels);
                 q=pixels;
               }
             p+=GetPixelChannels(image);
           }
+          if ((q-pixels+1) >= (ssize_t) sizeof(pixels))
+            {
+              if (q != pixels)
+                (void) WriteBlob(image,q-pixels,pixels);
+              q=pixels;
+            }
           *q++='\n';
           (void) WriteBlob(image,q-pixels,pixels);
           q=pixels;
@@ -1778,6 +1784,11 @@ static MagickBooleanType WritePNMImage(const ImageInfo *image_info,Image *image,
         }
         if (q != pixels)
           {
+            if ((q-pixels+1) >= (ssize_t) sizeof(pixels))
+              {
+                (void) WriteBlob(image,q-pixels,pixels);
+                q=pixels;
+              }
             *q++='\n';
             (void) WriteBlob(image,q-pixels,pixels);
           }
@@ -1824,16 +1835,38 @@ static MagickBooleanType WritePNMImage(const ImageInfo *image_info,Image *image,
                 count=(ssize_t) FormatLocaleString(buffer,MagickPathExtent,
                   "%u ",ScaleQuantumToLong(index));
             extent=(size_t) count;
-            (void) strncpy((char *) q,buffer,extent);
-            q+=extent;
-            if ((q-pixels+extent+2) >= sizeof(pixels))
+            /*
+              Append the formatted pixel string safely.  Flush BEFORE copying
+              when there is insufficient space in the stack buffer.
+            */
+            if (extent >= sizeof(pixels))
               {
-                *q++='\n';
-                (void) WriteBlob(image,q-pixels,pixels);
-                q=pixels;
+                if (q != pixels)
+                  {
+                    (void) WriteBlob(image,q-pixels,pixels);
+                    q=pixels;
+                  }
+                (void) WriteBlob(image,extent,buffer);
+              }
+            else
+              {
+                if (((size_t) (q-pixels) + extent) >= sizeof(pixels))
+                  {
+                    if (q != pixels)
+                      (void) WriteBlob(image,q-pixels,pixels);
+                    q=pixels;
+                  }
+                (void) memcpy(q,buffer,extent);
+                q+=extent;
               }
             p+=GetPixelChannels(image);
           }
+          if ((q-pixels+1) >= (ssize_t) sizeof(pixels))
+            {
+              if (q != pixels)
+                (void) WriteBlob(image,q-pixels,pixels);
+              q=pixels;
+            }
           *q++='\n';
           (void) WriteBlob(image,q-pixels,pixels);
           q=pixels;
@@ -1847,6 +1880,11 @@ static MagickBooleanType WritePNMImage(const ImageInfo *image_info,Image *image,
         }
         if (q != pixels)
           {
+            if ((q-pixels+1) >= (ssize_t) sizeof(pixels))
+              {
+                (void) WriteBlob(image,q-pixels,pixels);
+                q=pixels;
+              }
             *q++='\n';
             (void) WriteBlob(image,q-pixels,pixels);
           }
@@ -1899,16 +1937,38 @@ static MagickBooleanType WritePNMImage(const ImageInfo *image_info,Image *image,
                   ScaleQuantumToLong(GetPixelGreen(image,p)),
                   ScaleQuantumToLong(GetPixelBlue(image,p)));
             extent=(size_t) count;
-            (void) strncpy((char *) q,buffer,extent);
-            q+=extent;
-            if ((q-pixels+extent+2) >= sizeof(pixels))
+            /*
+              Append the formatted pixel string safely.  Flush BEFORE copying
+              when there is insufficient space in the stack buffer.
+            */
+            if (extent >= sizeof(pixels))
               {
-                *q++='\n';
-                (void) WriteBlob(image,q-pixels,pixels);
-                q=pixels;
+                if (q != pixels)
+                  {
+                    (void) WriteBlob(image,q-pixels,pixels);
+                    q=pixels;
+                  }
+                (void) WriteBlob(image,extent,buffer);
+              }
+            else
+              {
+                if (((size_t) (q-pixels) + extent) >= sizeof(pixels))
+                  {
+                    if (q != pixels)
+                      (void) WriteBlob(image,q-pixels,pixels);
+                    q=pixels;
+                  }
+                (void) memcpy(q,buffer,extent);
+                q+=extent;
               }
             p+=GetPixelChannels(image);
           }
+          if ((q-pixels+1) >= (ssize_t) sizeof(pixels))
+            {
+              if (q != pixels)
+                (void) WriteBlob(image,q-pixels,pixels);
+              q=pixels;
+            }
           *q++='\n';
           (void) WriteBlob(image,q-pixels,pixels);
           q=pixels;
@@ -1922,6 +1982,11 @@ static MagickBooleanType WritePNMImage(const ImageInfo *image_info,Image *image,
         }
         if (q != pixels)
           {
+            if ((q-pixels+1) >= (ssize_t) sizeof(pixels))
+              {
+                (void) WriteBlob(image,q-pixels,pixels);
+                q=pixels;
+              }
             *q++='\n';
             (void) WriteBlob(image,q-pixels,pixels);
           }