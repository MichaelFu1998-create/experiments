diff --git a/build/android/jni/libgpac/config.h b/build/android/jni/libgpac/config.h
deleted file mode 100644
index 20890847f..000000000
--- a/build/android/jni/libgpac/config.h
+++ /dev/null
@@ -1,24 +0,0 @@
-
-#ifndef GF_CONFIG_H
-#define GF_CONFIG_H
-
-#define GPAC_CONFIG_LINUX 1
-#define GPAC_HAS_QJS 1
-#define GPAC_HAS_MEDIACODEC
-#define GPAC_HAS_JPEG 1
-#define GPAC_HAS_JP2 1
-#define GPAC_HAS_PNG 1
-#define GPAC_HAS_FFMPEG 1
-#define GPAC_HAS_FAAD 1
-#define GPAC_HAS_MAD 1
-#define GPAC_HAS_HTTP2
-#define GPAC_HAS_SSL
-#define GPAC_HAS_LIBCAPTION
-#define GPAC_HAS_MPEGHDECODER
-
-#define GPAC_USE_GLES2 1
-//#define GPAC_FIXED_POINT 1
-
-#define GPAC_CONFIGURATION "(android configuration file)"
-
-#endif
diff --git a/build/deprecated/symbian/symbian_dll_entry.cpp b/build/deprecated/symbian/symbian_dll_entry.cpp
deleted file mode 100644
index 9a05410c7..000000000
--- a/build/deprecated/symbian/symbian_dll_entry.cpp
+++ /dev/null
@@ -1,9 +0,0 @@
-
-#include <gpac/setup.h>
-#include <e32std.h>
-
-#ifndef EKA2
-GLDEF_C s32 E32Dll(TDllReason /*aReason*/) {
-	return 0;
-}
-#endif
diff --git a/src/media_tools/avilib.c b/src/media_tools/avilib.c
index 7cdca7d87..4339caa86 100644
--- a/src/media_tools/avilib.c
+++ b/src/media_tools/avilib.c
@@ -1887,6 +1887,15 @@ int avi_parse_input_file(avi_t *AVI, int getIndex)
 	int rate, scale, idx_type;
 	s64 n, i;
 	unsigned char *hdrl_data;
+	hdrl_data = NULL;
+
+	/* Ensure hdrl_data is always released on parse errors (ERR_EXIT only frees AVI) */
+	#define PARSE_ERR_EXIT(x) \
+	{ \
+		if (hdrl_data) { gf_free(hdrl_data); hdrl_data = NULL; } \
+		ERR_EXIT(x) \
+	}
+
 	u64 header_offset=0;
 	int hdrl_len=0;
 	int nvi, nai[AVI_MAX_TRACKS], ioff;
@@ -1909,10 +1918,10 @@ int avi_parse_input_file(avi_t *AVI, int getIndex)
 
 	/* Read first 12 bytes and check that this is an AVI file */
 	if (avi_read(AVI->fdes,data,12) != 12 )
-		ERR_EXIT(AVI_ERR_READ)
+		PARSE_ERR_EXIT(AVI_ERR_READ)
 
 	if (strnicmp(data  ,"RIFF",4) !=0 || strnicmp(data+8,"AVI ",4) !=0 )
-		ERR_EXIT(AVI_ERR_NO_AVI)
+		PARSE_ERR_EXIT(AVI_ERR_NO_AVI)
 
 	/* Go through the AVI file and extract the header list,
 	   the start position of the 'movi' list and an optionally
@@ -1920,6 +1929,9 @@ int avi_parse_input_file(avi_t *AVI, int getIndex)
 
 	hdrl_data = 0;
 
+	/* Ensure hdrl_data is always released on parse errors (ERR_EXIT only frees AVI) */
+
+
 	while(1)
 	{
 		if( avi_read(AVI->fdes,data,8) != 8 ) break; /* We assume it's EOF */
@@ -1935,20 +1947,20 @@ int avi_parse_input_file(avi_t *AVI, int getIndex)
 
 		if(strnicmp(data,"LIST",4) == 0)
 		{
-			if( avi_read(AVI->fdes,data,4) != 4 ) ERR_EXIT(AVI_ERR_READ)
+			if( avi_read(AVI->fdes,data,4) != 4 ) PARSE_ERR_EXIT(AVI_ERR_READ)
 				n -= 4;
 			if(strnicmp(data,"hdrl",4) == 0)
 			{
-				if (n>0xFFFFFFFF) ERR_EXIT(AVI_ERR_READ)
+				if (n>0xFFFFFFFF) PARSE_ERR_EXIT(AVI_ERR_READ)
 				hdrl_len = (u32) n;
 				hdrl_data = (unsigned char *) gf_malloc((u32)n);
-				if(hdrl_data==0) ERR_EXIT(AVI_ERR_NO_MEM);
+				if(hdrl_data==0) PARSE_ERR_EXIT(AVI_ERR_NO_MEM);
 
 				// offset of header
 
 				header_offset = gf_ftell(AVI->fdes);
 
-				if( avi_read(AVI->fdes,(char *)hdrl_data, (u32) n) != n ) ERR_EXIT(AVI_ERR_READ)
+				if( avi_read(AVI->fdes,(char *)hdrl_data, (u32) n) != n ) PARSE_ERR_EXIT(AVI_ERR_READ)
 				}
 			else if(strnicmp(data,"movi",4) == 0)
 			{
@@ -1964,7 +1976,7 @@ int avi_parse_input_file(avi_t *AVI, int getIndex)
 
 			AVI->n_idx = AVI->max_idx = (u32) (n/16);
 			AVI->idx = (unsigned  char((*)[16]) ) gf_malloc((u32)n);
-			if(AVI->idx==0) ERR_EXIT(AVI_ERR_NO_MEM)
+			if(AVI->idx==0) PARSE_ERR_EXIT(AVI_ERR_NO_MEM)
 				if(avi_read(AVI->fdes, (char *) AVI->idx, (u32) n) != n ) {
 					gf_free( AVI->idx);
 					AVI->idx=NULL;
@@ -1975,8 +1987,8 @@ int avi_parse_input_file(avi_t *AVI, int getIndex)
 			gf_fseek(AVI->fdes,n,SEEK_CUR);
 	}
 
-	if(!hdrl_data      ) ERR_EXIT(AVI_ERR_NO_HDRL)
-		if(!AVI->movi_start) ERR_EXIT(AVI_ERR_NO_MOVI)
+	if(!hdrl_data      ) PARSE_ERR_EXIT(AVI_ERR_NO_HDRL)
+		if(!AVI->movi_start) PARSE_ERR_EXIT(AVI_ERR_NO_MOVI)
 
 			/* Interpret the header list */
 
@@ -1995,7 +2007,8 @@ int avi_parse_input_file(avi_t *AVI, int getIndex)
 
 				n = str2ulong(hdrl_data+i+4);
 				n = PAD_EVEN(n);
-				if (i+n>hdrl_len) ERR_EXIT(AVI_ERR_READ)
+				/* size field does not include the 8-byte tag header */
+				if (i + 8 + n > hdrl_len) PARSE_ERR_EXIT(AVI_ERR_READ)
 
 
 				/* Interpret the tag and its args */
@@ -2071,17 +2084,29 @@ int avi_parse_input_file(avi_t *AVI, int getIndex)
 				}
 				else if(strnicmp((char *)hdrl_data+i,"strf",4)==0)
 				{
+					s64 chunk_size = n;
 					i += 8;
 					if(lasttag == 1)
 					{
 						alBITMAPINFOHEADER bih;
 
+						u32 bi_size;
+
+						/* The video format ('strf') chunk must at least contain a BITMAPINFOHEADER.
+						   Do not trust biSize beyond the current chunk payload. */
+						if (chunk_size < (s64) sizeof(alBITMAPINFOHEADER))
+							PARSE_ERR_EXIT(AVI_ERR_READ)
+
 						memcpy(&bih, hdrl_data + i, sizeof(alBITMAPINFOHEADER));
+						bi_size = str2ulong((unsigned char *)&bih.bi_size);
+						/* biSize is untrusted - clamp to available chunk payload to avoid over-reads */
+						if (bi_size < sizeof(alBITMAPINFOHEADER)) bi_size = sizeof(alBITMAPINFOHEADER);
+						if (bi_size > (u32) chunk_size) bi_size = (u32) chunk_size;
 						AVI->bitmap_info_header = (alBITMAPINFOHEADER *)
-						                          gf_malloc(str2ulong((unsigned char *)&bih.bi_size));
+						                          gf_malloc(bi_size);
 						if (AVI->bitmap_info_header != NULL)
 							memcpy(AVI->bitmap_info_header, hdrl_data + i,
-							       str2ulong((unsigned char *)&bih.bi_size));
+							       bi_size);
 
 						AVI->width  = str2ulong(hdrl_data+i+4);
 						AVI->height = str2ulong(hdrl_data+i+8);
@@ -2092,11 +2117,11 @@ int avi_parse_input_file(avi_t *AVI, int getIndex)
 						memcpy(AVI->compressor2, hdrl_data+i+16, 4);
 						AVI->compressor2[4] = 0;
 
-						if (n>40) {
-							if (n>0xFFFFFFFF) ERR_EXIT(AVI_ERR_READ)
-							AVI->extradata_size = (u32) (n - 40);
+						if (chunk_size>40) {
+							if (n>0xFFFFFFFF) PARSE_ERR_EXIT(AVI_ERR_READ)
+							AVI->extradata_size = (u32) (chunk_size - 40);
 							AVI->extradata = gf_malloc(sizeof(u8)* AVI->extradata_size);
-							if (!AVI->extradata) ERR_EXIT(AVI_ERR_NO_MEM)
+							if (!AVI->extradata) PARSE_ERR_EXIT(AVI_ERR_NO_MEM)
 							memcpy(AVI->extradata, hdrl_data + i + 40, AVI->extradata_size);
 						}
 
@@ -2107,8 +2132,9 @@ int avi_parse_input_file(avi_t *AVI, int getIndex)
 						char *nwfe;
 						int wfes;
 
-						if ((u32) (hdrl_len - i) < sizeof(alWAVEFORMATEX))
-							wfes = (int) (hdrl_len - i);
+						/* do not read beyond current 'strf' chunk */
+						if (chunk_size < (s64) sizeof(alWAVEFORMATEX))
+							wfes = (int) chunk_size;
 						else
 							wfes = sizeof(alWAVEFORMATEX);
 						wfe = (alWAVEFORMATEX *)gf_malloc(sizeof(alWAVEFORMATEX));
@@ -2300,7 +2326,7 @@ int avi_parse_input_file(avi_t *AVI, int getIndex)
 
 	gf_free(hdrl_data);
 
-	if(!vids_strh_seen || !vids_strf_seen) ERR_EXIT(AVI_ERR_NO_VIDS)
+	if(!vids_strh_seen || !vids_strf_seen) PARSE_ERR_EXIT(AVI_ERR_NO_VIDS)
 
 		AVI->video_tag[0] = AVI->video_strn/10 + '0';
 	AVI->video_tag[1] = AVI->video_strn%10 + '0';
@@ -2340,13 +2366,13 @@ int avi_parse_input_file(avi_t *AVI, int getIndex)
 
 		for(i=0; i<AVI->n_idx; i++)
 			if( strnicmp((char *)AVI->idx[i],(char *)AVI->video_tag,3)==0 ) break;
-		if(i>=AVI->n_idx) ERR_EXIT(AVI_ERR_NO_VIDS)
+		if(i>=AVI->n_idx) PARSE_ERR_EXIT(AVI_ERR_NO_VIDS)
 
 			pos = str2ulong(AVI->idx[i]+ 8);
 		len = str2ulong(AVI->idx[i]+12);
 
 		gf_fseek(AVI->fdes,pos,SEEK_SET);
-		if(avi_read(AVI->fdes,data,8)!=8) ERR_EXIT(AVI_ERR_READ)
+		if(avi_read(AVI->fdes,data,8)!=8) PARSE_ERR_EXIT(AVI_ERR_READ)
 			if( strnicmp(data,(char *)AVI->idx[i],4)==0 && str2ulong((unsigned char *)data+4)==len )
 			{
 				idx_type = 1; /* Index from start of file */
@@ -2354,7 +2380,7 @@ int avi_parse_input_file(avi_t *AVI, int getIndex)
 			else
 			{
 				gf_fseek(AVI->fdes,pos+AVI->movi_start-4,SEEK_SET);
-				if(avi_read(AVI->fdes,data,8)!=8) ERR_EXIT(AVI_ERR_READ)
+				if(avi_read(AVI->fdes,data,8)!=8) PARSE_ERR_EXIT(AVI_ERR_READ)
 					if( strnicmp(data,(char *)AVI->idx[i],4)==0 && str2ulong((unsigned char *)data+4)==len )
 					{
 						idx_type = 2; /* Index from start of movi list */
@@ -2581,13 +2607,13 @@ multiple_riff:
 
 		AVI->video_index = (video_index_entry *) gf_malloc(nvi*sizeof(video_index_entry));
 
-		if(AVI->video_index==0) ERR_EXIT(AVI_ERR_NO_MEM);
+		if(AVI->video_index==0) PARSE_ERR_EXIT(AVI_ERR_NO_MEM);
 
 		for(j=0; j<AVI->anum; ++j) {
 			if(AVI->track[j].audio_chunks) {
 				AVI->track[j].audio_index = (audio_index_entry *) gf_malloc((nai[j]+1)*sizeof(audio_index_entry));
 				memset(AVI->track[j].audio_index, 0, (nai[j]+1)*(sizeof(audio_index_entry)));
-				if(AVI->track[j].audio_index==0) ERR_EXIT(AVI_ERR_NO_MEM);
+				if(AVI->track[j].audio_index==0) PARSE_ERR_EXIT(AVI_ERR_NO_MEM);
 			}
 		}
 
@@ -2697,15 +2723,15 @@ multiple_riff:
 		for(j=0; j<AVI->anum; ++j) AVI->track[j].audio_chunks = nai[j];
 
 
-		if(AVI->video_frames==0) ERR_EXIT(AVI_ERR_NO_VIDS);
+		if(AVI->video_frames==0) PARSE_ERR_EXIT(AVI_ERR_NO_VIDS);
 		AVI->video_index = (video_index_entry *) gf_malloc(nvi*sizeof(video_index_entry));
-		if(AVI->video_index==0) ERR_EXIT(AVI_ERR_NO_MEM);
+		if(AVI->video_index==0) PARSE_ERR_EXIT(AVI_ERR_NO_MEM);
 
 		for(j=0; j<AVI->anum; ++j) {
 			if(AVI->track[j].audio_chunks) {
 				AVI->track[j].audio_index = (audio_index_entry *) gf_malloc((nai[j]+1)*sizeof(audio_index_entry));
 				memset(AVI->track[j].audio_index, 0, (nai[j]+1)*(sizeof(audio_index_entry)));
-				if(AVI->track[j].audio_index==0) ERR_EXIT(AVI_ERR_NO_MEM);
+				if(AVI->track[j].audio_index==0) PARSE_ERR_EXIT(AVI_ERR_NO_MEM);
 			}
 		}