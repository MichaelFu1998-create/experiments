diff --git a/src/filters/dmx_avi.c b/src/filters/dmx_avi.c
index 866a793f2..1cb5ba8f8 100644
--- a/src/filters/dmx_avi.c
+++ b/src/filters/dmx_avi.c
@@ -508,6 +508,15 @@ GF_Err avidmx_process(GF_Filter *filter)
 		u32 key;
 		u64 file_offset, cts;
 		u8 *pck_data;
+		/*
+		 * AVI_read_frame() reads using the internal AVI->video_pos cursor while
+		 * we drive demux based on ctx->cur_frame. If these get out of sync (seek,
+		 * unequal stream durations, etc.), AVI_read_frame may read a different
+		 * frame than the one we sized the packet for, resulting in a heap
+		 * overflow. Always synchronize the AVI cursor with the frame we are about
+		 * to process.
+		 */
+		AVI_set_video_position(ctx->avi, ctx->cur_frame);
 		s32 size = AVI_frame_size(ctx->avi, ctx->cur_frame);
 		if (!size) {
 			AVI_read_frame(ctx->avi, NULL, &key);