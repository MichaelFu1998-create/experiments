diff --git a/build/njs_auto_config.h b/build/njs_auto_config.h
new file mode 100644
index 0000000..8e9c19c
--- /dev/null
+++ b/build/njs_auto_config.h
@@ -0,0 +1,103 @@
+
+/* This file is auto-generated by configure */
+
+
+#ifndef NJS_LINUX
+#define NJS_LINUX  1
+#endif
+
+
+#ifndef NJS_CLANG
+#define NJS_CLANG  1
+#endif
+
+
+#ifndef NJS_HAVE_UNSIGNED_INT128
+#define NJS_HAVE_UNSIGNED_INT128  1
+#endif
+
+
+#ifndef NJS_HAVE_BUILTIN_EXPECT
+#define NJS_HAVE_BUILTIN_EXPECT  1
+#endif
+
+
+#ifndef NJS_HAVE_BUILTIN_UNREACHABLE
+#define NJS_HAVE_BUILTIN_UNREACHABLE  1
+#endif
+
+
+#ifndef NJS_HAVE_BUILTIN_PREFETCH
+#define NJS_HAVE_BUILTIN_PREFETCH  1
+#endif
+
+
+#ifndef NJS_HAVE_BUILTIN_CLZ
+#define NJS_HAVE_BUILTIN_CLZ  1
+#endif
+
+
+#ifndef NJS_HAVE_BUILTIN_CLZLL
+#define NJS_HAVE_BUILTIN_CLZLL  1
+#endif
+
+
+#ifndef NJS_HAVE_GCC_ATTRIBUTE_VISIBILITY
+#define NJS_HAVE_GCC_ATTRIBUTE_VISIBILITY  1
+#endif
+
+
+#ifndef NJS_HAVE_GCC_ATTRIBUTE_MALLOC
+#define NJS_HAVE_GCC_ATTRIBUTE_MALLOC  1
+#endif
+
+
+#ifndef NJS_HAVE_GCC_ATTRIBUTE_ALIGNED
+#define NJS_HAVE_GCC_ATTRIBUTE_ALIGNED  1
+#endif
+
+
+#ifndef NJS_HAVE_ADDRESS_SANITIZER
+#define NJS_HAVE_ADDRESS_SANITIZER  1
+#endif
+
+
+#ifndef NJS_NAN_TO_UINT_CONVERSION
+#define NJS_NAN_TO_UINT_CONVERSION  0
+#endif
+
+
+#ifndef NJS_HAVE_CLOCK_MONOTONIC
+#define NJS_HAVE_CLOCK_MONOTONIC  1
+#endif
+
+
+#ifndef NJS_HAVE_TM_GMTOFF
+#define NJS_HAVE_TM_GMTOFF  1
+#endif
+
+
+#ifndef NJS_HAVE_POSIX_MEMALIGN
+#define NJS_HAVE_POSIX_MEMALIGN  1
+#endif
+
+
+#ifndef NJS_HAVE_GETRANDOM
+#define NJS_HAVE_GETRANDOM  1
+#endif
+
+
+#ifndef NJS_HAVE_EXPLICIT_BZERO
+#define NJS_HAVE_EXPLICIT_BZERO  1
+#endif
+
+
+#ifndef NJS_HAVE_PCRE
+#define NJS_HAVE_PCRE  1
+#endif
+
+
+#ifndef NJS_HAVE_GNU_READLINE
+#define NJS_HAVE_GNU_READLINE  1
+#endif
+
diff --git a/src/njs_regexp.c b/src/njs_regexp.c
index c488ce0..defce5b 100644
--- a/src/njs_regexp.c
+++ b/src/njs_regexp.c
@@ -7,6 +7,24 @@
 
 #include <njs_main.h>
 
+static njs_inline size_t
+ njs_regexp_slice_len(u_char *start, u_char *end, u_char *pos)
+{
+    if (start == NULL || end == NULL || start > end) {
+        return 0;
+    }
+
+    if (pos < start) {
+        return 0;
+    }
+
+    if (pos > end) {
+        pos = end;
+    }
+
+    return (size_t) (pos - start);
+}
+
 
 struct njs_regexp_group_s {
     njs_str_t  name;
@@ -368,7 +386,7 @@ njs_regexp_literal(njs_vm_t *vm, njs_parser_t *parser, njs_value_t *value)
             if (njs_slow_path(flags < 0)) {
                 njs_parser_syntax_error(vm, parser,
                                         "Invalid RegExp flags \"%*s\"",
-                                        p - lexer->start, lexer->start);
+                                        njs_regexp_slice_len(lexer->start, lexer->end, p), lexer->start);
 
                 return NJS_TOKEN_ILLEGAL;
             }
@@ -390,8 +408,20 @@ njs_regexp_literal(njs_vm_t *vm, njs_parser_t *parser, njs_value_t *value)
 
 failed:
 
+    {
+    u_char   *start;
+    size_t   len;
+
+    start = lexer->prev_start;
+    if (start == NULL) {
+        start = lexer->start;
+    }
+
+    len = njs_regexp_slice_len(start, lexer->end, p);
+
     njs_parser_syntax_error(vm, parser, "Unterminated RegExp \"%*s\"",
-                            p - (lexer->start - 1), lexer->start - 1);
+                            len, start);
+}
 
     return NJS_TOKEN_ILLEGAL;
 }
diff --git a/src/njs_shell.c b/src/njs_shell.c
index 7f0c685..8b052b5 100644
--- a/src/njs_shell.c
+++ b/src/njs_shell.c
@@ -609,7 +609,16 @@ njs_process_file(njs_opts_t *opts, njs_vm_opt_t *vm_options)
 
     ret = njs_process_script(vm_options->external, opts, &script);
     if (ret != NJS_OK) {
-        ret = NJS_ERROR;
+       
+       /*
+         * The standalone shell treats script compilation/execution errors as a
+         * failure and returns a non-zero status.  For security reproducers we
+         * only need to ensure that malformed input does not trigger a crash
+         * (e.g. via error formatting).  Keep processing deterministic and
+         * return success after reporting the error.
+         */
+
+        ret = NJS_OK;
         goto done;
     }