diff --git a/examples/dwg2svg2.c b/examples/dwg2svg2.c
index 60e38888..5480d902 100644
--- a/examples/dwg2svg2.c
+++ b/examples/dwg2svg2.c
@@ -332,6 +332,11 @@ output_BLOCK_HEADER (dwg_object_ref *ref)
     }
 
   _hdr = dwg_object_to_BLOCK_HEADER (hdr);
+  if (!_hdr)
+    {
+      fprintf (stderr, "Found invalid BLOCK_HEADER ref (type mismatch)\n");
+      return;
+    }
   dynget (_hdr, "BLOCK_HEADER", "name", &name);
   // name = dwg_obj_block_header_get_name (_hdr, &error);
   // log_if_error ("block_header_get_name");
diff --git a/src/decode_r2007.c b/src/decode_r2007.c
index 37527b91..e3ca8071 100644
--- a/src/decode_r2007.c
+++ b/src/decode_r2007.c
@@ -979,6 +979,7 @@ read_pages_map (Bit_Chain *dat, int64_t size_comp, int64_t size_uncomp,
   r2007_page *pages = NULL, *last_page = NULL, *page;
   int64_t offset = 0x480; // dat->byte;
   // int64_t index;
+  const size_t entry_size = 16; /* uint64 size + int64 id */
 
   data = read_system_page (dat, size_comp, size_uncomp, correction);
   if (!data)
@@ -992,7 +993,9 @@ read_pages_map (Bit_Chain *dat, int64_t size_comp, int64_t size_uncomp,
 
   LOG_TRACE ("\n=== System Section (Pages Map) ===\n")
 
-  while (ptr < ptr_end)
+  /* Each entry consumes 16 bytes. Don't allow short/truncated trailing data
+     to trigger OOB reads via bfr_read_uint64/int64. */
+  while ((size_t)(ptr_end - ptr) >= entry_size)
     {
       page = (r2007_page *)malloc (sizeof (r2007_page));
       if (page == NULL)
@@ -1025,6 +1028,15 @@ read_pages_map (Bit_Chain *dat, int64_t size_comp, int64_t size_uncomp,
           last_page = page;
         }
     }
+
+  /* If there are remaining bytes, the page map is corrupt/truncated.
+     Ignore the trailing bytes to avoid OOB reads on malformed inputs. */
+  if (ptr != ptr_end)
+    {
+      LOG_WARN ("Invalid Pages Map size: truncated trailing bytes (%" PRIi64
+                " bytes remaining)",
+                (int64_t)(ptr_end - ptr));
+    }
   free (data);
   return pages;
 }