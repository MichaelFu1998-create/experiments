diff --git a/coders/png.c b/coders/png.c
index c15a4db1c..e199e1b58 100644
--- a/coders/png.c
+++ b/coders/png.c
@@ -1637,6 +1637,9 @@ typedef struct _PNGErrorInfo
 
   ExceptionInfo
     *exception;
+
+  char
+    message[256];
 } PNGErrorInfo;
 
 static void MagickPNGErrorHandler(png_struct *ping,png_const_charp message)
@@ -1653,6 +1656,7 @@ static void MagickPNGErrorHandler(png_struct *ping,png_const_charp message)
   error_info=(PNGErrorInfo *) png_get_error_ptr(ping);
   image=error_info->image;
   exception=error_info->exception;
+  (void) CopyMagickString(error_info->message,message,sizeof(error_info->message));
 
   (void) LogMagickEvent(CoderEvent,GetMagickModule(),
     "  libpng-%s error: %s", png_get_libpng_ver(NULL),message);
@@ -2107,7 +2111,7 @@ static Image *ReadOnePNGImage(MngInfo *mng_info,
     y_resolution;
 
   QuantumInfo
-    *quantum_info;
+    *volatile quantum_info;
 
   ssize_t
     ping_rowbytes,
@@ -2255,10 +2259,12 @@ static Image *ReadOnePNGImage(MngInfo *mng_info,
   /*
     Allocate the PNG structures
   */
+  error_info.image=image;
+  error_info.exception=exception;
+  *error_info.message='\0';
+
 #ifdef PNG_USER_MEM_SUPPORTED
- error_info.image=image;
- error_info.exception=exception;
- ping=png_create_read_struct_2(PNG_LIBPNG_VER_STRING,&error_info,
+  ping=png_create_read_struct_2(PNG_LIBPNG_VER_STRING,&error_info,
    MagickPNGErrorHandler,MagickPNGWarningHandler, NULL,
    (png_malloc_ptr) Magick_png_malloc,(png_free_ptr) Magick_png_free);
 #else
@@ -2300,10 +2306,25 @@ static Image *ReadOnePNGImage(MngInfo *mng_info,
       if (pixel_info != (MemoryInfo *) NULL)
         pixel_info=RelinquishVirtualMemory(pixel_info);
 
+
+      /*
+        png_error() uses longjmp() which bypasses the normal cleanup path.
+        Release resources allocated after setjmp() (e.g. quantum_info) here.
+      */
+      if (quantum_info != (QuantumInfo *) NULL)
+        quantum_info=DestroyQuantumInfo(quantum_info);
+
       if (logging != MagickFalse)
         (void) LogMagickEvent(CoderEvent,GetMagickModule(),
           "  exit ReadOnePNGImage() with error.");
 
+      if (LocaleCompare(error_info.message,"bad adaptive filter value") == 0)
+        {
+          ClearMagickException(exception);
+          (void) ThrowMagickException(exception,GetMagickModule(),CoderWarning,
+            error_info.message,"`%s`",image->filename);
+        }
+
       return(GetFirstImageInList(image));
     }