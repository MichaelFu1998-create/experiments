diff --git a/tools/plistutil.c b/tools/plistutil.c
index 6451604..a293305 100644
--- a/tools/plistutil.c
+++ b/tools/plistutil.c
@@ -110,7 +110,7 @@ int main(int argc, char *argv[])
     plist_t root_node = NULL;
     char *plist_out = NULL;
     uint32_t size = 0;
-    int read_size = 0;
+    size_t read_size = 0;
     char *plist_entire = NULL;
     struct stat filestats;
     options_t *options = parse_arguments(argc, argv);
@@ -128,23 +128,48 @@ int main(int argc, char *argv[])
         return 1;
     }
 
-    stat(options->in_file, &filestats);
-    plist_entire = (char *) malloc(sizeof(char) * (filestats.st_size + 1));
-    read_size = fread(plist_entire, sizeof(char), filestats.st_size, iplist);
+    if (stat(options->in_file, &filestats) != 0) {
+        fclose(iplist);
+        free(options);
+        return 1;
+    }
+
+    if (filestats.st_size < 0) {
+        fclose(iplist);
+        free(options);
+        return 1;
+    }
+
+    plist_entire = (char *) malloc((size_t)filestats.st_size + 1);
+    if (!plist_entire) {
+        fclose(iplist);
+        free(options);
+        return 1;
+    }
+
+    read_size = fread(plist_entire, 1, (size_t)filestats.st_size, iplist);
     fclose(iplist);
+    /* Ensure NUL termination for XML parsing and for safety on short reads. */
+    plist_entire[read_size] = '\0';
 
     // convert from binary to xml or vice-versa
-    if (memcmp(plist_entire, "bplist00", 8) == 0)
+    if (read_size >= 8 && memcmp(plist_entire, "bplist00", 8) == 0)
     {
-        plist_from_bin(plist_entire, read_size, &root_node);
-        plist_to_xml(root_node, &plist_out, &size);
+        plist_from_bin(plist_entire, (uint32_t)read_size, &root_node);
+        if (root_node) {
+            plist_to_xml(root_node, &plist_out, &size);
+        }
     }
     else
     {
-        plist_from_xml(plist_entire, read_size, &root_node);
-        plist_to_bin(root_node, &plist_out, &size);
+        plist_from_xml(plist_entire, (uint32_t)read_size, &root_node);
+        if (root_node) {
+            plist_to_bin(root_node, &plist_out, &size);
+        }
+    }
+    if (root_node) {
+        plist_free(root_node);
     }
-    plist_free(root_node);
     free(plist_entire);
 
     if (plist_out)