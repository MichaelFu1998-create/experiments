diff --git a/MagickCore/annotate.c b/MagickCore/annotate.c
index a1145780a..0947f2d67 100644
--- a/MagickCore/annotate.c
+++ b/MagickCore/annotate.c
@@ -254,6 +254,12 @@ MagickExport MagickBooleanType AnnotateImage(Image *image,
     height,
     number_lines;
 
+  annotate=(DrawInfo *) NULL;
+  annotate_info=(DrawInfo *) NULL;
+  text=(char *) NULL;
+  textlist=(char **) NULL;
+  status=MagickFalse;
+
   assert(image != (Image *) NULL);
   assert(image->signature == MagickCoreSignature);
   if (image->debug != MagickFalse)
@@ -265,16 +271,20 @@ MagickExport MagickBooleanType AnnotateImage(Image *image,
   if (*draw_info->text == '\0')
     return(MagickTrue);
   annotate=CloneDrawInfo((ImageInfo *) NULL,draw_info);
+  if (annotate == (DrawInfo *) NULL)
+    goto cleanup;
   text=annotate->text;
   annotate->text=(char *) NULL;
   annotate_info=CloneDrawInfo((ImageInfo *) NULL,draw_info);
+  if (annotate_info == (DrawInfo *) NULL)
+    goto cleanup;
   number_lines=1;
   for (p=text; *p != '\0'; p++)
     if (*p == '\n')
       number_lines++;
   textlist=AcquireQuantumMemory(number_lines+1,sizeof(*textlist));
   if (textlist == (char **) NULL)
-    return(MagickFalse);
+    goto cleanup;
   p=text;
   for (i=0; i < number_lines; i++)
   {
@@ -303,7 +313,7 @@ MagickExport MagickBooleanType AnnotateImage(Image *image,
       (void) ParseGeometry(annotate_info->geometry,&geometry_info);
     }
   if (SetImageStorageClass(image,DirectClass,exception) == MagickFalse)
-    return(MagickFalse);
+    goto cleanup;
   if (IsGrayColorspace(image->colorspace) != MagickFalse)
     (void) SetImageColorspace(image,sRGBColorspace,exception);
   status=MagickTrue;
@@ -517,9 +527,15 @@ MagickExport MagickBooleanType AnnotateImage(Image *image,
   /*
     Relinquish resources.
   */
-  annotate_info=DestroyDrawInfo(annotate_info);
-  annotate=DestroyDrawInfo(annotate);
-  textlist=(char **) RelinquishMagickMemory(textlist);
+cleanup:
+  if (annotate_info != (DrawInfo *) NULL)
+    annotate_info=DestroyDrawInfo(annotate_info);
+  if (annotate != (DrawInfo *) NULL)
+    annotate=DestroyDrawInfo(annotate);
+  if (textlist != (char **) NULL)
+    textlist=(char **) RelinquishMagickMemory(textlist);
+  if (text != (char *) NULL)
+    text=(char *) RelinquishMagickMemory(text);
   return(status);
 }
 
diff --git a/MagickWand/magick-cli.c b/MagickWand/magick-cli.c
index c29dad5f4..5a7f224d1 100644
--- a/MagickWand/magick-cli.c
+++ b/MagickWand/magick-cli.c
@@ -388,9 +388,18 @@ WandExport int ProcessCommandOptions(MagickCLI *cli_wand,int argc,char **argv,
     (void) CLILogEvent(cli_wand,CommandEvent,GetMagickModule(),
          "- Starting (\"%s\")", argv[index]);
 
+  /*
+    If the last argument is an empty string, treat it as a real argument (e.g.
+    for options like -print) rather than an implicit output filename.
+    This prevents a bogus MissingArgument error and ensures proper cleanup.
+  */
+  if (((cli_wand->process_flags & ProcessImplictWrite) != 0) &&
+      (argv[argc-1] != (char *) NULL) && (argv[argc-1][0] == '\0'))
+    cli_wand->process_flags &= ~ProcessImplictWrite;
+
   end = argc;
   if ( (cli_wand->process_flags & ProcessImplictWrite) != 0 )
-    end--; /* the last arument is an implied write, do not process directly */
+    end--; /* the last argument is an implied write, do not process directly */
 
   for (i=index; i < end; i += count +1) {
     /* Finished processing one option? */