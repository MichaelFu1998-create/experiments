diff --git a/src/isomedia/media.c b/src/isomedia/media.c
index 2a2d6140f..cd845d06b 100644
--- a/src/isomedia/media.c
+++ b/src/isomedia/media.c
@@ -616,7 +616,21 @@ GF_Err Media_GetSample(GF_MediaBox *mdia, u32 sampleNumber, GF_ISOSample **samp,
 		/*and finally get the data, include padding if needed*/
 		if ((*samp)->alloc_size) {
 			if ((*samp)->alloc_size < data_size + mdia->mediaTrack->padding_bytes) {
-				(*samp)->data = (char *) gf_realloc((*samp)->data, sizeof(char) * ( data_size + mdia->mediaTrack->padding_bytes) );
+				/*
+				 * When an external sample allocator is configured (sample_alloc_cbk), the
+				 * returned buffer may be owned/managed by that external component (e.g. a
+				 * GF_FilterPacket). Using gf_realloc() here would free the old buffer and
+				 * potentially leave the external owner with a stale pointer, leading to
+				 * double-free/use-after-free at teardown.
+				 *
+				 * Therefore, always grow the buffer through the external allocator when
+				 * ext_realloc is set.
+				 */
+				if (ext_realloc) {
+					(*samp)->data = mdia->mediaTrack->sample_alloc_cbk(data_size + mdia->mediaTrack->padding_bytes, mdia->mediaTrack->sample_alloc_udta);
+				} else {
+					(*samp)->data = (char *) gf_realloc((*samp)->data, sizeof(char) * ( data_size + mdia->mediaTrack->padding_bytes) );
+				}
 				if (! (*samp)->data) return GF_OUT_OF_MEM;
 
 				(*samp)->alloc_size = data_size + mdia->mediaTrack->padding_bytes;