diff --git a/MagickCore/composite.c b/MagickCore/composite.c
index 78d6dff92..170c5115d 100644
--- a/MagickCore/composite.c
+++ b/MagickCore/composite.c
@@ -662,8 +662,9 @@ MagickExport MagickBooleanType CompositeImage(Image *image,
               channel);
             if (traits == UndefinedPixelTrait)
               continue;
+            /* Do not assume source and destination share channel layout. */
             if (source_traits != UndefinedPixelTrait)
-              SetPixelChannel(image,channel,p[i],q);
+              SetPixelChannel(image,channel,GetPixelChannel(source_image,channel,p),q);
             else if (channel == AlphaPixelChannel)
               SetPixelChannel(image,channel,OpaqueAlpha,q);
           }