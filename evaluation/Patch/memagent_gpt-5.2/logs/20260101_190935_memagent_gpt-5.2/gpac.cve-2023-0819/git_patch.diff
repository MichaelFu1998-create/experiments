diff --git a/src/filters/dmx_m2ts.c b/src/filters/dmx_m2ts.c
index 36839d91b..7818315fe 100644
--- a/src/filters/dmx_m2ts.c
+++ b/src/filters/dmx_m2ts.c
@@ -1445,8 +1445,8 @@ static const char *m2tsdmx_probe_data(const u8 *data, u32 size, GF_FilterProbeSc
 static const GF_FilterCapability M2TSDmxCaps[] =
 {
 	CAP_UINT(GF_CAPS_INPUT_STATIC, GF_PROP_PID_STREAM_TYPE, GF_STREAM_FILE),
-	CAP_STRING(GF_CAPS_INPUT_STATIC, GF_PROP_PID_FILE_EXT, "ts|m2t|mts|dmb|trp"),
-	CAP_STRING(GF_CAPS_INPUT_STATIC, GF_PROP_PID_MIME, "video/mpeg-2|video/mp2t|video/mpeg|audio/mpeg-2|audio/mp2t"),
+	CAP_STRING(GF_CAPS_INPUT_STATIC_OPT, GF_PROP_PID_FILE_EXT, "ts|m2t|mts|dmb|trp"),
+	CAP_STRING(GF_CAPS_INPUT_STATIC_OPT, GF_PROP_PID_MIME, "video/mpeg-2|video/mp2t|video/mpeg|audio/mpeg-2|audio/mp2t"),
 	CAP_UINT(GF_CAPS_OUTPUT, GF_PROP_PID_STREAM_TYPE, GF_STREAM_AUDIO),
 	CAP_UINT(GF_CAPS_OUTPUT, GF_PROP_PID_STREAM_TYPE, GF_STREAM_VISUAL),
 	CAP_UINT(GF_CAPS_OUTPUT, GF_PROP_PID_STREAM_TYPE, GF_STREAM_SCENE),
diff --git a/src/media_tools/mpegts.c b/src/media_tools/mpegts.c
index 30fb2bb3f..75d8b0a0d 100644
--- a/src/media_tools/mpegts.c
+++ b/src/media_tools/mpegts.c
@@ -794,6 +794,10 @@ static void gf_m2ts_process_sdt(GF_M2TS_Demuxer *ts, GF_M2TS_SECTION_ES *ses, GF
 	gf_m2ts_reset_sdt(ts);
 
 	nb_sections = gf_list_count(sections);
+	if (!nb_sections) {
+		GF_LOG(GF_LOG_WARNING, GF_LOG_CONTAINER, ("[MPEG-2 TS] SDT with no section\n"));
+		return;
+	}
 	if (nb_sections > 1) {
 		GF_LOG(GF_LOG_WARNING, GF_LOG_CONTAINER, ("[MPEG-2 TS] SDT on multiple sections not supported\n"));
 	}
@@ -928,17 +932,34 @@ static void gf_m2ts_process_tdt_tot(GF_M2TS_Demuxer *ts, GF_M2TS_SECTION_ES *tdt
 	}
 
 	nb_sections = gf_list_count(sections);
+	if (!nb_sections) {
+		GF_LOG(GF_LOG_WARNING, GF_LOG_CONTAINER, ("[MPEG-2 TS] %s with no section\n", table_name));
+		return;
+	}
 	if (nb_sections > 1) {
 		GF_LOG(GF_LOG_WARNING, GF_LOG_CONTAINER, ("[MPEG-2 TS] %s on multiple sections not supported\n", table_name));
 	}
 
 	section = (GF_M2TS_Section *)gf_list_get(sections, 0);
+	if (!section || !section->data) {
+		GF_LOG(GF_LOG_WARNING, GF_LOG_CONTAINER, ("[MPEG-2 TS] %s with invalid section\n", table_name));
+		return;
+	}
 	data = section->data;
 	data_size = section->data_size;
+	/*
+	 * Both TDT and TOT start with a 40-bit UTC_time field (5 bytes).
+	 * Never attempt to parse undersized sections.
+	 */
+	if (data_size < 5) {
+		GF_LOG(GF_LOG_WARNING, GF_LOG_CONTAINER, ("[MPEG-2 TS] Corrupted %s size (%u bytes)\n", table_name, data_size));
+		return;
+	}
 
 	/*TOT only contains 40 bits of UTC_time; TDT add descriptors and a CRC*/
 	if ((table_id==GF_M2TS_TABLE_ID_TDT) && (data_size != 5)) {
-		GF_LOG(GF_LOG_WARNING, GF_LOG_CONTAINER, ("[MPEG-2 TS] Corrupted TDT size\n", table_name));
+		GF_LOG(GF_LOG_WARNING, GF_LOG_CONTAINER, ("[MPEG-2 TS] Corrupted TDT size (%u bytes)\n", data_size));
+		return;
 	}
 	GF_SAFEALLOC(time_table, GF_M2TS_TDT_TOT);
 	if (!time_table) {