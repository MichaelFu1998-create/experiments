diff --git a/src/media_tools/isom_hinter.c b/src/media_tools/isom_hinter.c
index c05d38ccc..b56f7520b 100644
--- a/src/media_tools/isom_hinter.c
+++ b/src/media_tools/isom_hinter.c
@@ -353,7 +353,7 @@ GF_RTPHinter *gf_hinter_track_new(GF_ISOFile *file, u32 TrackNum,
 						required_rate = sample_rate;
 					}
 					if (samp)
-						gf_isom_sample_del(&samp);
+						if (samp) gf_isom_sample_del(&samp);
 
 				}
 				/*QCELP audio*/
@@ -1194,9 +1194,12 @@ GF_Err gf_hinter_finalize(GF_ISOFile *file, GF_SDP_IODProfile IOD_Profile, u32 b
 		/*get OD esd, and embbed stream data if possible*/
 		if (odT) {
 			esd = gf_isom_get_esd(file, odT, 1);
-			if (gf_isom_get_sample_count(file, odT)==1) {
+			if (!esd) {
+				GF_LOG(GF_LOG_WARNING, GF_LOG_RTP, ("[rtp hinter] Cannot retrieve OD ESD - ISMA disabled\n"));
+				is_ok = 0;
+			} else if (gf_isom_get_sample_count(file, odT)==1) {
 				samp = gf_isom_get_sample(file, odT, 1, &descIndex);
-				if (samp && gf_hinter_can_embbed_data(samp->data, samp->dataLength, GF_STREAM_OD)) {
+				if (samp && samp->data && samp->dataLength && esd->decoderConfig && gf_hinter_can_embbed_data(samp->data, samp->dataLength, GF_STREAM_OD)) {
 					InitSL_NULL(&slc);
 					slc.predefined = 0;
 					slc.hasRandomAccessUnitsOnlyFlag = 1;
@@ -1223,18 +1226,21 @@ GF_Err gf_hinter_finalize(GF_ISOFile *file, GF_SDP_IODProfile IOD_Profile, u32 b
 				}
 				gf_isom_sample_del(&samp);
 			}
-			if (remove_ocr) esd->OCRESID = 0;
-			else if (esd->OCRESID == esd->ESID) esd->OCRESID = 0;
+			if (esd) {
+				if (remove_ocr) esd->OCRESID = 0;
+				else if (esd->OCRESID == esd->ESID) esd->OCRESID = 0;
 
-			//OK, add this to our IOD
-			gf_list_add(iod->ESDescriptors, esd);
+				//OK, add this to our IOD
+				gf_list_add(iod->ESDescriptors, esd);
+			}
 		}
 
 		esd = gf_isom_get_esd(file, sceneT, 1);
-		if (gf_isom_get_sample_count(file, sceneT)==1) {
+		if (esd && (gf_isom_get_sample_count(file, sceneT)==1)) {
 			samp = gf_isom_get_sample(file, sceneT, 1, &descIndex);
-			if (gf_hinter_can_embbed_data(samp->data, samp->dataLength, GF_STREAM_SCENE)) {
+			if (samp && samp->data && samp->dataLength && esd->decoderConfig && gf_hinter_can_embbed_data(samp->data, samp->dataLength, GF_STREAM_SCENE)) {
 
+				InitSL_NULL(&slc);
 				slc.timeScale = slc.timestampResolution = gf_isom_get_media_timescale(file, sceneT);
 				slc.OCRResolution = 1000;
 				slc.startCTS = samp->DTS+samp->CTS_Offset;
@@ -1252,15 +1258,20 @@ GF_Err gf_hinter_finalize(GF_ISOFile *file, GF_SDP_IODProfile IOD_Profile, u32 b
 				esd->URLString = (char*)gf_malloc(sizeof(char) * (strlen(sdpLine)+1));
 				strcpy(esd->URLString, sdpLine);
 			} else {
-				GF_LOG(GF_LOG_ERROR, GF_LOG_RTP, ("[rtp hinter] Scene description sample too large to be embedded in IOD - ISMA disabled\n"));
+				GF_LOG(GF_LOG_WARNING, GF_LOG_RTP, ("[rtp hinter] Cannot embed Scene sample in IOD (missing/invalid sample or too large) - ISMA disabled\n"));
 				is_ok = 0;
 			}
-			gf_isom_sample_del(&samp);
+			if (samp) gf_isom_sample_del(&samp);
 		}
-		if (remove_ocr) esd->OCRESID = 0;
-		else if (esd->OCRESID == esd->ESID) esd->OCRESID = 0;
+		if (esd) {
+			if (remove_ocr) esd->OCRESID = 0;
+			else if (esd->OCRESID == esd->ESID) esd->OCRESID = 0;
 
-		gf_list_add(iod->ESDescriptors, esd);
+			gf_list_add(iod->ESDescriptors, esd);
+		} else {
+			GF_LOG(GF_LOG_WARNING, GF_LOG_RTP, ("[rtp hinter] Cannot retrieve Scene ESD - ISMA disabled\n"));
+			is_ok = 0;
+		}
 
 		if (is_ok) {
 			u32 has_a, has_v, has_i_a, has_i_v;