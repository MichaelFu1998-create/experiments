diff --git a/src/isomedia/isom_read.c b/src/isomedia/isom_read.c
index 5a8109e2d..ecf0b833d 100644
--- a/src/isomedia/isom_read.c
+++ b/src/isomedia/isom_read.c
@@ -2751,6 +2751,7 @@ u32 gf_isom_get_user_data_count(GF_ISOFile *movie, u32 trackNumber, u32 UserData
 
 	if (!movie || !movie->moov) return 0;
 
+	/* when searching UUID user data, UserDataType is used as a flag (0) */
 	if (UserDataType == GF_ISOM_BOX_TYPE_UUID) UserDataType = 0;
 	memset(t, 1, 16);
 
@@ -2768,8 +2769,15 @@ u32 gf_isom_get_user_data_count(GF_ISOFile *movie, u32 trackNumber, u32 UserData
 	while ((map = (GF_UserDataMap*)gf_list_enum(udta->recordList, &i))) {
 		count = gf_list_count(map->boxes);
 
-		if ((map->boxType == GF_ISOM_BOX_TYPE_UUID) && !memcmp(map->uuid, UUID, 16)) return count;
-		else if (map->boxType == UserDataType) return count;
+		/* Only compare UUIDs if caller explicitly requests UUID user data and
+		   a valid UUID is provided. Otherwise, UUID maps should not be considered.
+		   This avoids calling memcmp() with a NULL UUID pointer. */
+		if (UserDataType == GF_ISOM_BOX_TYPE_UUID) {
+			if ((map->boxType == GF_ISOM_BOX_TYPE_UUID) && UUID && map->uuid && !memcmp(map->uuid, UUID, 16))
+				return count;
+		} else if (map->boxType == UserDataType) {
+			return count;
+		}
 	}
 	return 0;
 }
@@ -2797,6 +2805,7 @@ GF_Err gf_isom_get_user_data(GF_ISOFile *movie, u32 trackNumber, u32 UserDataTyp
 	}
 	if (!udta) return GF_BAD_PARAM;
 
+	/* when searching UUID user data, UserDataType is used as a flag (0) */
 	if (UserDataType == GF_ISOM_BOX_TYPE_UUID) UserDataType = 0;
 	memset(t, 1, 16);
 
@@ -2804,8 +2813,15 @@ GF_Err gf_isom_get_user_data(GF_ISOFile *movie, u32 trackNumber, u32 UserDataTyp
 
 	i=0;
 	while ((map = (GF_UserDataMap*)gf_list_enum(udta->recordList, &i))) {
-		if ((map->boxType == GF_ISOM_BOX_TYPE_UUID) && !memcmp(map->uuid, UUID, 16)) goto found;
-		else if (map->boxType == UserDataType) goto found;
+		/* Only match UUID boxes when the caller is performing a UUID lookup
+		   (UserDataType==0 after normalization above) and a valid UUID is given.
+		   Otherwise skip UUID maps to avoid NULL deref in memcmp(). */
+		if (map->boxType == GF_ISOM_BOX_TYPE_UUID) {
+			if ((UserDataType == 0) && UUID && map->uuid && !memcmp(map->uuid, UUID, 16))
+				goto found;
+			continue;
+		}
+		if (map->boxType == UserDataType) goto found;
 
 	}
 	return GF_BAD_PARAM;