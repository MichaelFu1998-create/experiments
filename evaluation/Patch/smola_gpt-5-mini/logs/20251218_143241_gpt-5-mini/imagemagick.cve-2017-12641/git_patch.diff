diff --git a/coders/png.c b/coders/png.c
index dc8be52..e11c401 100644
--- a/coders/png.c
+++ b/coders/png.c
@@ -4377,7 +4377,19 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
         type[0],type[1],type[2],type[3],(double) length);
 
     if (length > PNG_UINT_31_MAX || count == 0)
-      ThrowReaderException(CorruptImageError,"CorruptImage");
+      {
+        if (chunk != (unsigned char *) NULL)
+          chunk=(unsigned char *) RelinquishMagickMemory(chunk);
+        if (color_image != (Image *) NULL)
+          color_image=DestroyImage(color_image);
+        if (color_image_info != (ImageInfo *) NULL)
+          color_image_info=DestroyImageInfo(color_image_info);
+        if (alpha_image != (Image *) NULL)
+          alpha_image=DestroyImage(alpha_image);
+        if (alpha_image_info != (ImageInfo *) NULL)
+          alpha_image_info=DestroyImageInfo(alpha_image_info);
+        ThrowReaderException(CorruptImageError,"CorruptImage");
+      }
 
     p=NULL;
     chunk=(unsigned char *) NULL;
@@ -4385,12 +4397,36 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
     if (length != 0)
       {
         if (length > GetBlobSize(image))
-          ThrowReaderException(CorruptImageError,"InsufficientImageDataInFile");
+          {
+            if (chunk != (unsigned char *) NULL)
+              chunk=(unsigned char *) RelinquishMagickMemory(chunk);
+            if (color_image != (Image *) NULL)
+              color_image=DestroyImage(color_image);
+            if (color_image_info != (ImageInfo *) NULL)
+              color_image_info=DestroyImageInfo(color_image_info);
+            if (alpha_image != (Image *) NULL)
+              alpha_image=DestroyImage(alpha_image);
+            if (alpha_image_info != (ImageInfo *) NULL)
+              alpha_image_info=DestroyImageInfo(alpha_image_info);
+            ThrowReaderException(CorruptImageError,"InsufficientImageDataInFile");
+          }
         chunk=(unsigned char *) AcquireQuantumMemory(length+MagickPathExtent,
           sizeof(*chunk));
 
         if (chunk == (unsigned char *) NULL)
-          ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
+          {
+            if (chunk != (unsigned char *) NULL)
+              chunk=(unsigned char *) RelinquishMagickMemory(chunk);
+            if (color_image != (Image *) NULL)
+              color_image=DestroyImage(color_image);
+            if (color_image_info != (ImageInfo *) NULL)
+              color_image_info=DestroyImageInfo(color_image_info);
+            if (alpha_image != (Image *) NULL)
+              alpha_image=DestroyImage(alpha_image);
+            if (alpha_image_info != (ImageInfo *) NULL)
+              alpha_image_info=DestroyImageInfo(alpha_image_info);
+            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
+          }
 
         for (i=0; i < (ssize_t) length; i++)
         {
@@ -4485,7 +4521,10 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
         color_image=AcquireImage(color_image_info,exception);
 
         if (color_image == (Image *) NULL)
-          ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
+          {
+            color_image_info=DestroyImageInfo(color_image_info);
+            ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
+          }
 
         if (logging != MagickFalse)
           (void) LogMagickEvent(CoderEvent,GetMagickModule(),
@@ -4498,6 +4537,8 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
         if (status == MagickFalse)
           {
             color_image=DestroyImage(color_image);
+            if (color_image_info != (ImageInfo *) NULL)
+              color_image_info=DestroyImageInfo(color_image_info);
             return(DestroyImageList(image));
           }
 
@@ -4520,6 +4561,8 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
               {
                 alpha_image_info=DestroyImageInfo(alpha_image_info);
                 color_image=DestroyImage(color_image);
+                if (color_image_info != (ImageInfo *) NULL)
+                  color_image_info=DestroyImageInfo(color_image_info);
                 ThrowReaderException(ResourceLimitError,
                   "MemoryAllocationFailed");
               }
@@ -4537,6 +4580,8 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
                 alpha_image=DestroyImage(alpha_image);
                 alpha_image_info=DestroyImageInfo(alpha_image_info);
                 color_image=DestroyImage(color_image);
+                if (color_image_info != (ImageInfo *) NULL)
+                  color_image_info=DestroyImageInfo(color_image_info);
                 return(DestroyImageList(image));
               }