diff --git a/src/isomedia/sample_descs.c b/src/isomedia/sample_descs.c
index 8c18075..1c04a20 100644
--- a/src/isomedia/sample_descs.c
+++ b/src/isomedia/sample_descs.c
@@ -1794,9 +1794,19 @@ GF_Err gf_isom_new_mpha_description(GF_ISOFile *movie, u32 trackNumber, const ch
 		mpa->cfg_mha->mha_config_size = dsi[3];
 		mpa->cfg_mha->mha_config_size <<= 8;
 		mpa->cfg_mha->mha_config_size |= dsi[4];
-		mpa->cfg_mha->mha_config = gf_malloc(sizeof(u8) * mpa->cfg_mha->mha_config_size);
-		if (!mpa->cfg_mha->mha_config) return GF_OUT_OF_MEM;
-		memcpy(mpa->cfg_mha->mha_config, dsi+5, dsi_size-5);
+		mpa->cfg_mha->mha_config = NULL;
+		{
+			u32 hdr_size = mpa->cfg_mha->mha_config_size;
+			u32 available = (dsi_size > 5) ? (dsi_size - 5) : 0;
+			u32 to_copy = hdr_size;
+			/* If the DSI length does not match the header-declared size, don't overflow - copy only the available bytes and adjust the stored size accordingly. */
+			if (to_copy > available) to_copy = available;
+			mpa->cfg_mha->mha_config = gf_malloc(sizeof(u8) * (to_copy ? to_copy : 1));
+			if (!mpa->cfg_mha->mha_config) return GF_OUT_OF_MEM;
+			if (to_copy) memcpy(mpa->cfg_mha->mha_config, dsi+5, to_copy);
+			mpa->cfg_mha->mha_config_size = to_copy;
+		}
+
 	}
 	return GF_OK;
 }