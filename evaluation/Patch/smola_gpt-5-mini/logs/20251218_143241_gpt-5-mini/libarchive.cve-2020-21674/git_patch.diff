diff --git a/libarchive/archive_string.c b/libarchive/archive_string.c
index bd39c96..d4796d7 100644
--- a/libarchive/archive_string.c
+++ b/libarchive/archive_string.c
@@ -828,6 +828,13 @@ archive_string_append_from_wcs(struct archive_string *as,
 		len--;
 	}
 	as->length = p - as->s;
+	/* Ensure there is room for the terminating NUL byte.  In some
+	 * locales a wide-char may expand to multiple bytes; although the
+	 * loop above attempts to reserve space, make sure we have at least
+	 * one byte available before writing the terminator to avoid a
+	 * possible off-by-one heap buffer overflow. */
+	if (archive_string_ensure(as, as->length + 1) == NULL)
+		return (-1);
 	as->s[as->length] = '\0';
 	return (ret_val);
 }
@@ -2703,6 +2710,13 @@ strncat_from_utf8_to_utf8(struct archive_string *as, const void *_p,
 		}
 	} while (n > 0);
 	as->length = p - as->s;
+	/* Ensure there is room for the terminating NUL byte.  In some
+	 * locales a wide-char may expand to multiple bytes; although the
+	 * loop above attempts to reserve space, make sure we have at least
+	 * one byte available before writing the terminator to avoid a
+	 * possible off-by-one heap buffer overflow. */
+	if (archive_string_ensure(as, as->length + 1) == NULL)
+		return (-1);
 	as->s[as->length] = '\0';
 	return (ret);
 }
@@ -2783,6 +2797,13 @@ archive_string_append_unicode(struct archive_string *as, const void *_p,
 		p += w;
 	}
 	as->length = p - as->s;
+	/* Ensure there is room for the terminating NUL byte.  In some
+	 * locales a wide-char may expand to multiple bytes; although the
+	 * loop above attempts to reserve space, make sure we have at least
+	 * one byte available before writing the terminator to avoid a
+	 * possible off-by-one heap buffer overflow. */
+	if (archive_string_ensure(as, as->length + 1) == NULL)
+		return (-1);
 	as->s[as->length] = '\0';
 	if (ts == 2)
 		as->s[as->length+1] = '\0';
@@ -3175,6 +3196,13 @@ archive_string_normalize_C(struct archive_string *as, const void *_p,
 		}
 	}
 	as->length = p - as->s;
+	/* Ensure there is room for the terminating NUL byte.  In some
+	 * locales a wide-char may expand to multiple bytes; although the
+	 * loop above attempts to reserve space, make sure we have at least
+	 * one byte available before writing the terminator to avoid a
+	 * possible off-by-one heap buffer overflow. */
+	if (archive_string_ensure(as, as->length + 1) == NULL)
+		return (-1);
 	as->s[as->length] = '\0';
 	if (ts == 2)
 		as->s[as->length+1] = '\0';
@@ -3390,6 +3418,13 @@ check_first_code:
 		goto check_first_code;
 	}
 	as->length = p - as->s;
+	/* Ensure there is room for the terminating NUL byte.  In some
+	 * locales a wide-char may expand to multiple bytes; although the
+	 * loop above attempts to reserve space, make sure we have at least
+	 * one byte available before writing the terminator to avoid a
+	 * possible off-by-one heap buffer overflow. */
+	if (archive_string_ensure(as, as->length + 1) == NULL)
+		return (-1);
 	as->s[as->length] = '\0';
 	if (ts == 2)
 		as->s[as->length+1] = '\0';
@@ -3477,6 +3512,13 @@ strncat_from_utf8_libarchive2(struct archive_string *as,
 		p += n;
 	}
 	as->length = p - as->s;
+	/* Ensure there is room for the terminating NUL byte.  In some
+	 * locales a wide-char may expand to multiple bytes; although the
+	 * loop above attempts to reserve space, make sure we have at least
+	 * one byte available before writing the terminator to avoid a
+	 * possible off-by-one heap buffer overflow. */
+	if (archive_string_ensure(as, as->length + 1) == NULL)
+		return (-1);
 	as->s[as->length] = '\0';
 	return (0);
 }