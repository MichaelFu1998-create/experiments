diff --git a/src/njs_scope.h b/src/njs_scope.h
index 4164617..bead139 100644
--- a/src/njs_scope.h
+++ b/src/njs_scope.h
@@ -1,4 +1,3 @@
-
 /*
  * Copyright (C) Alexander Borisov
  * Copyright (C) NGINX, Inc.
@@ -71,8 +70,42 @@ njs_scope_index_value(njs_index_t index)
 njs_inline njs_value_t *
 njs_scope_value(njs_vm_t *vm, njs_index_t index)
 {
-    return vm->levels[njs_scope_index_type(index)]
-                     [njs_scope_index_value(index)];
+    njs_level_type_t  type;
+    uint32_t          value_index;
+
+    /* Guard against invalid or special indexes to avoid out-of-bounds access. */
+    if (index == NJS_INDEX_ERROR || index == NJS_INDEX_NONE) {
+        return &vm->undefined_value;
+    }
+
+    type = njs_scope_index_type(index);
+    value_index = njs_scope_index_value(index);
+
+    if (type >= NJS_LEVEL_MAX) {
+        return &vm->undefined_value;
+    }
+
+    /* If the level array is not initialized, return undefined. */
+    if (vm->levels[type] == NULL) {
+        return &vm->undefined_value;
+    }
+
+    /* Additional bounds checks for known sized levels. */
+    if (type == NJS_LEVEL_GLOBAL) {
+        if (value_index >= vm->global_items) {
+            return &vm->undefined_value;
+        }
+    }
+
+    if (type == NJS_LEVEL_STATIC) {
+        if (vm->scope_absolute == NULL
+            || value_index >= vm->scope_absolute->items)
+        {
+            return &vm->undefined_value;
+        }
+    }
+
+    return vm->levels[type][value_index];
 }
 
 
diff --git a/src/njs_vm.c b/src/njs_vm.c
index 2c0099f..6e913d3 100644
--- a/src/njs_vm.c
+++ b/src/njs_vm.c
@@ -74,6 +74,9 @@ njs_vm_create(njs_vm_opt_t *options)
 
     njs_set_undefined(&vm->retval);
 
+    /* local writable undefined used by scope access */
+    njs_set_undefined(&vm->undefined_value);
+
     if (options->init) {
         ret = njs_vm_init(vm);
         if (njs_slow_path(ret != NJS_OK)) {
diff --git a/src/njs_vm.h b/src/njs_vm.h
index 64cc74f..45c27e6 100644
--- a/src/njs_vm.h
+++ b/src/njs_vm.h
@@ -191,6 +191,9 @@ struct njs_vm_s {
     njs_object_t             global_object;
     njs_value_t              global_value;
 
+    /* VM local writable undefined value used for invalid scope access. */
+    njs_value_t              undefined_value;
+
     njs_arr_t                *codes;  /* of njs_vm_code_t */
     njs_arr_t                *functions_name_cache;