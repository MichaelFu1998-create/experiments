diff --git a/source/m3_function.c b/source/m3_function.c
index d262361..6b7b988 100644
--- a/source/m3_function.c
+++ b/source/m3_function.c
@@ -11,7 +11,10 @@
 
 M3Result AllocFuncType (IM3FuncType * o_functionType, u32 i_numTypes)
 {
-    *o_functionType = (IM3FuncType) m3_Malloc (sizeof (M3FuncType) + i_numTypes);
+    // allocate enough space for the M3FuncType struct plus the u8 types array
+    // allocate an extra byte to ensure room for all types and avoid off-by-one overflows
+    size_t size = sizeof(M3FuncType) + ((size_t)i_numTypes + 1) * sizeof(u8);
+    *o_functionType = (IM3FuncType) m3_Malloc (size);
     return (*o_functionType) ? m3Err_none : m3Err_mallocFailed;
 }