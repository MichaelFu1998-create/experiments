diff --git a/src/isomedia/drm_sample.c b/src/isomedia/drm_sample.c
index a2f69d7..c4abef8 100644
--- a/src/isomedia/drm_sample.c
+++ b/src/isomedia/drm_sample.c
@@ -1559,7 +1559,7 @@ static GF_Err isom_cenc_get_sai_by_saiz_saio(GF_MediaBox *mdia, u32 sampleNumber
 		}
 		if ((nb_saio==1) && !saio_cenc->total_size) {
 			for (j = 0; j < saiz->sample_count; j++) {
-				saio_cenc->total_size += saiz->default_sample_info_size ? saiz->default_sample_info_size : saiz->sample_info_size[j];
+				{ u32 _s = saiz->default_sample_info_size ? saiz->default_sample_info_size : (saiz->sample_info_size ? saiz->sample_info_size[j] : 0); saio_cenc->total_size += _s; }
 			}
 		}
 		if (saiz->cached_sample_num+1== sampleNumber) {
@@ -1569,7 +1569,7 @@ static GF_Err isom_cenc_get_sai_by_saiz_saio(GF_MediaBox *mdia, u32 sampleNumber
 				return GF_ISOM_INVALID_FILE;
 
 			for (j = 0; j < sampleNumber-1; j++)
-				prev_sai_size += saiz->default_sample_info_size ? saiz->default_sample_info_size : saiz->sample_info_size[j];
+				{ u32 _s = saiz->default_sample_info_size ? saiz->default_sample_info_size : (saiz->sample_info_size ? saiz->sample_info_size[j] : 0); prev_sai_size += _s; }
 		}
 		if (saiz->default_sample_info_size) {
 			size = saiz->default_sample_info_size;