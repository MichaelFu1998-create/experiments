diff --git a/src/filters/reframe_mpgvid.c b/src/filters/reframe_mpgvid.c
index 328db28..c0382e2 100644
--- a/src/filters/reframe_mpgvid.c
+++ b/src/filters/reframe_mpgvid.c
@@ -639,12 +639,16 @@ GF_Err mpgviddmx_process(GF_Filter *filter)
 		Bool copy_last_bytes = GF_FALSE;
 
 		//not enough bytes to parse start code
-		if (remain<5) {
-			memcpy(ctx->hdr_store, start, remain);
-			ctx->bytes_in_header = remain;
-			break;
-		}
-		current = -1;
+			if (remain<=0) {
+				break;
+			}
+			if (remain<5) {
+				/* protect against negative-size memcpy */
+				if (remain>0) memcpy(ctx->hdr_store, start, (size_t)remain);
+				ctx->bytes_in_header = (u32)(remain>0?remain:0);
+				break;
+			}
+current = -1;
 
 		//we have some potential bytes of a start code in the store, copy some more bytes and check if valid start code.
 		//if not, dispatch these bytes as continuation of the data