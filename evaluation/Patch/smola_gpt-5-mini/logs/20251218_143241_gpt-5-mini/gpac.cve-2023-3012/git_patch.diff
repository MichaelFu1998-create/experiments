diff --git a/src/utils/xml_parser.c b/src/utils/xml_parser.c
index 49df338..1ffdf12 100644
--- a/src/utils/xml_parser.c
+++ b/src/utils/xml_parser.c
@@ -968,6 +968,8 @@ exit:
 static GF_Err xml_sax_append_string(GF_SAXParser *parser, char *string)
 {
 	u32 size = parser->line_size;
+	/* Guard against NULL input to avoid passing NULL to strlen */
+	if (!string) return GF_OK;
 	u32 nl_size = (u32) strlen(string);
 
 	if (!nl_size) return GF_OK;
@@ -1032,6 +1034,18 @@ static GF_Err gf_xml_sax_parse_intern(GF_SAXParser *parser, char *current)
 			if (!entityEnd) return xml_sax_append_string(parser, current);
 			entityStart = strrchr(parser->buffer, '&');
 
+			/* If entityStart not found in parser buffer, avoid NULL dereference */
+			if (!entityStart) {
+				/* clear in_entity state and append the current part as text */
+				parser->in_entity = GF_FALSE;
+				xml_sax_append_string(parser, current);
+				xml_sax_parse(parser, GF_TRUE);
+				/* advance current to the ''';''' we found and continue */
+				current = entityEnd + 1;
+				continue;
+			}
+
+
 			entityEnd[0] = 0;
 			len = (u32) strlen(entityStart) + (u32) strlen(current) + 1;
 			name = (char*)gf_malloc(sizeof(char)*len);