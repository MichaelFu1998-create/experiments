diff --git a/libqpdf/Pl_ASCII85Decoder.cc b/libqpdf/Pl_ASCII85Decoder.cc
index b8df3e8..26bc19e 100644
--- a/libqpdf/Pl_ASCII85Decoder.cc
+++ b/libqpdf/Pl_ASCII85Decoder.cc
@@ -70,6 +70,11 @@ Pl_ASCII85Decoder::write(unsigned char* buf, size_t len)
 		    QTC::TC("libtests", "Pl_ASCII85Decoder read z");
                     unsigned char zeroes[4];
                     memset(zeroes, '\0', 4);
+                    // Ensure internal state is consistent before calling
+                    // downstream pipeline code which may throw.  Although
+                    // pos is already zero here, normalize state explicitly.
+                    this->pos = 0;
+                    memset(this->inbuf, 117, 5);
 		    getNext()->write(zeroes, 4);
 		}
 		break;
@@ -119,10 +124,21 @@ Pl_ASCII85Decoder::flush()
 
     QTC::TC("libtests", "Pl_ASCII85Decoder partial flush",
 	    (this->pos == 5) ? 0 : 1);
-    getNext()->write(outbuf, this->pos - 1);
 
+    // To be exception-safe with respect to downstream writes, compute
+    // the amount to write and reset internal state before calling
+    // getNext()->write.  This prevents the object from being left in
+    // an inconsistent state if the downstream pipeline throws and
+    // unwinding frees memory that could later be reused.
+    size_t write_len = (this->pos == 0) ? 0 : (this->pos - 1);
+    // Reset internal state before performing the potentially-throwing
+    // write to ensure no use-after-free or inconsistent state.
     this->pos = 0;
     memset(this->inbuf, 117, 5);
+
+    getNext()->write(outbuf, write_len);
+
+    // pos already reset above
 }
 
 void