diff --git a/src/media_tools/mpegts.c b/src/media_tools/mpegts.c
index 30fb2bb..3307f82 100644
--- a/src/media_tools/mpegts.c
+++ b/src/media_tools/mpegts.c
@@ -936,9 +936,16 @@ static void gf_m2ts_process_tdt_tot(GF_M2TS_Demuxer *ts, GF_M2TS_SECTION_ES *tdt
 	data = section->data;
 	data_size = section->data_size;
 
+	/* Safety: ensure we have at least 5 bytes for TDT/TOT (UTC time is 5 bytes) */
+	if (data_size < 5) {
+		GF_LOG(GF_LOG_WARNING, GF_LOG_CONTAINER, ("[MPEG-2 TS] Corrupted %s table (too small)\n", table_name));
+		return;
+	}
+
 	/*TOT only contains 40 bits of UTC_time; TDT add descriptors and a CRC*/
-	if ((table_id==GF_M2TS_TABLE_ID_TDT) && (data_size != 5)) {
-		GF_LOG(GF_LOG_WARNING, GF_LOG_CONTAINER, ("[MPEG-2 TS] Corrupted TDT size\n", table_name));
+	if (data_size < 5) {
+		GF_LOG(GF_LOG_WARNING, GF_LOG_CONTAINER, ("[MPEG-2 TS] Corrupted %s table (too small)\n", table_name));
+		goto error_exit;
 	}
 	GF_SAFEALLOC(time_table, GF_M2TS_TDT_TOT);
 	if (!time_table) {
@@ -947,9 +954,12 @@ static void gf_m2ts_process_tdt_tot(GF_M2TS_Demuxer *ts, GF_M2TS_SECTION_ES *tdt
 	}
 
 	/*UTC_time - see annex C of DVB-SI ETSI EN 300468*/
-/* decodes an Modified Julian Date (MJD) into a Co-ordinated Universal Time (UTC)
-See annex C of DVB-SI ETSI EN 300468 */
-	date = data[0]*256 + data[1];
+	/* decodes an Modified Julian Date (MJD) into a Co-ordinated Universal Time (UTC) */
+	if (data_size < 5) {
+		GF_LOG(GF_LOG_WARNING, GF_LOG_CONTAINER, ("[MPEG-2 TS] Corrupted %s table (too small)\n", table_name));
+		goto error_exit;
+	}
+	date = (u32)data[0]*256 + data[1];
 	yp = (u32)((date - 15078.2)/365.25);
 	mp = (u32)((date - 14956.1 - (u32)(yp * 365.25))/30.6001);
 	time_table->day = (u32)(date - 14956 - (u32)(yp * 365.25) - (u32)(mp * 30.6001));