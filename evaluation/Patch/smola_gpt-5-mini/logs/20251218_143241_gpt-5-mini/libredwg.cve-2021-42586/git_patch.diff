diff --git a/src/decode_r2007.c b/src/decode_r2007.c
index 3b5af4c..d30b6ab 100644
--- a/src/decode_r2007.c
+++ b/src/decode_r2007.c
@@ -795,11 +795,12 @@ read_data_section (Bit_Chain *sec_dat, Bit_Chain *dat,
           LOG_ERROR ("Failed to find page %d", (int)section_page->id)
           return DWG_ERR_PAGENOTFOUND;
         }
-      if (section_page->offset > max_decomp_size)
+      if (section_page->offset > max_decomp_size ||
+          section_page->uncomp_size > max_decomp_size ||
+          section_page->offset + section_page->uncomp_size > max_decomp_size)
         {
           free (decomp);
-          LOG_ERROR ("Invalid section_page->offset %ld > %ld",
-                     (long)section_page->offset, (long)max_decomp_size)
+          LOG_ERROR ("Invalid section_page offset/size")
           return DWG_ERR_VALUEOUTOFBOUNDS;
         }