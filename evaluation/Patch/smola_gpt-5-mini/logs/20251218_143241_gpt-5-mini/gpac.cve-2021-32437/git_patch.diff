diff --git a/src/media_tools/isom_hinter.c b/src/media_tools/isom_hinter.c
index c05d38c..71282a8 100644
--- a/src/media_tools/isom_hinter.c
+++ b/src/media_tools/isom_hinter.c
@@ -1194,7 +1194,8 @@ GF_Err gf_hinter_finalize(GF_ISOFile *file, GF_SDP_IODProfile IOD_Profile, u32 b
 		/*get OD esd, and embbed stream data if possible*/
 		if (odT) {
 			esd = gf_isom_get_esd(file, odT, 1);
-			if (gf_isom_get_sample_count(file, odT)==1) {
+			if (esd) {
+				if (gf_isom_get_sample_count(file, odT)==1) {
 				samp = gf_isom_get_sample(file, odT, 1, &descIndex);
 				if (samp && gf_hinter_can_embbed_data(samp->data, samp->dataLength, GF_STREAM_OD)) {
 					InitSL_NULL(&slc);
@@ -1222,6 +1223,7 @@ GF_Err gf_hinter_finalize(GF_ISOFile *file, GF_SDP_IODProfile IOD_Profile, u32 b
 					is_ok = 0;
 				}
 				gf_isom_sample_del(&samp);
+				}
 			}
 			if (remove_ocr) esd->OCRESID = 0;
 			else if (esd->OCRESID == esd->ESID) esd->OCRESID = 0;
@@ -1233,7 +1235,7 @@ GF_Err gf_hinter_finalize(GF_ISOFile *file, GF_SDP_IODProfile IOD_Profile, u32 b
 		esd = gf_isom_get_esd(file, sceneT, 1);
 		if (gf_isom_get_sample_count(file, sceneT)==1) {
 			samp = gf_isom_get_sample(file, sceneT, 1, &descIndex);
-			if (gf_hinter_can_embbed_data(samp->data, samp->dataLength, GF_STREAM_SCENE)) {
+			if (samp && gf_hinter_can_embbed_data(samp->data, samp->dataLength, GF_STREAM_SCENE)) {
 
 				slc.timeScale = slc.timestampResolution = gf_isom_get_media_timescale(file, sceneT);
 				slc.OCRResolution = 1000;
@@ -1246,9 +1248,7 @@ GF_Err gf_hinter_finalize(GF_ISOFile *file, GF_SDP_IODProfile IOD_Profile, u32 b
 				buf64[size64] = 0;
 				sprintf(sdpLine, "data:application/mpeg4-bifs-au;base64,%s", buf64);
 
-				esd->decoderConfig->avgBitrate = 0;
-				esd->decoderConfig->bufferSizeDB = samp->dataLength;
-				esd->decoderConfig->maxBitrate = 0;
+				if (esd->decoderConfig) { esd->decoderConfig->avgBitrate = 0; esd->decoderConfig->bufferSizeDB = samp->dataLength; esd->decoderConfig->maxBitrate = 0; }
 				esd->URLString = (char*)gf_malloc(sizeof(char) * (strlen(sdpLine)+1));
 				strcpy(esd->URLString, sdpLine);
 			} else {