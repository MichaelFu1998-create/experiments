diff --git a/src/vm.c b/src/vm.c
index 09f524a..cb1dbf0 100644
--- a/src/vm.c
+++ b/src/vm.c
@@ -1923,12 +1923,21 @@ RETRY_TRY_BLOCK:
         kdict = mrb_hash_dup(mrb, kdict);
       }
 
+      /* arguments is passed with Array */
       /* arguments is passed with Array */
       if (argc == 15) {
-        struct RArray *ary = mrb_ary_ptr(regs[1]);
-        argv = ARY_PTR(ary);
-        argc = (int)ARY_LEN(ary);
-        mrb_gc_protect(mrb, regs[1]);
+        /* Ensure regs[1] is actually an Array before dereferencing. */
+        if (mrb_array_p(regs[1])) {
+          struct RArray *ary = mrb_ary_ptr(regs[1]);
+          argv = ARY_PTR(ary);
+          argc = (int)ARY_LEN(ary);
+          mrb_gc_protect(mrb, regs[1]);
+        }
+        else {
+          /* Fallback: treat as a single argument to avoid dereferencing a non-array. */
+          argv = regs + 1;
+          argc = 1;
+        }
       }
 
       /* strict argument check */