diff --git a/Zend/zend_execute.h b/Zend/zend_execute.h
index 2bef5673907..5652278b0b4 100644
--- a/Zend/zend_execute.h
+++ b/Zend/zend_execute.h
@@ -143,14 +143,22 @@ static zend_always_inline zval* zend_assign_to_variable(zval *variable_ptr, zval
 			garbage = Z_COUNTED_P(variable_ptr);
 			zend_copy_to_variable(variable_ptr, value, value_type);
 			if (GC_DELREF(garbage) == 0) {
-				rc_dtor_func(garbage);
-			} else { /* we need to split */
-				/* optimized version of GC_ZVAL_CHECK_POSSIBLE_ROOT(variable_ptr) */
-				if (UNEXPECTED(GC_MAY_LEAK(garbage))) {
-					gc_possible_root(garbage);
-				}
-			}
-			return variable_ptr;
+                    /* The destructor could have freed the container which held
+                     * variable_ptr (for example an object). In that case
+                     * returning variable_ptr would leave a dangling pointer
+                     * and subsequent accesses would be a use-after-free.
+                     * To avoid this, return a pointer to a well-known
+                     * static zval instead of the potentially freed memory.
+                     */
+                    rc_dtor_func(garbage);
+                    return &EG(uninitialized_zval);
+                } else { /* we need to split */
+                    /* optimized version of GC_ZVAL_CHECK_POSSIBLE_ROOT(variable_ptr) */
+                    if (UNEXPECTED(GC_MAY_LEAK(garbage))) {
+                        gc_possible_root(garbage);
+                    }
+                }
+                return variable_ptr;
 		}
 	} while (0);