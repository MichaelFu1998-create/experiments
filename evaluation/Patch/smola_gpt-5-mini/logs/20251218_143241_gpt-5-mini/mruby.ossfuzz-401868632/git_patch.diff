diff --git a/src/range.c b/src/range.c
index 0d2a551fa..365c9445a 100644
--- a/src/range.c
+++ b/src/range.c
@@ -373,10 +373,8 @@ range_num_to_a(mrb_state *mrb, mrb_value range)
         len++;
       }
       ary = mrb_ary_new_capa(mrb, len);
-      mrb_value *ptr = RARRAY_PTR(ary);
       for (mrb_int i=0; i<len; i++) {
-        ptr[i] = mrb_int_value(mrb, a+i);
-        ARY_SET_LEN(RARRAY(ary), i+1);
+        mrb_ary_push(mrb, ary, mrb_int_value(mrb, a+i));
       }
       return ary;
     }
@@ -389,19 +387,15 @@ range_num_to_a(mrb_state *mrb, mrb_value range)
         return mrb_ary_new_capa(mrb, 0);
       }
       ary = mrb_ary_new_capa(mrb, (mrb_int)(b - a) + 1);
-      mrb_value *ptr = RARRAY_PTR(ary);
-      mrb_int i = 0;
       if (RANGE_EXCL(r)) {
         while (a < b) {
-          ptr[i++] = mrb_int_value(mrb, (mrb_int)a);
-          ARY_SET_LEN(RARRAY(ary), i);
+          mrb_ary_push(mrb, ary, mrb_int_value(mrb, (mrb_int)a));
           a += 1.0;
         }
       }
       else {
         while (a <= b) {
-          ptr[i++] = mrb_int_value(mrb, (mrb_int)a);
-          ARY_SET_LEN(RARRAY(ary), i);
+          mrb_ary_push(mrb, ary, mrb_int_value(mrb, (mrb_int)a));
           a += 1.0;
         }
       }