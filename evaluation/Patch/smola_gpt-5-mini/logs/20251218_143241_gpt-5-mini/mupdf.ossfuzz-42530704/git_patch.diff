diff --git a/source/fitz/load-bmp.c b/source/fitz/load-bmp.c
index 402fc0d31..04877fc9e 100644
--- a/source/fitz/load-bmp.c
+++ b/source/fitz/load-bmp.c
@@ -806,13 +806,19 @@ bmp_read_color_profile(fz_context *ctx, struct info *info, const unsigned char *
 		fz_buffer *profile;
 		fz_colorspace *cs;
 
-		if ((uint32_t)(end - begin) < info->profilesize)
 		{
-			fz_warn(ctx, "ignoring truncated color profile in bmp image");
-			return NULL;
-		}
+			/* Validate that the profile offset/size are within the provided image buffer. */
+			size_t buf_len = (size_t)(end - begin);
+			uint64_t off = (uint64_t)info->profileoffset;
+			uint64_t sz = (uint64_t)info->profilesize;
+			if (off > buf_len || sz > buf_len || off + sz > buf_len)
+			{
+				fz_warn(ctx, "ignoring truncated or out-of-range color profile in bmp image");
+				return NULL;
+			}
 
-		profile = fz_new_buffer_from_copied_data(ctx, begin + info->profileoffset, info->profilesize);
+			profile = fz_new_buffer_from_copied_data(ctx, begin + info->profileoffset, info->profilesize);
+		}
 
 		fz_try(ctx)
 			cs = fz_new_icc_colorspace(ctx, FZ_COLORSPACE_RGB, 0, "BMPRGB", profile);