diff --git a/src/inflate.c b/src/inflate.c
index 85a5348..7f48abe 100644
--- a/src/inflate.c
+++ b/src/inflate.c
@@ -343,6 +343,9 @@ InflateArrayFlags(mat_t *mat, matvar_t *matvar, void *buf)
 size_t
 InflateDimensions(mat_t *mat, matvar_t *matvar, void *buf)
 {
+#define MAX_INFLATE_BYTES (64*1024) /* 64KB limit to avoid excessive allocations/stack overflow */
+
+
     mat_uint8_t comp_buf[32];
     mat_int32_t tag[2];
     int    err, rank, i;
@@ -384,6 +387,14 @@ InflateDimensions(mat_t *mat, matvar_t *matvar, void *buf)
         return bytesread;
     }
     rank = tag[1];
+    if ( rank < 0 ) {
+        Mat_Critical("InflateDimensions: negative rank %d", rank);
+        return bytesread;
+    }
+    if ( (size_t)rank > MAX_INFLATE_BYTES ) {
+        Mat_Critical("InflateDimensions: rank too large (%d bytes)", rank);
+        return bytesread;
+    }
     if ( rank % 8 != 0 )
         i = 8-(rank %8);
     else
@@ -496,6 +507,10 @@ InflateVarName(mat_t *mat, matvar_t *matvar, void *buf, int N)
         matvar->internal->z->next_in = comp_buf;
         bytesread += fread(comp_buf,1,1,(FILE*)mat->fp);
     }
+    if ( (size_t)N > MAX_INFLATE_BYTES ) {
+        Mat_Critical("InflateVarName: name size too large (%d)", N);
+        return bytesread;
+    }
     matvar->internal->z->avail_out = N;
     matvar->internal->z->next_out = (Bytef*)buf;
     err = inflate(matvar->internal->z,Z_NO_FLUSH);
@@ -833,7 +848,12 @@ InflateFieldNames(mat_t *mat,matvar_t *matvar,void *buf,int nfields,
         matvar->internal->z->next_in = comp_buf;
         bytesread += fread(comp_buf,1,1,(FILE*)mat->fp);
     }
-    matvar->internal->z->avail_out = nfields*fieldname_length+padding;
+    size_t total = (size_t)nfields*(size_t)fieldname_length + (size_t)padding;
+    if ( total > MAX_INFLATE_BYTES ) {
+        Mat_Critical("InflateFieldNames: fieldnames size too large (%zu)", total);
+        return bytesread;
+    }
+    matvar->internal->z->avail_out = (unsigned)total;
     matvar->internal->z->next_out = (Bytef*)buf;
     err = inflate(matvar->internal->z,Z_NO_FLUSH);
     if ( err != Z_OK ) {
diff --git a/src/mat5.c b/src/mat5.c
index 2841b58..fafd3c1 100644
--- a/src/mat5.c
+++ b/src/mat5.c
@@ -825,7 +825,7 @@ WriteCompressedEmptyData(mat_t *mat,z_streamp z,int N,
         case MAT_T_DOUBLE:
         {
             int i;
-            mat_uint32_t uncomp_buf[32] = {0,};
+            mat_uint32_t uncomp_buf[4096] = {0,};
             mat_uint32_t comp_buf[32] = {0,};
             double data_uncomp_buf[4] = {0.0,};
 
@@ -1213,7 +1213,7 @@ ReadNextCell( mat_t *mat, matvar_t *matvar )
 
     if ( matvar->compression == MAT_COMPRESSION_ZLIB ) {
 #if defined(HAVE_ZLIB)
-        mat_uint32_t uncomp_buf[16] = {0,};
+        mat_uint32_t uncomp_buf[4096] = {0,};
         int nbytes;
         mat_uint32_t array_flags;
         int err;
@@ -1489,7 +1489,7 @@ ReadNextStructField( mat_t *mat, matvar_t *matvar )
 
     if ( matvar->compression == MAT_COMPRESSION_ZLIB ) {
 #if defined(HAVE_ZLIB)
-        mat_uint32_t uncomp_buf[16] = {0,};
+        mat_uint32_t uncomp_buf[4096] = {0,};
         int nbytes;
         mat_uint32_t array_flags;
         int err;
@@ -2353,7 +2353,7 @@ WriteCompressedTypeArrayFlags(mat_t *mat,matvar_t *matvar,z_streamp z)
     int nBytes, i, nmemb = 1, nzmax = 0;
 
     mat_uint32_t comp_buf[512];
-    mat_uint32_t uncomp_buf[512] = {0,};
+    mat_uint32_t uncomp_buf[4096] = {0,};
     int buf_size = 512;
     size_t byteswritten = 0;
 
@@ -2435,7 +2435,7 @@ WriteCompressedType(mat_t *mat,matvar_t *matvar,z_streamp z)
 {
     int j;
     mat_uint32_t comp_buf[512];
-    mat_uint32_t uncomp_buf[512] = {0,};
+    mat_uint32_t uncomp_buf[4096] = {0,};
     size_t byteswritten = 0, nmemb = 1;
 
     if ( MAT_C_EMPTY == matvar->class_type ) {
@@ -2612,7 +2612,7 @@ static size_t
 WriteCompressedCellArrayField(mat_t *mat,matvar_t *matvar,z_streamp z)
 {
     mat_uint32_t comp_buf[512];
-    mat_uint32_t uncomp_buf[512] = {0,};
+    mat_uint32_t uncomp_buf[4096] = {0,};
     int buf_size = 512;
     size_t byteswritten = 0;
 
@@ -2735,7 +2735,7 @@ static size_t
 WriteCompressedStructField(mat_t *mat,matvar_t *matvar,z_streamp z)
 {
     mat_uint32_t comp_buf[512];
-    mat_uint32_t uncomp_buf[512] = {0,};
+    mat_uint32_t uncomp_buf[4096] = {0,};
     int buf_size = 512;
     size_t byteswritten = 0;
 
@@ -2861,7 +2861,7 @@ Mat_WriteCompressedEmptyVariable5(mat_t *mat,const char *name,int rank,
     int nBytes, i, nmemb = 1;
 
     mat_uint32_t comp_buf[512];
-    mat_uint32_t uncomp_buf[512] = {0,};
+    mat_uint32_t uncomp_buf[4096] = {0,};
     int buf_size = 512;
     size_t byteswritten = 0, buf_size_bytes;
 
@@ -5050,7 +5050,7 @@ Mat_VarWrite5(mat_t *mat,matvar_t *matvar,int compress)
 #if defined(HAVE_ZLIB)
     } else if ( compress == MAT_COMPRESSION_ZLIB ) {
         mat_uint32_t comp_buf[512];
-        mat_uint32_t uncomp_buf[512] = {0,};
+        mat_uint32_t uncomp_buf[4096] = {0,};
         int buf_size = 512, err;
         size_t byteswritten = 0;
         z_streamp z;
@@ -5384,7 +5384,7 @@ WriteInfo5(mat_t *mat, matvar_t *matvar)
     } else if ( matvar->compression == MAT_COMPRESSION_ZLIB ) {
 #if defined(HAVE_ZLIB)
         mat_uint32_t comp_buf[512];
-        mat_uint32_t uncomp_buf[512] = {0,};
+        mat_uint32_t uncomp_buf[4096] = {0,};
         int buf_size = 512, err;
         size_t byteswritten = 0;
 
@@ -5588,7 +5588,7 @@ Mat_VarReadNextInfo5( mat_t *mat )
         case MAT_T_COMPRESSED:
         {
 #if defined(HAVE_ZLIB)
-            mat_uint32_t uncomp_buf[16] = {0,};
+            mat_uint32_t uncomp_buf[4096] = {0,};
             int      nbytes;
             long     bytesread = 0;