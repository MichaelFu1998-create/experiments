diff --git a/src/njs_function.h b/src/njs_function.h
index c6299cd..0a92607 100644
--- a/src/njs_function.h
+++ b/src/njs_function.h
@@ -152,6 +152,16 @@ njs_function_frame(njs_vm_t *vm, njs_function_t *function,
     const njs_value_t *this, const njs_value_t *args, njs_uint_t nargs,
     njs_bool_t ctor)
 {
+    /* Defensive check: protect against NULL or obviously invalid function
+     * pointer values to avoid segmentation faults when callers pass NULL or
+     * small/integer values. A small pointer (below 0x1000) is unlikely to be
+     * valid and indicates a bug in the caller. Return error so the caller can
+     * handle it.
+     */
+    if (njs_slow_path(function == NULL || (void *) function == NJS_PROP_PTR_UNSET || (uintptr_t) function < 0x1000)) {
+        return NJS_ERROR;
+    }
+
     if (function->native) {
         return njs_function_native_frame(vm, function, this, args, nargs, ctor);
 
diff --git a/src/njs_object_prop.c b/src/njs_object_prop.c
index 6bf1c28..4e42c9a 100644
--- a/src/njs_object_prop.c
+++ b/src/njs_object_prop.c
@@ -128,7 +128,7 @@ found:
         return NJS_OK;
     }
 
-    if (njs_prop_getter(prop) == NULL) {
+    if (njs_prop_getter(prop) == NULL || njs_prop_getter(prop) == NJS_PROP_PTR_UNSET) {
         njs_set_undefined(retval);
         return NJS_OK;
     }
diff --git a/src/njs_value.c b/src/njs_value.c
index 296f057..4d5ee10 100644
--- a/src/njs_value.c
+++ b/src/njs_value.c
@@ -1130,7 +1130,7 @@ slow_path:
                 break;
             }
 
-            if (njs_prop_getter(prop) == NULL) {
+            if (njs_prop_getter(prop) == NULL || njs_prop_getter(prop) == NJS_PROP_PTR_UNSET) {
                 njs_set_undefined(retval);
                 break;
             }
@@ -1465,7 +1465,7 @@ slow_path:
             break;
         }
 
-        if (njs_prop_getter(prop) == NULL) {
+        if (njs_prop_getter(prop) == NULL || njs_prop_getter(prop) == NJS_PROP_PTR_UNSET) {
             njs_set_undefined(removed);
             break;
         }