diff --git a/src/njs_lvlhsh.c b/src/njs_lvlhsh.c
index 8443a08..93bcd2d 100644
--- a/src/njs_lvlhsh.c
+++ b/src/njs_lvlhsh.c
@@ -178,6 +178,16 @@ njs_lvlhsh_find(const njs_lvlhsh_t *lh, njs_lvlhsh_query_t *lhq)
     if (njs_fast_path(slot != NULL)) {
 
         if (njs_lvlhsh_is_bucket(slot)) {
+            /* Validate bucket pointer before dereferencing in bucket_find. */
+            uint32_t *bucket = njs_lvlhsh_bucket(lhq->proto, slot);
+            njs_uint_t entries = njs_lvlhsh_bucket_entries(lhq->proto, slot);
+
+            if (bucket == NULL || entries > lhq->proto->bucket_end
+                || (((uintptr_t) bucket & (njs_lvlhsh_bucket_size(lhq->proto) - 1)) != 0))
+            {
+                return NJS_DECLINED;
+            }
+
             return njs_lvlhsh_bucket_find(lhq, slot);
         }
 
@@ -205,6 +215,15 @@ njs_lvlhsh_level_find(njs_lvlhsh_query_t *lhq, void **lvl, uint32_t key,
     if (slot != NULL) {
 
         if (njs_lvlhsh_is_bucket(slot)) {
+            uint32_t *bucket = njs_lvlhsh_bucket(lhq->proto, slot);
+            njs_uint_t entries = njs_lvlhsh_bucket_entries(lhq->proto, slot);
+
+            if (bucket == NULL || entries > lhq->proto->bucket_end
+                || (((uintptr_t) bucket & (njs_lvlhsh_bucket_size(lhq->proto) - 1)) != 0))
+            {
+                return NJS_DECLINED;
+            }
+
             return njs_lvlhsh_bucket_find(lhq, slot);
         }
 
@@ -218,16 +237,46 @@ njs_lvlhsh_level_find(njs_lvlhsh_query_t *lhq, void **lvl, uint32_t key,
 static njs_int_t
 njs_lvlhsh_bucket_find(njs_lvlhsh_query_t *lhq, void **bkt)
 {
+    /*
+     * Guard against special marker values (e.g. NJS_LVLHSH_BUCKET_DONE)
+     * possibly passed here as a pointer.  Treat such cases as
+     * not-found instead of dereferencing an invalid address.
+     */
+    if ((void *) bkt == NJS_LVLHSH_BUCKET_DONE) {
+        return NJS_DECLINED;
+    }
     void        *value;
     uint32_t    *bucket, *e;
     njs_uint_t  n;
 
     do {
         bucket = njs_lvlhsh_bucket(lhq->proto, bkt);
+
+        /* Validate that we were passed an encoded bucket pointer. */
+        if (!njs_lvlhsh_is_bucket(bkt) || bucket == NULL) {
+            return NJS_DECLINED;
+        }
+
+        /* bucket must be aligned to the bucket size to be valid. */
+        if (((uintptr_t) bucket & (njs_lvlhsh_bucket_size(lhq->proto) - 1)) != 0) {
+            return NJS_DECLINED;
+        }
+
         n = njs_lvlhsh_bucket_entries(lhq->proto, bkt);
+
+        /* Sanity check entries count to avoid huge loops or OOB. */
+        if (n > lhq->proto->bucket_end) {
+            return NJS_DECLINED;
+        }
+
         e = bucket;
 
         do {
+            if (e >= njs_lvlhsh_bucket_end(lhq->proto, bucket)) {
+                /* Prevent out-of-bounds access into corrupted buckets. */
+                return NJS_DECLINED;
+            }
+
             if (njs_lvlhsh_valid_entry(e)) {
                 n--;