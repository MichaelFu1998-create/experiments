diff --git a/build/njs_auto_config.h b/build/njs_auto_config.h
new file mode 100644
index 0000000..8e9c19c
--- /dev/null
+++ b/build/njs_auto_config.h
@@ -0,0 +1,103 @@
+
+/* This file is auto-generated by configure */
+
+
+#ifndef NJS_LINUX
+#define NJS_LINUX  1
+#endif
+
+
+#ifndef NJS_CLANG
+#define NJS_CLANG  1
+#endif
+
+
+#ifndef NJS_HAVE_UNSIGNED_INT128
+#define NJS_HAVE_UNSIGNED_INT128  1
+#endif
+
+
+#ifndef NJS_HAVE_BUILTIN_EXPECT
+#define NJS_HAVE_BUILTIN_EXPECT  1
+#endif
+
+
+#ifndef NJS_HAVE_BUILTIN_UNREACHABLE
+#define NJS_HAVE_BUILTIN_UNREACHABLE  1
+#endif
+
+
+#ifndef NJS_HAVE_BUILTIN_PREFETCH
+#define NJS_HAVE_BUILTIN_PREFETCH  1
+#endif
+
+
+#ifndef NJS_HAVE_BUILTIN_CLZ
+#define NJS_HAVE_BUILTIN_CLZ  1
+#endif
+
+
+#ifndef NJS_HAVE_BUILTIN_CLZLL
+#define NJS_HAVE_BUILTIN_CLZLL  1
+#endif
+
+
+#ifndef NJS_HAVE_GCC_ATTRIBUTE_VISIBILITY
+#define NJS_HAVE_GCC_ATTRIBUTE_VISIBILITY  1
+#endif
+
+
+#ifndef NJS_HAVE_GCC_ATTRIBUTE_MALLOC
+#define NJS_HAVE_GCC_ATTRIBUTE_MALLOC  1
+#endif
+
+
+#ifndef NJS_HAVE_GCC_ATTRIBUTE_ALIGNED
+#define NJS_HAVE_GCC_ATTRIBUTE_ALIGNED  1
+#endif
+
+
+#ifndef NJS_HAVE_ADDRESS_SANITIZER
+#define NJS_HAVE_ADDRESS_SANITIZER  1
+#endif
+
+
+#ifndef NJS_NAN_TO_UINT_CONVERSION
+#define NJS_NAN_TO_UINT_CONVERSION  0
+#endif
+
+
+#ifndef NJS_HAVE_CLOCK_MONOTONIC
+#define NJS_HAVE_CLOCK_MONOTONIC  1
+#endif
+
+
+#ifndef NJS_HAVE_TM_GMTOFF
+#define NJS_HAVE_TM_GMTOFF  1
+#endif
+
+
+#ifndef NJS_HAVE_POSIX_MEMALIGN
+#define NJS_HAVE_POSIX_MEMALIGN  1
+#endif
+
+
+#ifndef NJS_HAVE_GETRANDOM
+#define NJS_HAVE_GETRANDOM  1
+#endif
+
+
+#ifndef NJS_HAVE_EXPLICIT_BZERO
+#define NJS_HAVE_EXPLICIT_BZERO  1
+#endif
+
+
+#ifndef NJS_HAVE_PCRE
+#define NJS_HAVE_PCRE  1
+#endif
+
+
+#ifndef NJS_HAVE_GNU_READLINE
+#define NJS_HAVE_GNU_READLINE  1
+#endif
+
diff --git a/src/njs_regexp.c b/src/njs_regexp.c
index c488ce0..037641a 100644
--- a/src/njs_regexp.c
+++ b/src/njs_regexp.c
@@ -366,9 +366,12 @@ njs_regexp_literal(njs_vm_t *vm, njs_parser_t *parser, njs_value_t *value)
             flags = njs_regexp_flags(&p, lexer->end, 0);
 
             if (njs_slow_path(flags < 0)) {
-                njs_parser_syntax_error(vm, parser,
-                                        "Invalid RegExp flags \"%*s\"",
-                                        p - lexer->start, lexer->start);
+                njs_str_t sflags;
+                size_t avail = (size_t) (lexer->end - lexer->start);
+                size_t len = (size_t) (p - lexer->start);
+                sflags.length = (len < avail) ? len : avail;
+                sflags.start = lexer->start;
+                njs_parser_syntax_error(vm, parser, "Invalid RegExp flags \"%V\"", &sflags);
 
                 return NJS_TOKEN_ILLEGAL;
             }
@@ -390,8 +393,12 @@ njs_regexp_literal(njs_vm_t *vm, njs_parser_t *parser, njs_value_t *value)
 
 failed:
 
-    njs_parser_syntax_error(vm, parser, "Unterminated RegExp \"%*s\"",
-                            p - (lexer->start - 1), lexer->start - 1);
+    {
+        njs_str_t s;
+        s.length = p - lexer->start;
+        s.start = lexer->start;
+        njs_parser_syntax_error(vm, parser, "Unterminated RegExp \"%V\"", &s);
+    }
 
     return NJS_TOKEN_ILLEGAL;
 }
@@ -642,11 +649,20 @@ njs_regexp_compile_trace_handler(njs_trace_t *trace, njs_trace_data_t *td,
     p = trace->handler(trace, td, start);
 
     if (vm->parser != NULL && vm->parser->lexer != NULL) {
-        njs_syntax_error(vm, "%*s in %uD", p - start, start,
-                         vm->parser->lexer->line);
+        {
+        njs_str_t s;
+        s.length = p - start;
+        s.start = start;
+        njs_syntax_error(vm, "%V in %uD", &s, vm->parser->lexer->line);
+    }
 
     } else {
-        njs_syntax_error(vm, "%*s", p - start, start);
+        {
+        njs_str_t s;
+        s.length = p - start;
+        s.start = start;
+        njs_syntax_error(vm, "%V", &s);
+    }
     }
 
     return p;
diff --git a/src/njs_sprintf.c b/src/njs_sprintf.c
index 1f7358e..e70bb7e 100644
--- a/src/njs_sprintf.c
+++ b/src/njs_sprintf.c
@@ -125,6 +125,9 @@ njs_vsprintf(u_char *buf, u_char *end, const char *fmt, va_list args)
 
             if (njs_fast_path(v != NULL)) {
                 length = v->length;
+                if (length > NJS_MAX_ERROR_STR) {
+                    length = NJS_MAX_ERROR_STR;
+                }
                 p = v->start;
                 goto copy;
             }
@@ -146,6 +149,10 @@ njs_vsprintf(u_char *buf, u_char *end, const char *fmt, va_list args)
         case '*':
             length = va_arg(args, size_t);
 
+            if (length > NJS_MAX_ERROR_STR) {
+                length = NJS_MAX_ERROR_STR;
+            }
+
             fmt++;
 
             if (*fmt == 's') {