diff --git a/src/class.c b/src/class.c
index ec9c648..3907002 100644
--- a/src/class.c
+++ b/src/class.c
@@ -355,9 +355,11 @@ setup_class(mrb_state *mrb, struct RClass *outer, struct RClass *c, mrb_sym id)
 static void
 prepare_singleton_class(mrb_state *mrb, struct RBasic *o)
 {
+  if (o == NULL) return;
+
   struct RClass *sc, *c;
 
-  if (o->c->tt == MRB_TT_SCLASS) return;
+  if (o->c && o->c->tt == MRB_TT_SCLASS) return;
   sc = MRB_OBJ_ALLOC(mrb, MRB_TT_SCLASS, mrb->class_class);
   sc->flags |= MRB_FL_CLASS_IS_INHERITED;
   sc->mt = mt_new(mrb);
@@ -373,10 +375,17 @@ prepare_singleton_class(mrb_state *mrb, struct RBasic *o)
   }
   else if (o->tt == MRB_TT_SCLASS) {
     c = (struct RClass*)o;
-    while (c->super->tt == MRB_TT_ICLASS)
+    /* c->super may be NULL in some edge cases, guard access */
+    while (c->super && c->super->tt == MRB_TT_ICLASS)
       c = c->super;
-    make_metaclass(mrb, c->super);
-    sc->super = c->super->c;
+    if (c->super) {
+      make_metaclass(mrb, c->super);
+      sc->super = c->super->c;
+    }
+    else {
+      /* fallback to class_class if no super is present */
+      sc->super = mrb->class_class;
+    }
   }
   else {
     sc->super = o->c;