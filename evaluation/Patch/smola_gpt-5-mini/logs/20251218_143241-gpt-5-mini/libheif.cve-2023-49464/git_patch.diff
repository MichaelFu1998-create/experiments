diff --git a/libheif/uncompressed_image.cc b/libheif/uncompressed_image.cc
index 5218165..5d77edf 100644
--- a/libheif/uncompressed_image.cc
+++ b/libheif/uncompressed_image.cc
@@ -364,7 +364,13 @@ static Error uncompressed_image_type_is_supported(std::shared_ptr<Box_uncC>& unc
 {
   for (Box_uncC::Component component : uncC->get_components()) {
     uint16_t component_index = component.component_index;
-    uint16_t component_type = cmpd->get_components()[component_index].component_type;
+    const auto& cmpd_components = cmpd->get_components();
+    if (component_index >= cmpd_components.size()) {
+      std::stringstream sstr;
+      sstr << "cmpd references non-existing component index " << component_index;
+      return Error(heif_error_Invalid_input, heif_suberror_Invalid_parameter_value, sstr.str());
+    }
+    uint16_t component_type = cmpd_components[component_index].component_type;
     if (component_type > 7) {
       std::stringstream sstr;
       sstr << "Uncompressed image with component_type " << ((int) component_type) << " is not implemented yet";
@@ -466,7 +472,13 @@ static Error get_heif_chroma_uncompressed(std::shared_ptr<Box_uncC>& uncC, std::
 
   for (Box_uncC::Component component : uncC->get_components()) {
     uint16_t component_index = component.component_index;
-    uint16_t component_type = cmpd->get_components()[component_index].component_type;
+    const auto& cmpd_components = cmpd->get_components();
+    if (component_index >= cmpd_components.size()) {
+      std::stringstream sstr;
+      sstr << "cmpd references non-existing component index " << component_index;
+      return Error(heif_error_Invalid_input, heif_suberror_Invalid_parameter_value, sstr.str());
+    }
+    uint16_t component_type = cmpd_components[component_index].component_type;
 
     if (component_type > component_type_max_valid) {
       std::stringstream sstr;
@@ -534,7 +546,13 @@ int UncompressedImageCodec::get_luma_bits_per_pixel_from_configuration_unci(cons
   int alternate_channel_bits = 0;
   for (Box_uncC::Component component : uncC_box->get_components()) {
     uint16_t component_index = component.component_index;
-    auto component_type = cmpd_box->get_components()[component_index].component_type;
+    const auto& cmpd_components = cmpd_box->get_components();
+    if (component_index >= cmpd_components.size()) {
+      // Malformed file may reference a non-existing component index. Avoid
+      // out-of-bounds access by skipping such entries.
+      continue;
+    }
+    auto component_type = cmpd_components[component_index].component_type;
     switch (component_type) {
       case component_type_monochrome:
       case component_type_red:
@@ -681,7 +699,13 @@ Error UncompressedImageCodec::decode_uncompressed_image(const std::shared_ptr<co
   uint32_t componentOffset = 0;
   for (Box_uncC::Component component : uncC->get_components()) {
     uint16_t component_index = component.component_index;
-    uint16_t component_type = cmpd->get_components()[component_index].component_type;
+    const auto& cmpd_components = cmpd->get_components();
+    if (component_index >= cmpd_components.size()) {
+      std::stringstream sstr;
+      sstr << "cmpd references non-existing component index " << component_index;
+      return Error(heif_error_Invalid_input, heif_suberror_Invalid_parameter_value, sstr.str());
+    }
+    uint16_t component_type = cmpd_components[component_index].component_type;
     if (component_type == component_type_Y ||
         component_type == component_type_monochrome) {
       img->add_plane(heif_channel_Y, width, height, component.component_bit_depth);
@@ -1146,4 +1170,4 @@ Error UncompressedImageCodec::encode_uncompressed_image(const std::shared_ptr<He
   heif_file->add_property(out_image->get_id(), ispe, true);
 
   return Error::Ok;
-}
+}
\ No newline at end of file