diff --git a/src/njs_function.c b/src/njs_function.c
index c9d4d97..7a34f98 100644
--- a/src/njs_function.c
+++ b/src/njs_function.c
@@ -546,7 +546,12 @@ njs_function_frame_alloc(njs_vm_t *vm, size_t size)
     size_t              spare_size, chunk_size;
     njs_native_frame_t  *frame;
 
-    spare_size = vm->top_frame ? vm->top_frame->free_size : 0;
+    /* Do not reuse spare space from previous frames. Reusing freed
+     * frame chunks can lead to use-after-free when saved frames
+     * reference memory from those chunks. Always allocate a fresh
+     * chunk to back a new frame.
+     */
+    spare_size = 0;
 
     if (njs_fast_path(size <= spare_size)) {
         frame = (njs_native_frame_t *) vm->top_frame->free;
@@ -793,12 +798,31 @@ njs_function_frame_free(njs_vm_t *vm, njs_native_frame_t *native)
         /* GC: free frame->local, etc. */
 
         if (native->size != 0) {
+            /*
+             * Avoid freeing the memory of frame chunks immediately.
+             * Saved frames may refer to data within these chunks and
+             * freeing them can lead to use-after-free when the memory
+             * is reallocated.  Rather than free the memory, just mark
+             * the chunk as unused by zeroing size and updating the
+             * stack accounting.  This trades a small memory leak for
+             * correctness and safety.
+             */
             vm->stack_size -= native->size;
-            njs_mp_free(vm->mem_pool, native);
+            /* Do not call njs_mp_free() here to avoid reuse of the
+             * freed memory region which may still be referenced.
+             */
+            native->size = 0;
+            native->free = NULL;
+            native->free_size = 0;
         }
 
         native = previous;
-    } while (native->skip);
+    } while (native != NULL && native->skip);
+
+    /* Update vm->top_frame to the first non-skipped frame (may be NULL).
+     * This prevents vm->top_frame from pointing into already freed memory.
+     */
+    vm->top_frame = native;
 }
 
 
@@ -831,6 +855,11 @@ njs_function_frame_save(njs_vm_t *vm, njs_frame_t *frame, u_char *pc)
     native->temp = new + value_count;
     native->pc = pc;
 
+    /* Saved frames do not own spare chunk space. */
+    native->free = NULL;
+    native->free_size = 0;
+    native->size = 0;
+
     start = njs_function_frame_values(active, &end);
     p = native->arguments;