diff --git a/src/isomedia/isom_read.c b/src/isomedia/isom_read.c
index 5a8109e..aaef0c2 100644
--- a/src/isomedia/isom_read.c
+++ b/src/isomedia/isom_read.c
@@ -2768,7 +2768,7 @@ u32 gf_isom_get_user_data_count(GF_ISOFile *movie, u32 trackNumber, u32 UserData
 	while ((map = (GF_UserDataMap*)gf_list_enum(udta->recordList, &i))) {
 		count = gf_list_count(map->boxes);
 
-		if ((map->boxType == GF_ISOM_BOX_TYPE_UUID) && !memcmp(map->uuid, UUID, 16)) return count;
+		if ((map->boxType == GF_ISOM_BOX_TYPE_UUID) && UUID && !memcmp(map->uuid, UUID, 16)) return count;
 		else if (map->boxType == UserDataType) return count;
 	}
 	return 0;
@@ -2804,8 +2804,10 @@ GF_Err gf_isom_get_user_data(GF_ISOFile *movie, u32 trackNumber, u32 UserDataTyp
 
 	i=0;
 	while ((map = (GF_UserDataMap*)gf_list_enum(udta->recordList, &i))) {
-		if ((map->boxType == GF_ISOM_BOX_TYPE_UUID) && !memcmp(map->uuid, UUID, 16)) goto found;
-		else if (map->boxType == UserDataType) goto found;
+		if (map->boxType == GF_ISOM_BOX_TYPE_UUID) {
+			/* protect against NULL UUID pointer passed by callers */
+			if (UUID && !memcmp(map->uuid, UUID, 16)) goto found;
+		} else if (map->boxType == UserDataType) goto found;
 
 	}
 	return GF_BAD_PARAM;