diff --git a/coders/dcm.c b/coders/dcm.c
index edc09e9..10f6899 100644
--- a/coders/dcm.c
+++ b/coders/dcm.c
@@ -3024,8 +3024,13 @@ static void *RelinquishDCMInfo(void *memory)
 }
 
 static inline void RelinquishDCMMemory(DCMInfo *info,DCMMap *map,
-  DCMStreamInfo *stream_info,LinkedListInfo *stack,unsigned char *data)
+  DCMStreamInfo **stream_info_ptr,LinkedListInfo **stack_ptr,
+  unsigned char **data_ptr)
 {
+  DCMStreamInfo *stream_info = (stream_info_ptr != (DCMStreamInfo **) NULL) ? *stream_info_ptr : (DCMStreamInfo *) NULL;
+  LinkedListInfo *stack = (stack_ptr != (LinkedListInfo **) NULL) ? *stack_ptr : (LinkedListInfo *) NULL;
+  unsigned char *data = (data_ptr != (unsigned char **) NULL) ? *data_ptr : (unsigned char *) NULL;
+
   if (info->scale != (Quantum *) NULL)
     info->scale=(Quantum *) RelinquishMagickMemory(info->scale);
   if (map->gray != (int *) NULL)
@@ -3036,22 +3041,35 @@ static inline void RelinquishDCMMemory(DCMInfo *info,DCMMap *map,
     map->green=(int *) RelinquishMagickMemory(map->green);
   if (map->red != (int *) NULL)
     map->red=(int *) RelinquishMagickMemory(map->red);
-  if (stream_info->offsets != (ssize_t *) NULL)
-    stream_info->offsets=(ssize_t *) RelinquishMagickMemory(
-      stream_info->offsets);
   if (stream_info != (DCMStreamInfo *) NULL)
-    stream_info=(DCMStreamInfo *) RelinquishMagickMemory(stream_info);
+    {
+      if (stream_info->offsets != (ssize_t *) NULL)
+        stream_info->offsets=(ssize_t *) RelinquishMagickMemory(
+          stream_info->offsets);
+      stream_info=(DCMStreamInfo *) RelinquishMagickMemory(stream_info);
+      if (stream_info_ptr != (DCMStreamInfo **) NULL)
+        *stream_info_ptr = (DCMStreamInfo *) NULL;
+    }
   if (stack != (LinkedListInfo *) NULL)
-    stack=DestroyLinkedList(stack,RelinquishDCMInfo);
+    {
+      DestroyLinkedList(stack,RelinquishDCMInfo);
+      if (stack_ptr != (LinkedListInfo **) NULL)
+        *stack_ptr = (LinkedListInfo *) NULL;
+    }
   if (data != (unsigned char *) NULL)
-    data=(unsigned char *) RelinquishMagickMemory(data);
+    {
+      data=(unsigned char *) RelinquishMagickMemory(data);
+      if (data_ptr != (unsigned char **) NULL)
+        *data_ptr = (unsigned char *) NULL;
+    }
 }
 
+
 static Image *ReadDCMImage(const ImageInfo *image_info,ExceptionInfo *exception)
 {
 #define ThrowDCMException(exception,message) \
 { \
-  RelinquishDCMMemory(&info,&map,stream_info,stack,data); \
+  RelinquishDCMMemory(&info,&map,&stream_info,&stack,&data); \
   ThrowReaderException((exception),(message)); \
 }
 
@@ -3996,7 +4014,7 @@ static Image *ReadDCMImage(const ImageInfo *image_info,ExceptionInfo *exception)
           (void) RelinquishUniqueFileResource(filename);
         }
         read_info=DestroyImageInfo(read_info);
-        RelinquishDCMMemory(&info,&map,stream_info,stack,data);
+        RelinquishDCMMemory(&info,&map,&stream_info,&stack,&data);
         image=DestroyImageList(image);
         if ((status == MagickFalse) && (exception->severity < ErrorException))
           ThrowDCMException(CorruptImageError,"CorruptImageError")
@@ -4341,7 +4359,7 @@ static Image *ReadDCMImage(const ImageInfo *image_info,ExceptionInfo *exception)
   /*
     Free resources.
   */
-  RelinquishDCMMemory(&info,&map,stream_info,stack,data);
+  RelinquishDCMMemory(&info,&map,&stream_info,&stack,&data);
   if (image == (Image *) NULL)
     return(image);
   (void) CloseBlob(image);