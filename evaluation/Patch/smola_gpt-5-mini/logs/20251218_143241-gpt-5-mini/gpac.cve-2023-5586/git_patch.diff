diff --git a/src/filter_core/filter_pck.c b/src/filter_core/filter_pck.c
index b093e8a..cbda967 100644
--- a/src/filter_core/filter_pck.c
+++ b/src/filter_core/filter_pck.c
@@ -101,6 +101,14 @@ static void pck_queue_enum(void *udta, void *item)
 
 static GF_FilterPacket *gf_filter_pck_new_alloc_internal(GF_FilterPid *pid, u32 data_size, u8 **data)
 {
+	if (!pid) {
+		GF_LOG(GF_LOG_ERROR, GF_LOG_FILTER, ("Attempt to allocate a packet with NULL PID\n"));
+		return NULL;
+	}
+	if (!pid->filter) {
+		GF_LOG(GF_LOG_ERROR, GF_LOG_FILTER, ("Attempt to allocate a packet with NULL filter in PID %s\n", pid->name ? pid->name : "<unknown>"));
+		return NULL;
+	}
 	GF_FilterPacket *pck=NULL;
 	GF_FilterPacket *closest=NULL;
 	u32 count, max_reservoir_size;