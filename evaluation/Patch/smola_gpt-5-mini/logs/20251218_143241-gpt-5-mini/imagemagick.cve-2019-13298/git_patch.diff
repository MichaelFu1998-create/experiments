diff --git a/MagickCore/enhance.c b/MagickCore/enhance.c
index ed32027..a29c1cb 100644
--- a/MagickCore/enhance.c
+++ b/MagickCore/enhance.c
@@ -36,7 +36,8 @@
 %
 %
 */
-
+
+
 /*
   Include declarations.
 */
@@ -82,7 +83,8 @@
 #include "MagickCore/token.h"
 #include "MagickCore/xml-tree.h"
 #include "MagickCore/xml-tree-private.h"
-
+
+
 /*
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %                                                                             %
@@ -156,7 +158,8 @@ MagickExport MagickBooleanType AutoGammaImage(Image *image,
   }
   return(status != 0 ? MagickTrue : MagickFalse);
 }
-
+
+
 /*
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %                                                                             %
@@ -187,7 +190,8 @@ MagickExport MagickBooleanType AutoLevelImage(Image *image,
 {
   return(MinMaxStretchImage(image,0.0,0.0,1.0,exception));
 }
-
+
+
 /*
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %                                                                             %
@@ -250,7 +254,8 @@ MagickExport MagickBooleanType BrightnessContrastImage(Image *image,
   status=FunctionImage(image,PolynomialFunction,2,coefficients,exception);
   return(status);
 }
-
+
+
 /*
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %                                                                             %
@@ -782,7 +787,8 @@ MagickExport MagickBooleanType CLAHEImage(Image *image,const size_t width,
     status=MagickFalse;
   return(status);
 }
-
+
+
 /*
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %                                                                             %
@@ -961,7 +967,8 @@ MagickExport MagickBooleanType ClutImage(Image *image,const Image *clut_image,
     (void) SetImageAlphaChannel(image,ActivateAlphaChannel,exception);
   return(status);
 }
-
+
+
 /*
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %                                                                             %
@@ -1336,7 +1343,8 @@ MagickExport MagickBooleanType ColorDecisionListImage(Image *image,
   cdl_map=(PixelInfo *) RelinquishMagickMemory(cdl_map);
   return(status);
 }
-
+
+
 /*
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %                                                                             %
@@ -1508,7 +1516,8 @@ MagickExport MagickBooleanType ContrastImage(Image *image,
   image_view=DestroyCacheView(image_view);
   return(status);
 }
-
+
+
 /*
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %                                                                             %
@@ -1803,7 +1812,8 @@ MagickExport MagickBooleanType ContrastStretchImage(Image *image,
   black=(double *) RelinquishMagickMemory(black);
   return(status);
 }
-
+
+
 /*
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %                                                                             %
@@ -1973,7 +1983,7 @@ MagickExport Image *EnhanceImage(const Image *image,ExceptionInfo *exception)
           pixel.black=((aggregate.black+total_weight/2.0)/total_weight);
           pixel.alpha=((aggregate.alpha+total_weight/2.0)/total_weight);
         }
-      SetPixelViaPixelInfo(image,&pixel,q);
+      SetPixelViaPixelInfo(enhance_image,&pixel,q);
       p+=GetPixelChannels(image);
       q+=GetPixelChannels(enhance_image);
     }
@@ -1999,7 +2009,8 @@ MagickExport Image *EnhanceImage(const Image *image,ExceptionInfo *exception)
     enhance_image=DestroyImage(enhance_image);
   return(enhance_image);
 }
-
+
+
 /*
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %                                                                             %
@@ -2265,7 +2276,8 @@ MagickExport MagickBooleanType EqualizeImage(Image *image,
   equalize_map=(double *) RelinquishMagickMemory(equalize_map);
   return(status);
 }
-
+
+
 /*
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %                                                                             %
@@ -2430,7 +2442,8 @@ MagickExport MagickBooleanType GammaImage(Image *image,const double gamma,
     image->gamma*=gamma;
   return(status);
 }
-
+
+
 /*
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %                                                                             %
@@ -2638,7 +2651,8 @@ MagickExport MagickBooleanType GrayscaleImage(Image *image,
     return(SetImageColorspace(image,LinearGRAYColorspace,exception));
   return(SetImageColorspace(image,GRAYColorspace,exception));
 }
-
+
+
 /*
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %                                                                             %
@@ -2835,7 +2849,8 @@ MagickExport MagickBooleanType HaldClutImage(Image *image,
   image_view=DestroyCacheView(image_view);
   return(status);
 }
-
+
+
 /*
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %                                                                             %
@@ -3001,7 +3016,8 @@ MagickExport MagickBooleanType LevelImage(Image *image,const double black_point,
   (void) ClampImage(image,exception);
   return(status);
 }
-
+
+
 /*
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %                                                                             %
@@ -3151,7 +3167,8 @@ MagickExport MagickBooleanType LevelizeImage(Image *image,
   image_view=DestroyCacheView(image_view);
   return(status);
 }
-
+
+
 /*
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %                                                                             %
@@ -3297,7 +3314,8 @@ MagickExport MagickBooleanType LevelImageColors(Image *image,
     }
   return(status != 0 ? MagickTrue : MagickFalse);
 }
-
+
+
 /*
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %                                                                             %
@@ -3865,7 +3883,8 @@ MagickExport MagickBooleanType ModulateImage(Image *image,const char *modulate,
   image_view=DestroyCacheView(image_view);
   return(status);
 }
-
+
+
 /*
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %                                                                             %
@@ -4060,7 +4079,8 @@ MagickExport MagickBooleanType NegateImage(Image *image,
   image_view=DestroyCacheView(image_view);
   return(status);
 }
-
+
+
 /*
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %                                                                             %
@@ -4098,7 +4118,8 @@ MagickExport MagickBooleanType NormalizeImage(Image *image,
   white_point=(double) image->columns*image->rows*0.9995;
   return(ContrastStretchImage(image,black_point,white_point,exception));
 }
-
+
+
 /*
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %                                                                             %