diff --git a/src/decode_r2007.c b/src/decode_r2007.c
index ca1f23d..58deaaa 100644
--- a/src/decode_r2007.c
+++ b/src/decode_r2007.c
@@ -663,7 +663,19 @@ read_system_page (Bit_Chain *dat, int64_t size_comp, int64_t size_uncomp,
   if (size_comp < size_uncomp)
     error = decompress_r2007 (data, size_uncomp, pedata, MIN (pedata_size, size_comp));
   else
-    memcpy (data, pedata, size_uncomp);
+    {
+      /* Ensure we do not read past the decoded pre-RS data. If the
+         pre-RS data is smaller than the expected uncompressed size,
+         treat this as an error instead of overflowing the heap buffer. */
+      if ((unsigned long)pedata_size < (unsigned long)size_uncomp)
+        {
+          LOG_ERROR ("Invalid pre-RS data size %ld < %ld", (long)pedata_size, (long)size_uncomp);
+          free (pedata);
+          free (data);
+          return NULL;
+        }
+      memcpy (data, pedata, size_uncomp);
+    }
   free (pedata);
 
   if (error >= DWG_ERR_CRITICAL)