diff --git a/mrbgems/mruby-sprintf/src/sprintf.c b/mrbgems/mruby-sprintf/src/sprintf.c
index 7eea1a1..9253b8c 100644
--- a/mrbgems/mruby-sprintf/src/sprintf.c
+++ b/mrbgems/mruby-sprintf/src/sprintf.c
@@ -121,8 +121,9 @@ mrb_fix2binstr(mrb_state *mrb, mrb_value x, int base)
 #define CHECK(l) do {\
 /*  int cr = ENC_CODERANGE(result);*/\
   while ((l) >= bsiz - blen) {\
-    bsiz*=2;\
-    if (bsiz < 0) mrb_raise(mrb, E_ARGUMENT_ERROR, "too big specifier"); \
+    /* Prevent signed overflow when doubling bsiz. */\
+    if (bsiz > MRB_INT_MAX/2) mrb_raise(mrb, E_ARGUMENT_ERROR, "too big specifier"); \
+    bsiz = bsiz * 2;\
   }\
   mrb_str_resize(mrb, result, bsiz);\
 /*  ENC_CODERANGE_SET(result, cr);*/\