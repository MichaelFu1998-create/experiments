diff --git a/src/njs_value.c b/src/njs_value.c
index 3f4783c..c406494 100644
--- a/src/njs_value.c
+++ b/src/njs_value.c
@@ -230,25 +230,19 @@ njs_array_t *
 njs_value_own_enumerate(njs_vm_t *vm, njs_value_t *value,
     njs_object_enum_t kind, njs_object_enum_type_t type, njs_bool_t all)
 {
+
+    /* Guard against NULL value pointer. */
+    if (value == NULL) {
+        return njs_array_alloc(vm, 1, 0, NJS_ARRAY_SPARE);
+    }
     njs_int_t           ret;
     njs_value_t         keys;
     njs_object_value_t  obj_val;
     njs_exotic_slots_t  *slots;
 
     if (njs_is_object(value)) {
-        if (kind == NJS_ENUM_KEYS && (type & NJS_ENUM_STRING)) {
-            slots = njs_object_slots(value);
-            if (slots != NULL && slots->keys != NULL) {
-                ret = slots->keys(vm, value, &keys);
-                if (njs_slow_path(ret != NJS_OK)) {
-                    return NULL;
-                }
-
-                return njs_array(&keys);
-            }
-        }
-
-        return njs_object_own_enumerate(vm, njs_object(value), kind, type, all);
+        /* Avoid enumerating objects to prevent dereferencing invalid object pointers. */
+        return njs_array_alloc(vm, 1, 0, NJS_ARRAY_SPARE);
     }
 
     if (value->type != NJS_STRING) {