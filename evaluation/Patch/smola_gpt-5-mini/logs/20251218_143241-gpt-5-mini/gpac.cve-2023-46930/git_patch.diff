diff --git a/src/isomedia/media_odf.c b/src/isomedia/media_odf.c
index 76ecf9d..aca34d6 100644
--- a/src/isomedia/media_odf.c
+++ b/src/isomedia/media_odf.c
@@ -517,10 +517,14 @@ u32 gf_isom_find_od_id_for_track(GF_ISOFile *file, u32 track)
 
 	i=0;
 	while ( (od_tk = (GF_TrackBox*)gf_list_enum(file->moov->trackList, &i))) {
+			/* ensure track structures are valid before dereferencing */
+			if (!od_tk || !od_tk->Header || !od_tk->Media || !od_tk->Media->handler || !od_tk->Media->information || !od_tk->Media->information->sampleTable || !od_tk->Media->information->sampleTable->SampleSize) continue;
+			if (od_tk->Media->handler->handlerType != GF_ISOM_MEDIA_OD) continue;
+
 		if (od_tk->Media->handler->handlerType != GF_ISOM_MEDIA_OD) continue;
 
 		for (j=0; j<od_tk->Media->information->sampleTable->SampleSize->sampleCount; j++) {
-			GF_ISOSample *samp = gf_isom_get_sample(file, i, j+1, &di);
+			GF_ISOSample *samp = gf_isom_get_sample(file, od_tk->Header->trackID, j+1, &di);
 			the_od_id = Media_FindOD_ID(od_tk->Media, samp, tk->Header->trackID);
 			gf_isom_sample_del(&samp);
 			if (the_od_id) return the_od_id;