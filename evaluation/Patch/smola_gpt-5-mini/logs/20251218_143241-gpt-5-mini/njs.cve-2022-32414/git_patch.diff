diff --git a/src/njs_vmcode.c b/src/njs_vmcode.c
index ec47865..e05550b 100644
--- a/src/njs_vmcode.c
+++ b/src/njs_vmcode.c
@@ -797,7 +797,16 @@ next:
                 pnext = (njs_vmcode_prop_next_t *) pc;
                 retval = njs_scope_value(vm, pnext->retval);
 
+                value2 = njs_scope_value(vm, pnext->next);
+                if (njs_slow_path(value2 == NULL)) {
+                    goto error;
+                }
+
                 next = value2->data.u.next;
+                if (njs_slow_path(next == NULL || next->array == NULL)) {
+                    njs_internal_error(vm, "invalid property iterator");
+                    return NJS_ERROR;
+                }
 
                 if (next->index < next->array->length) {
                     *retval = next->array->start[next->index++];