diff --git a/src/futils.cpp b/src/futils.cpp
index d1427188..7c8343ee 100644
--- a/src/futils.cpp
+++ b/src/futils.cpp
@@ -53,7 +53,7 @@ EXIV2_RCSID("@(#) $Id$")
 # ifdef EXV_STRERROR_R_CHAR_P
 extern char *strerror_r(int errnum, char *buf, size_t n);
 # else
-extern int strerror_r(int errnum, char *buf, size_t n);
+extern char *strerror_r(int errnum, char *buf, size_t n);
 # endif
 #endif
 
@@ -241,8 +241,8 @@ namespace Exiv2 {
     Protocol fileProtocol(const std::string& path) {
         Protocol result = pFile ;
         struct {
-        	std::string name ;
-        	Protocol    prot ;
+                std::string name ;
+                Protocol    prot ;
         } prots[] =
         { { "http://"   ,pHttp     }
         , { "https://"  ,pHttps    }
@@ -254,8 +254,8 @@ namespace Exiv2 {
         , { "-"         ,pStdin    }
         };
         for ( size_t i = 0 ; result == pFile && i < sizeof(prots)/sizeof(prots[0]) ; i ++ )
-        	if ( path.find(prots[i].name) == 0 )
-        		result = prots[i].prot;
+                if ( path.find(prots[i].name) == 0 )
+                        result = prots[i].prot;
 
         return result;
     } // fileProtocol
@@ -263,8 +263,8 @@ namespace Exiv2 {
     Protocol fileProtocol(const std::wstring& wpath) {
         Protocol result = pFile ;
         struct {
-        	std::wstring wname ;
-        	Protocol      prot ;
+                std::wstring wname ;
+                Protocol      prot ;
         } prots[] =
         { { L"http://"   ,pHttp     }
         , { L"https://"  ,pHttps    }
@@ -276,21 +276,21 @@ namespace Exiv2 {
         , { L"-"         ,pStdin    }
         };
         for ( size_t i = 0 ; result == pFile && i < sizeof(prots)/sizeof(prots[0]) ; i ++ )
-        	if ( wpath.find(prots[i].wname) == 0 )
-        		result = prots[i].prot;
+                if ( wpath.find(prots[i].wname) == 0 )
+                        result = prots[i].prot;
 
         return result;
     } // fileProtocol
 #endif
     bool fileExists(const std::string& path, bool ct)
     {
-		// special case: accept "-" (means stdin)
+                // special case: accept "-" (means stdin)
         if (path.compare("-") == 0 || fileProtocol(path)) {
-			return true;
+                        return true;
         }
 
         struct stat buf;
-		int ret = ::stat(path.c_str(), &buf);
+                int ret = ::stat(path.c_str(), &buf);
         if (0 != ret)                    return false;
         if (ct && !S_ISREG(buf.st_mode)) return false;
         return true;
@@ -299,9 +299,9 @@ namespace Exiv2 {
 #ifdef EXV_UNICODE_PATH
     bool fileExists(const std::wstring& wpath, bool ct)
     {
-		// special case: accept "-" (means stdin)
+                // special case: accept "-" (means stdin)
         if (wpath.compare(L"-") == 0 || fileProtocol(wpath)) {
-			return true;
+                        return true;
         }
 
         struct _stat buf;
diff --git a/src/tiffvisitor.cpp b/src/tiffvisitor.cpp
index 4ab733d4..9e0b7766 100644
--- a/src/tiffvisitor.cpp
+++ b/src/tiffvisitor.cpp
@@ -1517,8 +1517,10 @@ namespace Exiv2 {
                 size = 0;
         }
         if (size > 4) {
-            pData = const_cast<byte*>(pData_) + baseOffset() + offset;
-            if (size > static_cast<uint32_t>(pLast_ - pData)) {
+            // Compute absolute offset and validate both lower and upper bounds before
+            // computing pData to avoid dereferencing invalid pointers.
+            uint64_t absOffset = (uint64_t)baseOffset() + (uint64_t)offset;
+            if (absOffset >= (uint64_t)size_ || absOffset + (uint64_t)size > (uint64_t)size_) {
 #ifndef SUPPRESS_WARNINGS
                 EXV_ERROR << "Upper boundary of data for "
                           << "directory " << groupName(object->group())
@@ -1530,10 +1532,13 @@ namespace Exiv2 {
                           << ", size = " << std::dec << size
                           << ", exceeds buffer size by "
                           // cast to make MSVC happy
-                          << static_cast<uint32_t>(pData + size - pLast_)
+                          << static_cast<uint32_t>( (uint64_t)absOffset + (uint64_t)size - (uint64_t)size_ )
                           << " Bytes; truncating the entry\n";
 #endif
+                // Special handling for Sony1 preview image already considered earlier
                 size = 0;
+            } else {
+                pData = const_cast<byte*>(pData_) + (size_t)absOffset;
             }
         }
         Value::AutoPtr v = Value::create(typeId);