diff --git a/programs/sndfile-deinterleave.c b/programs/sndfile-deinterleave.c
index e27593e..e2875d0 100644
--- a/programs/sndfile-deinterleave.c
+++ b/programs/sndfile-deinterleave.c
@@ -89,6 +89,11 @@ main (int argc, char **argv)
 		exit (1) ;
 		} ;
 
+	if (sfinfo.channels > MAX_CHANNELS)
+	{	printf ("\nError : Input file '%s' has too many channels (%d). Max supported is %d.\n", argv[1], sfinfo.channels, MAX_CHANNELS) ;
+		exit (1) ;
+		} ;
+
 	state.channels = sfinfo.channels ;
 	sfinfo.channels = 1 ;
 
@@ -168,6 +173,7 @@ deinterleave_int (STATE * state)
 		for (ch = 0 ; ch < state->channels ; ch ++)
 		{	for (k = 0 ; k < read_len ; k++)
 				state->dout.i [k] = state->din.i [k * state->channels + ch] ;
+			if (state->outfile [ch] != NULL)
 			sf_write_int (state->outfile [ch], state->dout.i, read_len) ;
 			} ;
 		}
@@ -186,6 +192,7 @@ deinterleave_double (STATE * state)
 		for (ch = 0 ; ch < state->channels ; ch ++)
 		{	for (k = 0 ; k < read_len ; k++)
 				state->dout.d [k] = state->din.d [k * state->channels + ch] ;
+			if (state->outfile [ch] != NULL)
 			sf_write_double (state->outfile [ch], state->dout.d, read_len) ;
 			} ;
 		}
diff --git a/src/sndfile.c b/src/sndfile.c
index b76bfe9..8f6cb27 100644
--- a/src/sndfile.c
+++ b/src/sndfile.c
@@ -1642,6 +1642,9 @@ sf_read_short	(SNDFILE *sndfile, short *ptr, sf_count_t len)
 
 	VALIDATE_SNDFILE_AND_ASSIGN_PSF (sndfile, psf, 1) ;
 
+	if (ptr == NULL)
+		return 0 ;
+
 	if (len <= 0)
 	{	psf->error = SFE_NEGATIVE_RW_LEN ;
 		return 0 ;
@@ -2250,6 +2253,9 @@ sf_count_t
 sf_write_int	(SNDFILE *sndfile, const int *ptr, sf_count_t len)
 {	SF_PRIVATE 	*psf ;
 	sf_count_t	count ;
+	if (sndfile == NULL)
+		return 0 ;
+
 
 	if (len == 0)
 		return 0 ;
@@ -2286,6 +2292,22 @@ sf_write_int	(SNDFILE *sndfile, const int *ptr, sf_count_t len)
 		} ;
 	psf->have_written = SF_TRUE ;
 
+	/* Defensive checks: ensure pointers and function pointers are valid before calling into backend write. */
+	if (psf == NULL)
+		return 0 ;
+
+	if (ptr == NULL)
+	{
+		psf->error = SFE_BAD_INT_PTR ;
+		return 0 ;
+	}
+
+	if (psf->write_int == NULL)
+	{
+		psf->error = SFE_UNIMPLEMENTED ;
+		return 0 ;
+	}
+
 	count = psf->write_int (psf, ptr, len) ;
 
 	psf->write_current += count / psf->sf.channels ;