diff --git a/src/njs_error.c b/src/njs_error.c
index 906dfd4..dff8ad2 100644
--- a/src/njs_error.c
+++ b/src/njs_error.c
@@ -592,6 +592,20 @@ njs_error_to_string2(njs_vm_t *vm, njs_value_t *retval,
         }
     }
 
+    if (!njs_is_object(error)) {
+        /* Convert non-object error to string representation. */
+        if (!njs_is_string(error)) {
+            ret = njs_value_to_string(vm, retval, error);
+            if (njs_slow_path(ret != NJS_OK)) {
+                return ret;
+            }
+        } else {
+            *retval = *error;
+        }
+
+        return NJS_OK;
+    }
+
     njs_object_property_init(&lhq, &njs_string_name, NJS_NAME_HASH);
 
     ret = njs_object_property(vm, error, &lhq, &value1);
diff --git a/src/njs_lvlhsh.c b/src/njs_lvlhsh.c
index 8443a08..5bfb207 100644
--- a/src/njs_lvlhsh.c
+++ b/src/njs_lvlhsh.c
@@ -173,6 +173,14 @@ njs_lvlhsh_find(const njs_lvlhsh_t *lh, njs_lvlhsh_query_t *lhq)
 {
     void  *slot;
 
+    if (njs_slow_path(lh == NULL)) {
+        return NJS_DECLINED;
+    }
+    /* Guard against obviously invalid pointers. */
+    if (njs_slow_path((uintptr_t) lh < 0x10000)) {
+        return NJS_DECLINED;
+    }
+
     slot = lh->slot;
 
     if (njs_fast_path(slot != NULL)) {
@@ -738,7 +746,15 @@ njs_lvlhsh_each(const njs_lvlhsh_t *lh, njs_lvlhsh_each_t *lhe)
     void  **slot;
 
     if (lhe->bucket == NJS_LVLHSH_BUCKET_DONE) {
-        slot = lh->slot;
+        if (njs_slow_path(lh == NULL)) {
+        return NULL;
+    }
+    /* Guard against obviously invalid pointers. */
+    if (njs_slow_path((uintptr_t) lh < 0x10000)) {
+        return NULL;
+    }
+
+    slot = lh->slot;
 
         if (njs_lvlhsh_is_bucket(slot)) {
             return NULL;
@@ -749,7 +765,15 @@ njs_lvlhsh_each(const njs_lvlhsh_t *lh, njs_lvlhsh_each_t *lhe)
 
             /* The first iteration only. */
 
-            slot = lh->slot;
+            if (njs_slow_path(lh == NULL)) {
+        return NULL;
+    }
+    /* Guard against obviously invalid pointers. */
+    if (njs_slow_path((uintptr_t) lh < 0x10000)) {
+        return NULL;
+    }
+
+    slot = lh->slot;
 
             if (slot == NULL) {
                 return NULL;
diff --git a/src/njs_object_prop.c b/src/njs_object_prop.c
index d829e1c..246b4e8 100644
--- a/src/njs_object_prop.c
+++ b/src/njs_object_prop.c
@@ -98,6 +98,11 @@ njs_object_property(njs_vm_t *vm, const njs_value_t *value,
     njs_object_t       *object;
     njs_object_prop_t  *prop;
 
+    if (njs_slow_path(!njs_is_object(value))) {
+        njs_set_undefined(retval);
+        return NJS_DECLINED;
+    }
+
     object = njs_object(value);
 
     do {