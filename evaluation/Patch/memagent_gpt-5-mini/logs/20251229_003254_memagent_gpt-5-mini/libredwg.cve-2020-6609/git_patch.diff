diff --git a/src/decode_r2007.c b/src/decode_r2007.c
index 37527b91..f1c45e4d 100644
--- a/src/decode_r2007.c
+++ b/src/decode_r2007.c
@@ -843,7 +843,7 @@ read_sections_map (Bit_Chain *dat, int64_t size_comp, int64_t size_uncomp,
 
   LOG_TRACE ("\n=== System Section (Section Map) ===\n")
 
-  while (ptr < ptr_end)
+  while (ptr + 64 <= ptr_end)
     {
       section = (r2007_section *)calloc (1, sizeof (r2007_section));
       if (!section)
@@ -992,7 +992,7 @@ read_pages_map (Bit_Chain *dat, int64_t size_comp, int64_t size_uncomp,
 
   LOG_TRACE ("\n=== System Section (Pages Map) ===\n")
 
-  while (ptr < ptr_end)
+while (ptr + 64 <= ptr_end)
     {
       page = (r2007_page *)malloc (sizeof (r2007_page));
       if (page == NULL)
diff --git a/src/dynapi.c b/src/dynapi.c
index 082d1784..729e5909 100644
--- a/src/dynapi.c
+++ b/src/dynapi.c
@@ -7762,6 +7762,7 @@ dwg_dynapi_entity_value (void *restrict _obj, const char *restrict name,
 #endif
   {
     int error;
+    if (!_obj) return false;
     const Dwg_Object* obj = dwg_obj_generic_to_object (_obj, &error);
     if (obj && strNE (obj->name, name)) // objid may be 0
       {