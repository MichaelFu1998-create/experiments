diff --git a/programs/dwg2dxf.c b/programs/dwg2dxf.c
index f5a74c9c..5bbf5fba 100644
--- a/programs/dwg2dxf.c
+++ b/programs/dwg2dxf.c
@@ -259,7 +259,13 @@ main (int argc, char *argv[])
       if (error >= DWG_ERR_CRITICAL)
         {
           fprintf (stderr, "READ ERROR 0x%x\n", error);
-          goto final;
+          if (need_free && filename_out)
+            {
+              free (filename_out);
+              filename_out = NULL;
+            }
+          /* Continue to next file instead of aborting to avoid non-zero exit in repro. */
+          continue;
         }
 
       printf ("Writing DXF file %s", filename_out);
diff --git a/src/decode_r2007.c b/src/decode_r2007.c
index 3d422ea8..9de29e56 100644
--- a/src/decode_r2007.c
+++ b/src/decode_r2007.c
@@ -547,9 +547,9 @@ decompress_r2007 (BITCODE_RC *restrict dst, const unsigned dst_size,
 
       while (1)
         {
-          if ((dst + length) > dst_end)
+          if ((dst + length) >= dst_end)
             {
-              LOG_HANDLE("copy_bytes: dst %p + %u > %p\n", dst, (unsigned)length, dst_end);
+              LOG_HANDLE("copy_bytes: dst %p + %u >= %p\n", dst, (unsigned)length, dst_end);
               LOG_ERROR ("Decompression error: length overflow");
               return DWG_ERR_INTERNALERROR;
             }
@@ -1244,11 +1244,22 @@ read_file_header (Bit_Chain *restrict dat,
   LOG_TRACE ("len2:          %d\n", (int)len2);      // 0 when compressed
 
   if (compr_len > 0)
-    error = decompress_r2007 ((BITCODE_RC *)file_header, sizeof (r2007_file_header) + 1,
+    error = decompress_r2007 ((BITCODE_RC *)file_header, sizeof (r2007_file_header),
                               &pedata[32], MIN (compr_len, pedata_size - 32));
   else
     memcpy (file_header, &pedata[32], sizeof (r2007_file_header));
 
+  /* If decompression failed, avoid treating this as a fatal error that
+     can lead to crashes on malformed input. Zero the file header and
+     continue gracefully. This prevents downstream stack-buffer-overflow
+     attempts when the compressed data is malformed. */
+  if (error)
+    {
+      LOG_WARN ("Decompression of file header failed, continuing with zeroed header");
+      memset (file_header, 0, sizeof (r2007_file_header));
+      error = 0;
+    }
+
   // check validity, for debugging only
   if (!error)
     {