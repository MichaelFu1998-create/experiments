diff --git a/coders/dcm.c b/coders/dcm.c
index 5f9cb02c7..9f6a169b9 100644
--- a/coders/dcm.c
+++ b/coders/dcm.c
@@ -3580,7 +3580,9 @@ static Image *ReadDCMImage(const ImageInfo *image_info,ExceptionInfo *exception)
               break;
             colors=(size_t) (length/2);
             datum=(int) colors;
-            redmap=(int *) AcquireQuantumMemory((size_t) colors,
+                        if (redmap != (int *) NULL)
+              redmap=(int *) RelinquishMagickMemory(redmap);
+redmap=(int *) AcquireQuantumMemory((size_t) colors,
               sizeof(*redmap));
             if (redmap == (int *) NULL)
               ThrowDCMException(ResourceLimitError,"MemoryAllocationFailed");
@@ -3608,7 +3610,9 @@ static Image *ReadDCMImage(const ImageInfo *image_info,ExceptionInfo *exception)
               break;
             colors=(size_t) (length/2);
             datum=(int) colors;
-            greenmap=(int *) AcquireQuantumMemory((size_t) colors,
+                        if (greenmap != (int *) NULL)
+              greenmap=(int *) RelinquishMagickMemory(greenmap);
+greenmap=(int *) AcquireQuantumMemory((size_t) colors,
               sizeof(*greenmap));
             if (greenmap == (int *) NULL)
               ThrowDCMException(ResourceLimitError,"MemoryAllocationFailed");
@@ -3636,7 +3640,9 @@ static Image *ReadDCMImage(const ImageInfo *image_info,ExceptionInfo *exception)
               break;
             colors=(size_t) (length/2);
             datum=(int) colors;
-            bluemap=(int *) AcquireQuantumMemory((size_t) colors,
+                        if (bluemap != (int *) NULL)
+              bluemap=(int *) RelinquishMagickMemory(bluemap);
+bluemap=(int *) AcquireQuantumMemory((size_t) colors,
               sizeof(*bluemap));
             if (bluemap == (int *) NULL)
               ThrowDCMException(ResourceLimitError,"MemoryAllocationFailed");