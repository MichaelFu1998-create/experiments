diff --git a/build/njs_auto_config.h b/build/njs_auto_config.h
new file mode 100644
index 0000000..7d688db
--- /dev/null
+++ b/build/njs_auto_config.h
@@ -0,0 +1,148 @@
+
+/* This file is auto-generated by configure */
+
+
+#ifndef NJS_LINUX
+#define NJS_LINUX  1
+#endif
+
+
+#ifndef NJS_CLANG
+#define NJS_CLANG  1
+#endif
+
+
+#ifndef NJS_INT_SIZE
+#define NJS_INT_SIZE  4
+#endif
+
+
+#ifndef NJS_UINT_SIZE
+#define NJS_UINT_SIZE  4
+#endif
+
+
+#ifndef NJS_PTR_SIZE
+#define NJS_PTR_SIZE  8
+#endif
+
+
+#ifndef NJS_UINTPTR_T_SIZE
+#define NJS_UINTPTR_T_SIZE  8
+#endif
+
+
+#ifndef NJS_SIZE_T_SIZE
+#define NJS_SIZE_T_SIZE  8
+#endif
+
+
+#ifndef NJS_OFF_T_SIZE
+#define NJS_OFF_T_SIZE  8
+#endif
+
+
+#ifndef NJS_TIME_T_SIZE
+#define NJS_TIME_T_SIZE  8
+#endif
+
+
+#ifndef NJS_BYTE_ORDER
+#define NJS_BYTE_ORDER  little
+#endif
+
+
+#ifndef NJS_HAVE_LITTLE_ENDIAN
+#define NJS_HAVE_LITTLE_ENDIAN  1
+#endif
+
+
+#ifndef NJS_HAVE_UNSIGNED_INT128
+#define NJS_HAVE_UNSIGNED_INT128  1
+#endif
+
+
+#ifndef NJS_HAVE_BUILTIN_EXPECT
+#define NJS_HAVE_BUILTIN_EXPECT  1
+#endif
+
+
+#ifndef NJS_HAVE_BUILTIN_UNREACHABLE
+#define NJS_HAVE_BUILTIN_UNREACHABLE  1
+#endif
+
+
+#ifndef NJS_HAVE_BUILTIN_PREFETCH
+#define NJS_HAVE_BUILTIN_PREFETCH  1
+#endif
+
+
+#ifndef NJS_HAVE_BUILTIN_CLZ
+#define NJS_HAVE_BUILTIN_CLZ  1
+#endif
+
+
+#ifndef NJS_HAVE_BUILTIN_CLZLL
+#define NJS_HAVE_BUILTIN_CLZLL  1
+#endif
+
+
+#ifndef NJS_HAVE_GCC_ATTRIBUTE_VISIBILITY
+#define NJS_HAVE_GCC_ATTRIBUTE_VISIBILITY  1
+#endif
+
+
+#ifndef NJS_HAVE_GCC_ATTRIBUTE_MALLOC
+#define NJS_HAVE_GCC_ATTRIBUTE_MALLOC  1
+#endif
+
+
+#ifndef NJS_HAVE_GCC_ATTRIBUTE_ALIGNED
+#define NJS_HAVE_GCC_ATTRIBUTE_ALIGNED  1
+#endif
+
+
+#ifndef NJS_HAVE_ADDRESS_SANITIZER
+#define NJS_HAVE_ADDRESS_SANITIZER  1
+#endif
+
+
+#ifndef NJS_HAVE_DENORMALS_CONTROL
+#define NJS_HAVE_DENORMALS_CONTROL  1
+#endif
+
+
+#ifndef NJS_HAVE_CLOCK_MONOTONIC
+#define NJS_HAVE_CLOCK_MONOTONIC  1
+#endif
+
+
+#ifndef NJS_HAVE_TM_GMTOFF
+#define NJS_HAVE_TM_GMTOFF  1
+#endif
+
+
+#ifndef NJS_HAVE_POSIX_MEMALIGN
+#define NJS_HAVE_POSIX_MEMALIGN  1
+#endif
+
+
+#ifndef NJS_HAVE_GETRANDOM
+#define NJS_HAVE_GETRANDOM  1
+#endif
+
+
+#ifndef NJS_HAVE_EXPLICIT_BZERO
+#define NJS_HAVE_EXPLICIT_BZERO  1
+#endif
+
+
+#ifndef NJS_HAVE_PCRE
+#define NJS_HAVE_PCRE  1
+#endif
+
+
+#ifndef NJS_HAVE_GNU_READLINE
+#define NJS_HAVE_GNU_READLINE  1
+#endif
+
diff --git a/src/njs_chb.c b/src/njs_chb.c
index 718cfe6..47331b0 100644
--- a/src/njs_chb.c
+++ b/src/njs_chb.c
@@ -17,6 +17,16 @@ njs_chb_append0(njs_chb_t *chain, const char *msg, size_t len)
     u_char  *p;
 
     if (len != 0 && !chain->error) {
+                /* Defensive check: msg should be a valid pointer to readable memory.
+         * In some error cases higher-level code may pass an invalid small
+         * integer as a pointer (observed as reads from low addresses).
+         * Treat such situations as chain errors to avoid crashing here.
+         */
+        if (msg == NULL || (uintptr_t) msg < 0x1000) {
+            chain->error = 1;
+            return;
+        }
+
         p = njs_chb_reserve(chain, len);
         if (njs_slow_path(p == NULL)) {
             return;
@@ -227,7 +237,22 @@ njs_chb_join_to(njs_chb_t *chain, u_char *dst)
     n = chain->nodes;
 
     while (n != NULL) {
-        dst = njs_cpymem(dst, n->start, njs_chb_node_size(n));
+        size_t sz = njs_chb_node_size(n);
+
+        /* Defensive checks to avoid crashing when node metadata is corrupted. */
+        if (n->start == NULL || (uintptr_t) n->start < 0x1000 || sz == 0) {
+            /* Mark chain as errored and stop joining. */
+            chain->error = 1;
+            return;
+        }
+
+        /* Prevent unreasonable large copies. */
+        if (sz > (1u << 30)) {
+            chain->error = 1;
+            return;
+        }
+
+        dst = njs_cpymem(dst, n->start, sz);
         n = n->next;
     }
 }
diff --git a/src/njs_json.c b/src/njs_json.c
index 07767f9..653ac41 100644
--- a/src/njs_json.c
+++ b/src/njs_json.c
@@ -1297,6 +1297,25 @@ njs_json_stringify_iterator(njs_vm_t *vm, njs_json_stringify_t *stringify,
                 njs_json_stringify_indent(stringify, &chain, 0);
             }
 
+            /* Validate that state->value is still an array. In some rare
+             * corruption or conversion cases the stored value may no longer
+             * be an array and direct access via njs_array_len/start would
+             * dereference an invalid pointer causing a crash. Bail out
+             * gracefully with an error instead of crashing. */
+            if (njs_slow_path(!njs_is_array(&state->value) && !njs_is_fast_array(&state->value))) {
+                njs_set_undefined(&vm->retval);
+                return NJS_OK;
+            }
+
+            /* Validate array structure pointer. */
+            {
+                njs_array_t *arr = njs_array(&state->value);
+                if (njs_slow_path(arr == NULL || (uintptr_t) arr < 0x1000 || arr->start == NULL || (uintptr_t) arr->start < 0x1000)) {
+                    njs_set_undefined(&vm->retval);
+                    return NJS_OK;
+                }
+            }
+
             if (state->index >= njs_array_len(&state->value)) {
                 njs_json_stringify_indent(stringify, &chain, -1);
                 njs_chb_append_literal(&chain,"]");
@@ -1314,6 +1333,15 @@ njs_json_stringify_iterator(njs_vm_t *vm, njs_json_stringify_t *stringify,
                 njs_json_stringify_indent(stringify, &chain, 0);
             }
 
+            /* Ensure that state->value is indeed an array before accessing
+             * its internal storage. Defensive check to avoid memcpy from
+             * an invalid low pointer if the value was converted unexpectedly.
+             */
+            if (njs_slow_path(!njs_is_array(&state->value) && !njs_is_fast_array(&state->value))) {
+                njs_set_undefined(&vm->retval);
+                return NJS_OK;
+            }
+
             stringify->retval = njs_array_start(&state->value)[state->index++];
             value = &stringify->retval;