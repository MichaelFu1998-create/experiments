diff --git a/src/mat5.c b/src/mat5.c
index 2841b58..9d9b538 100644
--- a/src/mat5.c
+++ b/src/mat5.c
@@ -1824,14 +1824,52 @@ ReadNextFunctionHandle(mat_t *mat, matvar_t *matvar)
     int j;
     size_t bytesread = 0, nfunctions = 1;
 
-    for ( j = 0; j < matvar->rank; j++ )
-        nfunctions *= matvar->dims[j];
+    /* Validate dims and compute number of functions with overflow checks */
+    if ( matvar == NULL || (matvar->rank > 0 && matvar->dims == NULL) ) {
+        return 0;
+    }
+
+    for ( j = 0; j < matvar->rank; j++ ) {
+        size_t d = (size_t)matvar->dims[j];
+        if ( d == 0 ) {
+            /* zero sized dimension -> zero functions */
+            nfunctions = 0;
+            break;
+        }
+        if ( nfunctions > SIZE_MAX / d ) {
+            Mat_Critical("Dimension size overflow computing number of function handles");
+            matvar->data = NULL;
+            matvar->data_size = 0;
+            matvar->nbytes = 0;
+            return 0;
+        }
+        nfunctions *= d;
+    }
+
+    /* Compute total allocation size and check for overflow */
+    if ( nfunctions == 0 ) {
+        matvar->data = NULL;
+        matvar->data_size = 0;
+        matvar->nbytes = 0;
+        return bytesread;
+    }
 
-    matvar->data = malloc(nfunctions*sizeof(matvar_t *));
+    size_t ptr_size = sizeof(matvar_t *);
+    if ( nfunctions > SIZE_MAX / ptr_size ) {
+        Mat_Critical("Allocation size too large for function handles");
+        matvar->data = NULL;
+        matvar->data_size = 0;
+        matvar->nbytes = 0;
+        return 0;
+    }
+
+    size_t alloc_size = nfunctions * ptr_size;
+
+    matvar->data = malloc(alloc_size);
     if ( matvar->data != NULL ) {
         size_t i;
-        matvar_t **functions = (matvar_t**)matvar->data;;
-        matvar->data_size = sizeof(matvar_t *);
+        matvar_t **functions = (matvar_t**)matvar->data;
+        matvar->data_size = (int)ptr_size;
         matvar->nbytes    = nfunctions*matvar->data_size;
         for ( i = 0; i < nfunctions; i++ )
             functions[i] = Mat_VarReadNextInfo(mat);