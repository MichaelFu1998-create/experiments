diff --git a/MagickCore/annotate.c b/MagickCore/annotate.c
index a1145780a..fe945847b 100644
--- a/MagickCore/annotate.c
+++ b/MagickCore/annotate.c
@@ -269,12 +269,20 @@ MagickExport MagickBooleanType AnnotateImage(Image *image,
   annotate->text=(char *) NULL;
   annotate_info=CloneDrawInfo((ImageInfo *) NULL,draw_info);
   number_lines=1;
+  /* cleanup label for early returns */
+  {
+    int _annotate_cleanup_flag = 0;
+  }
   for (p=text; *p != '\0'; p++)
     if (*p == '\n')
       number_lines++;
   textlist=AcquireQuantumMemory(number_lines+1,sizeof(*textlist));
   if (textlist == (char **) NULL)
-    return(MagickFalse);
+    {
+      annotate_info=DestroyDrawInfo(annotate_info);
+      annotate=DestroyDrawInfo(annotate);
+      return(MagickFalse);
+    }
   p=text;
   for (i=0; i < number_lines; i++)
   {
@@ -303,7 +311,12 @@ MagickExport MagickBooleanType AnnotateImage(Image *image,
       (void) ParseGeometry(annotate_info->geometry,&geometry_info);
     }
   if (SetImageStorageClass(image,DirectClass,exception) == MagickFalse)
-    return(MagickFalse);
+    {
+      textlist=(char **) RelinquishMagickMemory(textlist);
+      annotate_info=DestroyDrawInfo(annotate_info);
+      annotate=DestroyDrawInfo(annotate);
+      return(MagickFalse);
+    }
   if (IsGrayColorspace(image->colorspace) != MagickFalse)
     (void) SetImageColorspace(image,sRGBColorspace,exception);
   status=MagickTrue;
@@ -520,6 +533,8 @@ MagickExport MagickBooleanType AnnotateImage(Image *image,
   annotate_info=DestroyDrawInfo(annotate_info);
   annotate=DestroyDrawInfo(annotate);
   textlist=(char **) RelinquishMagickMemory(textlist);
+  if (text != (char *) NULL)
+    text=DestroyString(text);
   return(status);
 }
 
diff --git a/MagickCore/resize.c b/MagickCore/resize.c
index 2c1d4bf99..ab661129b 100644
--- a/MagickCore/resize.c
+++ b/MagickCore/resize.c
@@ -2543,8 +2543,22 @@ static MagickBooleanType HorizontalFilter(
       (contribution[n-1].pixel-contribution[0].pixel+1),image->rows,exception);
     q=QueueCacheViewAuthenticPixels(resize_view,x,0,1,resize_image->rows,
       exception);
-    if ((p == (const Quantum *) NULL) || (q == (Quantum *) NULL))
+    /* Copy pixels to local buffer to avoid use-after-free if cache is freed by another thread */
+    Quantum *local_pixels = (Quantum *) NULL;
+    const Quantum *use_p = p;
+    if (p != (const Quantum *) NULL) {
+      size_t pixel_count = (size_t) (contribution[n-1].pixel-contribution[0].pixel+1) * (size_t) image->rows;
+      size_t channels = GetPixelChannels(image);
+      size_t bytes = pixel_count * channels * sizeof(*local_pixels);
+      local_pixels = (Quantum *) AcquireMagickMemory(bytes);
+      if (local_pixels != (Quantum *) NULL)
+        (void) memcpy(local_pixels,p,bytes);
+      use_p = (const Quantum *) (local_pixels != (Quantum *) NULL ? local_pixels : p);
+    }
+    if ((use_p == (const Quantum *) NULL) || (q == (Quantum *) NULL))
       {
+        if (local_pixels != (Quantum *) NULL)
+          local_pixels = (Quantum *) RelinquishMagickMemory(local_pixels);
         status=MagickFalse;
         continue;
       }
@@ -2586,7 +2600,7 @@ static MagickBooleanType HorizontalFilter(
               stop-1.0)+0.5);
             k=y*(contribution[n-1].pixel-contribution[0].pixel+1)+
               (contribution[j-start].pixel-contribution[0].pixel);
-            SetPixelChannel(resize_image,channel,p[k*GetPixelChannels(image)+i],
+            SetPixelChannel(resize_image,channel,use_p[k*GetPixelChannels(image)+i],
               q);
             continue;
           }
@@ -2601,7 +2615,7 @@ static MagickBooleanType HorizontalFilter(
               k=y*(contribution[n-1].pixel-contribution[0].pixel+1)+
                 (contribution[j].pixel-contribution[0].pixel);
               alpha=contribution[j].weight;
-              pixel+=alpha*p[k*GetPixelChannels(image)+i];
+              pixel+=alpha*use_p[k*GetPixelChannels(image)+i];
             }
             SetPixelChannel(resize_image,channel,ClampToQuantum(pixel),q);
             continue;
@@ -2616,7 +2630,7 @@ static MagickBooleanType HorizontalFilter(
             (contribution[j].pixel-contribution[0].pixel);
           alpha=contribution[j].weight*QuantumScale*
             GetPixelAlpha(image,p+k*GetPixelChannels(image));
-          pixel+=alpha*p[k*GetPixelChannels(image)+i];
+          pixel+=alpha*use_p[k*GetPixelChannels(image)+i];
           gamma+=alpha;
         }
         gamma=PerceptibleReciprocal(gamma);
@@ -2626,6 +2640,8 @@ static MagickBooleanType HorizontalFilter(
     }
     if (SyncCacheViewAuthenticPixels(resize_view,exception) == MagickFalse)
       status=MagickFalse;
+    if (local_pixels != (Quantum *) NULL)
+      local_pixels = (Quantum *) RelinquishMagickMemory(local_pixels);
     if (image->progress_monitor != (MagickProgressMonitor) NULL)
       {
         MagickBooleanType
@@ -2762,8 +2778,22 @@ static MagickBooleanType VerticalFilter(
       exception);
     q=QueueCacheViewAuthenticPixels(resize_view,0,y,resize_image->columns,1,
       exception);
-    if ((p == (const Quantum *) NULL) || (q == (Quantum *) NULL))
+    /* Copy pixels to local buffer to avoid use-after-free if cache is freed by another thread */
+    Quantum *local_pixels = (Quantum *) NULL;
+    const Quantum *use_p = p;
+    if (p != (const Quantum *) NULL) {
+      size_t pixel_count = (size_t) image->columns * (size_t) (contribution[n-1].pixel-contribution[0].pixel+1);
+      size_t channels = GetPixelChannels(image);
+      size_t bytes = pixel_count * channels * sizeof(*local_pixels);
+      local_pixels = (Quantum *) AcquireMagickMemory(bytes);
+      if (local_pixels != (Quantum *) NULL)
+        (void) memcpy(local_pixels,p,bytes);
+      use_p = (const Quantum *) (local_pixels != (Quantum *) NULL ? local_pixels : p);
+    }
+    if ((use_p == (const Quantum *) NULL) || (q == (Quantum *) NULL))
       {
+        if (local_pixels != (Quantum *) NULL)
+          local_pixels = (Quantum *) RelinquishMagickMemory(local_pixels);
         status=MagickFalse;
         continue;
       }
@@ -2805,7 +2835,7 @@ static MagickBooleanType VerticalFilter(
               stop-1.0)+0.5);
             k=(ssize_t) ((contribution[j-start].pixel-contribution[0].pixel)*
               image->columns+x);
-            SetPixelChannel(resize_image,channel,p[k*GetPixelChannels(image)+i],
+            SetPixelChannel(resize_image,channel,use_p[k*GetPixelChannels(image)+i],
               q);
             continue;
           }
@@ -2820,7 +2850,7 @@ static MagickBooleanType VerticalFilter(
               k=(ssize_t) ((contribution[j].pixel-contribution[0].pixel)*
                 image->columns+x);
               alpha=contribution[j].weight;
-              pixel+=alpha*p[k*GetPixelChannels(image)+i];
+              pixel+=alpha*use_p[k*GetPixelChannels(image)+i];
             }
             SetPixelChannel(resize_image,channel,ClampToQuantum(pixel),q);
             continue;
@@ -2832,7 +2862,7 @@ static MagickBooleanType VerticalFilter(
             image->columns+x);
           alpha=contribution[j].weight*QuantumScale*GetPixelAlpha(image,p+k*
             GetPixelChannels(image));
-          pixel+=alpha*p[k*GetPixelChannels(image)+i];
+          pixel+=alpha*use_p[k*GetPixelChannels(image)+i];
           gamma+=alpha;
         }
         gamma=PerceptibleReciprocal(gamma);
@@ -2842,6 +2872,8 @@ static MagickBooleanType VerticalFilter(
     }
     if (SyncCacheViewAuthenticPixels(resize_view,exception) == MagickFalse)
       status=MagickFalse;
+    if (local_pixels != (Quantum *) NULL)
+      local_pixels = (Quantum *) RelinquishMagickMemory(local_pixels);
     if (image->progress_monitor != (MagickProgressMonitor) NULL)
       {
         MagickBooleanType