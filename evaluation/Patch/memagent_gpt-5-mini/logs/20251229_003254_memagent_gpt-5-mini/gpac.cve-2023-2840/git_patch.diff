diff --git a/src/isomedia/movie_fragments.c b/src/isomedia/movie_fragments.c
index b742078d1..ac47bdbf0 100644
--- a/src/isomedia/movie_fragments.c
+++ b/src/isomedia/movie_fragments.c
@@ -2874,12 +2874,18 @@ GF_Err gf_isom_fragment_add_sample_ex(GF_ISOFile *movie, GF_ISOTrackID TrackID,
 	}
 
 	//rewrite OD frames
-	if (traf->trex->track->Media->handler->handlerType == GF_ISOM_MEDIA_OD) {
-		//this may fail if dependencies are not well done ...
-		Media_ParseODFrame(traf->trex->track->Media, sample, &od_sample);
-		sample = od_sample;
-	}
-
+		if (traf->trex->track->Media->handler->handlerType == GF_ISOM_MEDIA_OD) {
+			//this may fail if dependencies are not well done ...
+			Media_ParseODFrame(traf->trex->track->Media, sample, &od_sample);
+			/* Only use the parsed OD sample if parsing returned a valid sample
+			   to avoid dereferencing a NULL sample pointer (see ASan crash). */
+			if (od_sample) {
+				sample = od_sample;
+			} else {
+				/* OD parsing failed; keep using original sample and continue */
+				GF_LOG(GF_LOG_WARNING, GF_LOG_CONTAINER, ("[iso fragment] OD parsing failed, keeping original sample"));
+			}
+		}
 	ent.size = sample->dataLength;
 	trun->samples[trun->nb_samples] = ent;
 	trun->nb_samples ++;