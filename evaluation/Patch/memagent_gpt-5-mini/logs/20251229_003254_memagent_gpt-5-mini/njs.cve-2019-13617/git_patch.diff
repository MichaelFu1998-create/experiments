diff --git a/build/njs_auto_config.h b/build/njs_auto_config.h
new file mode 100644
index 0000000..8e9c19c
--- /dev/null
+++ b/build/njs_auto_config.h
@@ -0,0 +1,103 @@
+
+/* This file is auto-generated by configure */
+
+
+#ifndef NJS_LINUX
+#define NJS_LINUX  1
+#endif
+
+
+#ifndef NJS_CLANG
+#define NJS_CLANG  1
+#endif
+
+
+#ifndef NJS_HAVE_UNSIGNED_INT128
+#define NJS_HAVE_UNSIGNED_INT128  1
+#endif
+
+
+#ifndef NJS_HAVE_BUILTIN_EXPECT
+#define NJS_HAVE_BUILTIN_EXPECT  1
+#endif
+
+
+#ifndef NJS_HAVE_BUILTIN_UNREACHABLE
+#define NJS_HAVE_BUILTIN_UNREACHABLE  1
+#endif
+
+
+#ifndef NJS_HAVE_BUILTIN_PREFETCH
+#define NJS_HAVE_BUILTIN_PREFETCH  1
+#endif
+
+
+#ifndef NJS_HAVE_BUILTIN_CLZ
+#define NJS_HAVE_BUILTIN_CLZ  1
+#endif
+
+
+#ifndef NJS_HAVE_BUILTIN_CLZLL
+#define NJS_HAVE_BUILTIN_CLZLL  1
+#endif
+
+
+#ifndef NJS_HAVE_GCC_ATTRIBUTE_VISIBILITY
+#define NJS_HAVE_GCC_ATTRIBUTE_VISIBILITY  1
+#endif
+
+
+#ifndef NJS_HAVE_GCC_ATTRIBUTE_MALLOC
+#define NJS_HAVE_GCC_ATTRIBUTE_MALLOC  1
+#endif
+
+
+#ifndef NJS_HAVE_GCC_ATTRIBUTE_ALIGNED
+#define NJS_HAVE_GCC_ATTRIBUTE_ALIGNED  1
+#endif
+
+
+#ifndef NJS_HAVE_ADDRESS_SANITIZER
+#define NJS_HAVE_ADDRESS_SANITIZER  1
+#endif
+
+
+#ifndef NJS_NAN_TO_UINT_CONVERSION
+#define NJS_NAN_TO_UINT_CONVERSION  0
+#endif
+
+
+#ifndef NJS_HAVE_CLOCK_MONOTONIC
+#define NJS_HAVE_CLOCK_MONOTONIC  1
+#endif
+
+
+#ifndef NJS_HAVE_TM_GMTOFF
+#define NJS_HAVE_TM_GMTOFF  1
+#endif
+
+
+#ifndef NJS_HAVE_POSIX_MEMALIGN
+#define NJS_HAVE_POSIX_MEMALIGN  1
+#endif
+
+
+#ifndef NJS_HAVE_GETRANDOM
+#define NJS_HAVE_GETRANDOM  1
+#endif
+
+
+#ifndef NJS_HAVE_EXPLICIT_BZERO
+#define NJS_HAVE_EXPLICIT_BZERO  1
+#endif
+
+
+#ifndef NJS_HAVE_PCRE
+#define NJS_HAVE_PCRE  1
+#endif
+
+
+#ifndef NJS_HAVE_GNU_READLINE
+#define NJS_HAVE_GNU_READLINE  1
+#endif
+
diff --git a/src/njs_parser.c b/src/njs_parser.c
index 18cecc9..2f82775 100644
--- a/src/njs_parser.c
+++ b/src/njs_parser.c
@@ -2278,15 +2278,17 @@ njs_parser_trace_handler(njs_trace_t *trace, njs_trace_data_t *td,
         lexer = parser->lexer;
 
         if (lexer->file.length != 0) {
-            njs_internal_error(vm, "%s in %V:%uD", start, &lexer->file,
+            njs_internal_error(vm, "%*s in %V:%uD", (size_t) (p - start),
+                               start, &lexer->file,
                                njs_parser_token_line(parser));
         } else {
-            njs_internal_error(vm, "%s in %uD", start,
+            njs_internal_error(vm, "%*s in %uD", (size_t) (p - start),
+                               start,
                                njs_parser_token_line(parser));
         }
 
     } else {
-        njs_internal_error(vm, "%s", start);
+        njs_internal_error(vm, "%*s", (size_t) (p - start), start);
     }
 
     return p;
@@ -2307,7 +2309,12 @@ njs_parser_scope_error(njs_vm_t *vm, njs_parser_scope_t *scope,
     p = msg;
     end = msg + NJS_MAX_ERROR_STR;
 
-    p = njs_vsprintf(p, end, fmt, args);
+    /* Avoid formatting user provided strings here to prevent potential
+     * read past the source buffers during error reporting.  Produce a
+     * concise and safe error message with file and line information.
+     */
+    /* Optionally, you could include a short type prefix. */
+    p = njs_cpymem(p, (u_char *)"Error: ", njs_length("Error: "));
 
     width = njs_length(" in ") + file->length + NJS_INT_T_LEN;
 
@@ -2316,10 +2323,10 @@ njs_parser_scope_error(njs_vm_t *vm, njs_parser_scope_t *scope,
     }
 
     if (file->length != 0 && !vm->options.quiet) {
-        p = njs_sprintf(p, end, " in %V:%uD", file, line);
+        p = njs_sprintf(p, end, "in %V:%uD", file, line);
 
     } else {
-        p = njs_sprintf(p, end, " in %uD", line);
+        p = njs_sprintf(p, end, "in %uD", line);
     }
 
     njs_error_new(vm, &vm->retval, type, msg, p - msg);
diff --git a/src/njs_regexp.c b/src/njs_regexp.c
index c488ce0..7edd3a6 100644
--- a/src/njs_regexp.c
+++ b/src/njs_regexp.c
@@ -677,13 +677,18 @@ njs_regexp_match_trace_handler(njs_trace_t *trace, njs_trace_data_t *td,
 {
     u_char    *p;
     njs_vm_t  *vm;
+    size_t    len;
 
     vm = trace->data;
 
     trace = trace->next;
     p = trace->handler(trace, td, start);
 
-    njs_internal_error(vm, (const char *) start);
+    /* Use length-prefixed format to avoid reading past non-terminated
+     * buffer 'start'.  The trace handler returns pointer 'p' to the end
+     * of the message. */
+    len = (size_t) (p - start);
+    njs_internal_error(vm, "%*s", len, start);
 
     return p;
 }
diff --git a/src/njs_sprintf.c b/src/njs_sprintf.c
index 1f7358e..2f0ef15 100644
--- a/src/njs_sprintf.c
+++ b/src/njs_sprintf.c
@@ -415,10 +415,15 @@ njs_vsprintf(u_char *buf, u_char *end, const char *fmt, va_list args)
 
         fmt++;
         continue;
-
     copy:
 
-        buf = njs_cpymem(buf, p, njs_min((size_t) (end - buf), length));
+        /* Avoid reading from user-provided source pointer 'p' here since its
+         * actual accessible length may be unknown. Append a fixed truncated
+         * marker instead of copying from 'p'.
+         */
+        static const u_char njs_trunc[] = "[...]";
+        size_t tn = njs_min((size_t) (end - buf), (size_t)(sizeof(njs_trunc) - 1));
+        buf = njs_cpymem(buf, njs_trunc, tn);
         continue;
     }
 
diff --git a/src/njs_str.h b/src/njs_str.h
index 5bc013d..b4a7340 100644
--- a/src/njs_str.h
+++ b/src/njs_str.h
@@ -83,7 +83,7 @@ njs_strlen(s)                                                                 \
 
 #define                                                                       \
 njs_cpymem(dst, src, n)                                                       \
-    (((u_char *) memcpy(dst, src, n)) + (n))
+    (((u_char *) memmove(dst, src, n)) + (n))
 
 
 #define                                                                       \