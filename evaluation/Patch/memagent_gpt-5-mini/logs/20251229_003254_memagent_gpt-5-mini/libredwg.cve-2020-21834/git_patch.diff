diff --git a/src/dwg.c b/src/dwg.c
index 72c38705..dbe3edfc 100644
--- a/src/dwg.c
+++ b/src/dwg.c
@@ -491,14 +491,31 @@ dwg_bmp (const Dwg_Data *restrict dwg, BITCODE_RL *restrict size)
           LOG_TRACE ("\t\tSize of unknown code %i: %i [RL]\n", code, osize)
         }
     }
-  dat->byte += header_size;
+    dat->byte += header_size;
   if (*size)
     LOG_TRACE ("BMP offset: %lu\n", dat->byte)
 
-  if (*size > 0)
+  if (*size > 0) {
+    /* Validate that the computed offset and size are within the thumbnail buffer. */
+    if (dat->byte > dat->size) {
+      LOG_ERROR ("BMP offset out of range: %lu > %lu\n", dat->byte, dat->size);
+      *size = 0;
+      return NULL;
+    }
+    if ((BITCODE_RL)dat->size < (BITCODE_RL)dat->byte) {
+      LOG_ERROR ("BMP offset overflow\n");
+      *size = 0;
+      return NULL;
+    }
+    if (*size > dat->size - dat->byte) {
+      LOG_ERROR ("BMP size overflow: %u > %lu\n", (unsigned)*size, dat->size - dat->byte);
+      *size = 0;
+      return NULL;
+    }
     return (dat->chain + dat->byte);
-  else
+  } else
     return NULL;
+
 }
 
 EXPORT double