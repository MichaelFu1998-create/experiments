diff --git a/src/variable.c b/src/variable.c
index 53b760d0f..bd4810edc 100644
--- a/src/variable.c
+++ b/src/variable.c
@@ -11,6 +11,7 @@
 #include <mruby/string.h>
 #include <mruby/variable.h>
 #include <mruby/presym.h>
+#include <stdint.h>
 
 /* Instance variable table structure */
 typedef struct iv_tbl {
@@ -229,6 +230,10 @@ iv_copy(mrb_state *mrb, iv_tbl *t)
 static void
 iv_free(mrb_state *mrb, iv_tbl *t)
 {
+  /* defensive: avoid dereferencing obviously invalid small pointers */
+  if (t == NULL) return;
+  uintptr_t tv = (uintptr_t)t;
+  if (tv < 0x1000) return;
   mrb_free(mrb, t->ptr);
   mrb_free(mrb, t);
 }
@@ -255,8 +260,11 @@ mrb_gc_mark_gv(mrb_state *mrb)
 void
 mrb_gc_free_gv(mrb_state *mrb)
 {
-  if (mrb->globals)
+  if (mrb->globals) {
     iv_free(mrb, mrb->globals);
+    /* avoid dangling pointer after free */
+    mrb->globals = NULL;
+  }
 }
 
 void
@@ -276,6 +284,8 @@ mrb_gc_free_iv(mrb_state *mrb, struct RObject *obj)
 {
   if (obj->iv) {
     iv_free(mrb, obj->iv);
+    /* avoid dangling pointer after free */
+    obj->iv = NULL;
   }
 }