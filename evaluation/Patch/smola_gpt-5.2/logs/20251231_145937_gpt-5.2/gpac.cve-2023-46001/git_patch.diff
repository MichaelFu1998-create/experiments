diff --git a/src/isomedia/isom_read.c b/src/isomedia/isom_read.c
index 5a8109e..7b70b70 100644
--- a/src/isomedia/isom_read.c
+++ b/src/isomedia/isom_read.c
@@ -2747,12 +2747,16 @@ u32 gf_isom_get_user_data_count(GF_ISOFile *movie, u32 trackNumber, u32 UserData
 	GF_TrackBox *trak;
 	GF_UserDataBox *udta;
 	bin128 t;
+	const u8 *uuid_p = (const u8 *) UUID;
 	u32 i, count;
 
 	if (!movie || !movie->moov) return 0;
 
 	if (UserDataType == GF_ISOM_BOX_TYPE_UUID) UserDataType = 0;
 	memset(t, 1, 16);
+	/* UUID is declared as bin128 but passed as pointer; some callers may pass NULL.
+	   Use a non-matching sentinel to avoid NULL deref in memcmp. */
+	if (!uuid_p) uuid_p = t;
 
 	if (trackNumber) {
 		trak = gf_isom_get_track_from_file(movie, trackNumber);
@@ -2768,7 +2772,7 @@ u32 gf_isom_get_user_data_count(GF_ISOFile *movie, u32 trackNumber, u32 UserData
 	while ((map = (GF_UserDataMap*)gf_list_enum(udta->recordList, &i))) {
 		count = gf_list_count(map->boxes);
 
-		if ((map->boxType == GF_ISOM_BOX_TYPE_UUID) && !memcmp(map->uuid, UUID, 16)) return count;
+		if ((map->boxType == GF_ISOM_BOX_TYPE_UUID) && !memcmp(map->uuid, uuid_p, 16)) return count;
 		else if (map->boxType == UserDataType) return count;
 	}
 	return 0;
@@ -2782,6 +2786,7 @@ GF_Err gf_isom_get_user_data(GF_ISOFile *movie, u32 trackNumber, u32 UserDataTyp
 	GF_BitStream *bs;
 	u32 i;
 	bin128 t;
+	const u8 *uuid_p = (const u8 *) UUID;
 	GF_TrackBox *trak;
 	GF_UserDataBox *udta;
 
@@ -2799,12 +2804,15 @@ GF_Err gf_isom_get_user_data(GF_ISOFile *movie, u32 trackNumber, u32 UserDataTyp
 
 	if (UserDataType == GF_ISOM_BOX_TYPE_UUID) UserDataType = 0;
 	memset(t, 1, 16);
+	/* UUID is declared as bin128 but passed as pointer; some callers may pass NULL.
+	   Use a non-matching sentinel to avoid NULL deref in memcmp. */
+	if (!uuid_p) uuid_p = t;
 
 	if (!userData || !userDataSize || *userData) return GF_BAD_PARAM;
 
 	i=0;
 	while ((map = (GF_UserDataMap*)gf_list_enum(udta->recordList, &i))) {
-		if ((map->boxType == GF_ISOM_BOX_TYPE_UUID) && !memcmp(map->uuid, UUID, 16)) goto found;
+		if ((map->boxType == GF_ISOM_BOX_TYPE_UUID) && !memcmp(map->uuid, uuid_p, 16)) goto found;
 		else if (map->boxType == UserDataType) goto found;
 
 	}
@@ -2814,6 +2822,7 @@ found:
 	if (UserDataIndex) {
 		if (UserDataIndex > gf_list_count(map->boxes) ) return GF_BAD_PARAM;
 		ptr = (GF_UnknownBox*)gf_list_get(map->boxes, UserDataIndex-1);
+		if (!ptr) return GF_ISOM_INVALID_FILE;
 
 		if (ptr->type == GF_ISOM_BOX_TYPE_UNKNOWN) {
 			if (!ptr->dataSize) {