diff --git a/coders/png.c b/coders/png.c
index dc8be52..f59fc7b 100644
--- a/coders/png.c
+++ b/coders/png.c
@@ -3272,7 +3272,7 @@ static Image *ReadOnePNGImage(MngInfo *mng_info,
 
   status=SetImageExtent(image,image->columns,image->rows,exception);
   if (status == MagickFalse)
-    return(DestroyImageList(image));
+    png_error(ping,"Memory allocation failed");
 
   if (num_passes > 1)
     pixel_info=AcquireVirtualMemory(image->rows,ping_rowbytes*
@@ -4251,6 +4251,41 @@ static Image *ReadPNGImage(const ImageInfo *image_info,
 %    o exception: return any errors or warnings in this structure.
 %
 */
+
+static void DestroyJNGTemporaryResources(Image **color_image,
+  ImageInfo **color_image_info, MagickBooleanType *color_filename_acquired,
+  Image **alpha_image, ImageInfo **alpha_image_info,
+  MagickBooleanType *alpha_filename_acquired)
+{
+  if (alpha_image != (Image **) NULL && *alpha_image != (Image *) NULL)
+    {
+      (void) CloseBlob(*alpha_image);
+      if (alpha_filename_acquired != (MagickBooleanType *) NULL &&
+          *alpha_filename_acquired != MagickFalse)
+        (void) RelinquishUniqueFileResource((*alpha_image)->filename);
+      *alpha_image=DestroyImage(*alpha_image);
+    }
+  if (alpha_image_info != (ImageInfo **) NULL &&
+      *alpha_image_info != (ImageInfo *) NULL)
+    *alpha_image_info=DestroyImageInfo(*alpha_image_info);
+  if (alpha_filename_acquired != (MagickBooleanType *) NULL)
+    *alpha_filename_acquired=MagickFalse;
+
+  if (color_image != (Image **) NULL && *color_image != (Image *) NULL)
+    {
+      (void) CloseBlob(*color_image);
+      if (color_filename_acquired != (MagickBooleanType *) NULL &&
+          *color_filename_acquired != MagickFalse)
+        (void) RelinquishUniqueFileResource((*color_image)->filename);
+      *color_image=DestroyImage(*color_image);
+    }
+  if (color_image_info != (ImageInfo **) NULL &&
+      *color_image_info != (ImageInfo *) NULL)
+    *color_image_info=DestroyImageInfo(*color_image_info);
+  if (color_filename_acquired != (MagickBooleanType *) NULL)
+    *color_filename_acquired=MagickFalse;
+}
+
 static Image *ReadOneJNGImage(MngInfo *mng_info,
     const ImageInfo *image_info, ExceptionInfo *exception)
 {
@@ -4307,6 +4342,14 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
   size_t
     length;
 
+  /*
+    Track temporary file resources so we can reliably clean them up on all
+    early-exit paths (e.g. ping/identify with malformed JNG data).
+  */
+  MagickBooleanType
+    alpha_filename_acquired,
+    color_filename_acquired;
+
   jng_alpha_compression_method=0;
   jng_alpha_sample_depth=8;
   jng_color_type=0;
@@ -4316,6 +4359,18 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
   color_image=(Image *) NULL;
   alpha_image_info=(ImageInfo *) NULL;
   color_image_info=(ImageInfo *) NULL;
+  alpha_filename_acquired=MagickFalse;
+  color_filename_acquired=MagickFalse;
+
+#define ThrowJNGReaderException(severity,tag) \
+  do \
+  { \
+    DestroyJNGTemporaryResources(&color_image,&color_image_info,\
+      &color_filename_acquired,&alpha_image,&alpha_image_info,\
+      &alpha_filename_acquired); \
+    ThrowReaderException(severity,tag); \
+  } while (0)
+
 
   logging=LogMagickEvent(CoderEvent,GetMagickModule(),
     "  Enter ReadOneJNGImage()");
@@ -4377,7 +4432,7 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
         type[0],type[1],type[2],type[3],(double) length);
 
     if (length > PNG_UINT_31_MAX || count == 0)
-      ThrowReaderException(CorruptImageError,"CorruptImage");
+      ThrowJNGReaderException(CorruptImageError,"CorruptImage");
 
     p=NULL;
     chunk=(unsigned char *) NULL;
@@ -4385,12 +4440,12 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
     if (length != 0)
       {
         if (length > GetBlobSize(image))
-          ThrowReaderException(CorruptImageError,"InsufficientImageDataInFile");
+          ThrowJNGReaderException(CorruptImageError,"InsufficientImageDataInFile");
         chunk=(unsigned char *) AcquireQuantumMemory(length+MagickPathExtent,
           sizeof(*chunk));
 
         if (chunk == (unsigned char *) NULL)
-          ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
+          ThrowJNGReaderException(ResourceLimitError,"MemoryAllocationFailed");
 
         for (i=0; i < (ssize_t) length; i++)
         {
@@ -4417,7 +4472,7 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
             jng_height=(size_t) ((p[4] << 24) | (p[5] << 16) |
               (p[6] << 8) | p[7]);
             if ((jng_width == 0) || (jng_height == 0))
-              ThrowReaderException(CorruptImageError,
+              ThrowJNGReaderException(CorruptImageError,
                 "NegativeOrZeroImageSize");
             jng_color_type=p[8];
             jng_image_sample_depth=p[9];
@@ -4479,25 +4534,34 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
         color_image_info=(ImageInfo *)AcquireMagickMemory(sizeof(ImageInfo));
 
         if (color_image_info == (ImageInfo *) NULL)
-          ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
+          ThrowJNGReaderException(ResourceLimitError,"MemoryAllocationFailed");
 
         GetImageInfo(color_image_info);
         color_image=AcquireImage(color_image_info,exception);
 
         if (color_image == (Image *) NULL)
-          ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
+          ThrowJNGReaderException(ResourceLimitError,"MemoryAllocationFailed");
 
         if (logging != MagickFalse)
           (void) LogMagickEvent(CoderEvent,GetMagickModule(),
             "    Creating color_blob.");
 
-        (void) AcquireUniqueFilename(color_image->filename);
+        if (AcquireUniqueFilename(color_image->filename) == MagickFalse)
+          {
+            color_image=DestroyImage(color_image);
+            color_image_info=DestroyImageInfo(color_image_info);
+            ThrowJNGReaderException(FileOpenError,"UnableToCreateTemporaryFile");
+          }
+        color_filename_acquired=MagickTrue;
         status=OpenBlob(color_image_info,color_image,WriteBinaryBlobMode,
           exception);
 
         if (status == MagickFalse)
           {
+            if (color_filename_acquired != MagickFalse)
+              (void) RelinquishUniqueFileResource(color_image->filename);
             color_image=DestroyImage(color_image);
+            color_image_info=DestroyImageInfo(color_image_info);
             return(DestroyImageList(image));
           }
 
@@ -4508,8 +4572,12 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
 
             if (alpha_image_info == (ImageInfo *) NULL)
               {
+                (void) CloseBlob(color_image);
+                if (color_filename_acquired != MagickFalse)
+                  (void) RelinquishUniqueFileResource(color_image->filename);
                 color_image=DestroyImage(color_image);
-                ThrowReaderException(ResourceLimitError,
+                color_image_info=DestroyImageInfo(color_image_info);
+                ThrowJNGReaderException(ResourceLimitError,
                   "MemoryAllocationFailed");
               }
 
@@ -4519,8 +4587,12 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
             if (alpha_image == (Image *) NULL)
               {
                 alpha_image_info=DestroyImageInfo(alpha_image_info);
+                (void) CloseBlob(color_image);
+                if (color_filename_acquired != MagickFalse)
+                  (void) RelinquishUniqueFileResource(color_image->filename);
                 color_image=DestroyImage(color_image);
-                ThrowReaderException(ResourceLimitError,
+                color_image_info=DestroyImageInfo(color_image_info);
+                ThrowJNGReaderException(ResourceLimitError,
                   "MemoryAllocationFailed");
               }
 
@@ -4528,15 +4600,33 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
               (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                 "    Creating alpha_blob.");
 
-            (void) AcquireUniqueFilename(alpha_image->filename);
+            if (AcquireUniqueFilename(alpha_image->filename) == MagickFalse)
+              {
+                alpha_image=DestroyImage(alpha_image);
+                alpha_image_info=DestroyImageInfo(alpha_image_info);
+                (void) CloseBlob(color_image);
+                if (color_filename_acquired != MagickFalse)
+                  (void) RelinquishUniqueFileResource(color_image->filename);
+                color_image=DestroyImage(color_image);
+                color_image_info=DestroyImageInfo(color_image_info);
+                ThrowJNGReaderException(FileOpenError,
+                  "UnableToCreateTemporaryFile");
+              }
+            alpha_filename_acquired=MagickTrue;
             status=OpenBlob(alpha_image_info,alpha_image,WriteBinaryBlobMode,
               exception);
 
             if (status == MagickFalse)
               {
+                if (alpha_filename_acquired != MagickFalse)
+                  (void) RelinquishUniqueFileResource(alpha_image->filename);
                 alpha_image=DestroyImage(alpha_image);
                 alpha_image_info=DestroyImageInfo(alpha_image_info);
+                (void) CloseBlob(color_image);
+                if (color_filename_acquired != MagickFalse)
+                  (void) RelinquishUniqueFileResource(color_image->filename);
                 color_image=DestroyImage(color_image);
+                color_image_info=DestroyImageInfo(color_image_info);
                 return(DestroyImageList(image));
               }
 
@@ -4824,7 +4914,18 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
   color_image_info=DestroyImageInfo(color_image_info);
 
   if (jng_image == (Image *) NULL)
-    return(DestroyImageList(image));
+    {
+      if (alpha_image != (Image *) NULL)
+        {
+          (void) CloseBlob(alpha_image);
+          if (alpha_filename_acquired != MagickFalse)
+            (void) RelinquishUniqueFileResource(alpha_image->filename);
+          alpha_image=DestroyImage(alpha_image);
+        }
+      if (alpha_image_info != (ImageInfo *) NULL)
+        alpha_image_info=DestroyImageInfo(alpha_image_info);
+      return(DestroyImageList(image));
+    }
 
   if (logging != MagickFalse)
     (void) LogMagickEvent(CoderEvent,GetMagickModule(),
@@ -4835,7 +4936,19 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
 
   status=SetImageExtent(image,image->columns,image->rows,exception);
   if (status == MagickFalse)
-    return(DestroyImageList(image));
+    {
+      jng_image=DestroyImage(jng_image);
+      if (alpha_image != (Image *) NULL)
+        {
+          (void) CloseBlob(alpha_image);
+          if (alpha_filename_acquired != MagickFalse)
+            (void) RelinquishUniqueFileResource(alpha_image->filename);
+          alpha_image=DestroyImage(alpha_image);
+        }
+      if (alpha_image_info != (ImageInfo *) NULL)
+        alpha_image_info=DestroyImageInfo(alpha_image_info);
+      return(DestroyImageList(image));
+    }
 
   for (y=0; y < (ssize_t) image->rows; y++)
   {
@@ -4948,11 +5061,24 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
     2*GetBlobSize(image));
 
   if (status == MagickFalse)
-    return(DestroyImageList(image));
+    {
+      if (alpha_image != (Image *) NULL)
+        {
+          (void) CloseBlob(alpha_image);
+          if (alpha_filename_acquired != MagickFalse)
+            (void) RelinquishUniqueFileResource(alpha_image->filename);
+          alpha_image=DestroyImage(alpha_image);
+        }
+      if (alpha_image_info != (ImageInfo *) NULL)
+        alpha_image_info=DestroyImageInfo(alpha_image_info);
+      return(DestroyImageList(image));
+    }
 
   if (logging != MagickFalse)
     (void) LogMagickEvent(CoderEvent,GetMagickModule(),
       "  exit ReadOneJNGImage()");
+  #undef ThrowJNGReaderException
+
 
   return(image);
 }