diff --git a/src/stata/readstat_dta_parse_timestamp.c b/src/stata/readstat_dta_parse_timestamp.c
index 9593743..8fc0e45 100644
--- a/src/stata/readstat_dta_parse_timestamp.c
+++ b/src/stata/readstat_dta_parse_timestamp.c
@@ -317,7 +317,13 @@ _again:
 
     if (cs < 40|| p != pe) {
         if (ctx->error_handler) {
-            snprintf(ctx->error_buf, sizeof(ctx->error_buf), "Invalid timestamp string (length=%d): %*s", (int)len, (int)-len, data);
+            /*
+             * data is not guaranteed to be NUL-terminated (it is read from the file
+             * using a length field). Using "%s" (even with a width) can therefore
+             * over-read past the provided buffer.
+             */
+            snprintf(ctx->error_buf, sizeof(ctx->error_buf),
+                    "Invalid timestamp string (length=%d): %.*s", (int)len, (int)len, data);
             ctx->error_handler(ctx->error_buf, ctx->user_ctx);
         }
         retval = READSTAT_ERROR_BAD_TIMESTAMP;