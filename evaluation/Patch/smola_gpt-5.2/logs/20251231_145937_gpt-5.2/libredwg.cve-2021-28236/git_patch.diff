diff --git a/src/out_dxfb.c b/src/out_dxfb.c
index a4006b6..9127e94 100644
--- a/src/out_dxfb.c
+++ b/src/out_dxfb.c
@@ -1838,9 +1838,12 @@ dxfb_tables_write (Bit_Chain *restrict dat, Dwg_Data *restrict dwg)
   SINCE (R_9c1)
   {
     Dwg_Object *ctrl = dwg_get_first_object (dwg, DWG_TYPE_VPORT_CONTROL);
-    Dwg_Object_VPORT_CONTROL *_ctrl = ctrl->tio.object->tio.VPORT_CONTROL;
     if (ctrl && ctrl->fixedtype == DWG_TYPE_VPORT_CONTROL)
       {
+        Dwg_Object_VPORT_CONTROL *_ctrl = ctrl->tio.object
+                                         ? ctrl->tio.object->tio.VPORT_CONTROL
+                                         : NULL;
+
         Dwg_Object *obj = ctrl;
         TABLE (VPORT);
         // add handle 5 here at first
@@ -1854,6 +1857,7 @@ dxfb_tables_write (Bit_Chain *restrict dat, Dwg_Data *restrict dwg)
             VALUE_TV ("DbSaveVer", 1000);
             VALUE_RS (dwg->header.dwg_version, 1071); // so that 69 is R_2018
           }
+        if (_ctrl)
         for (i = 0; i < _ctrl->num_entries; i++)
           {
             obj = dwg_ref_object (dwg, _ctrl->entries[i]);
@@ -1869,9 +1873,12 @@ dxfb_tables_write (Bit_Chain *restrict dat, Dwg_Data *restrict dwg)
   }
   {
     Dwg_Object *ctrl = dwg_get_first_object (dwg, DWG_TYPE_LTYPE_CONTROL);
-    Dwg_Object_LTYPE_CONTROL *_ctrl = ctrl->tio.object->tio.LTYPE_CONTROL;
     if (ctrl && ctrl->fixedtype == DWG_TYPE_LTYPE_CONTROL)
       {
+        Dwg_Object_LTYPE_CONTROL *_ctrl = ctrl->tio.object
+                                         ? ctrl->tio.object->tio.LTYPE_CONTROL
+                                         : NULL;
+
         Dwg_Object *obj = ctrl;
         TABLE (LTYPE);
         COMMON_TABLE_CONTROL_FLAGS;
@@ -1886,6 +1893,7 @@ dxfb_tables_write (Bit_Chain *restrict dat, Dwg_Data *restrict dwg)
             error |= dwg_dxfb_LTYPE (dat, obj);
           }
         // here LTYPE_CONTINUOUS is already included
+        if (_ctrl)
         for (i = 0; i < _ctrl->num_entries; i++)
           {
             obj = dwg_ref_object (dwg, _ctrl->entries[i]);
@@ -1899,13 +1907,17 @@ dxfb_tables_write (Bit_Chain *restrict dat, Dwg_Data *restrict dwg)
   }
   {
     Dwg_Object *ctrl = dwg_get_first_object (dwg, DWG_TYPE_LAYER_CONTROL);
-    Dwg_Object_LAYER_CONTROL *_ctrl = ctrl->tio.object->tio.LAYER_CONTROL;
     if (ctrl && ctrl->fixedtype == DWG_TYPE_LAYER_CONTROL)
       {
+        Dwg_Object_LAYER_CONTROL *_ctrl = ctrl->tio.object
+                                         ? ctrl->tio.object->tio.LAYER_CONTROL
+                                         : NULL;
+
         Dwg_Object *obj = ctrl;
         TABLE (LAYER);
         COMMON_TABLE_CONTROL_FLAGS;
         error |= dwg_dxfb_LAYER_CONTROL (dat, ctrl);
+        if (_ctrl)
         for (i = 0; i < _ctrl->num_entries; i++)
           {
             obj = dwg_ref_object (dwg, _ctrl->entries[i]);
@@ -1921,13 +1933,17 @@ dxfb_tables_write (Bit_Chain *restrict dat, Dwg_Data *restrict dwg)
   }
   {
     Dwg_Object *ctrl = dwg_get_first_object (dwg, DWG_TYPE_STYLE_CONTROL);
-    Dwg_Object_STYLE_CONTROL *_ctrl = ctrl->tio.object->tio.STYLE_CONTROL;
     if (ctrl && ctrl->fixedtype == DWG_TYPE_STYLE_CONTROL)
       {
+        Dwg_Object_STYLE_CONTROL *_ctrl = ctrl->tio.object
+                                         ? ctrl->tio.object->tio.STYLE_CONTROL
+                                         : NULL;
+
         Dwg_Object *obj = ctrl;
         TABLE (STYLE);
         COMMON_TABLE_CONTROL_FLAGS;
         error |= dwg_dxfb_STYLE_CONTROL (dat, ctrl);
+        if (_ctrl)
         for (i = 0; i < _ctrl->num_entries; i++)
           {
             obj = dwg_ref_object (dwg, _ctrl->entries[i]);
@@ -1941,13 +1957,17 @@ dxfb_tables_write (Bit_Chain *restrict dat, Dwg_Data *restrict dwg)
   }
   {
     Dwg_Object *ctrl = dwg_get_first_object (dwg, DWG_TYPE_VIEW_CONTROL);
-    Dwg_Object_VIEW_CONTROL *_ctrl = ctrl->tio.object->tio.VIEW_CONTROL;
     if (ctrl && ctrl->fixedtype == DWG_TYPE_VIEW_CONTROL)
       {
+        Dwg_Object_VIEW_CONTROL *_ctrl = ctrl->tio.object
+                                         ? ctrl->tio.object->tio.VIEW_CONTROL
+                                         : NULL;
+
         Dwg_Object *obj = ctrl;
         TABLE (VIEW);
         COMMON_TABLE_CONTROL_FLAGS;
         error |= dwg_dxfb_VIEW_CONTROL (dat, ctrl);
+        if (_ctrl)
         for (i = 0; i < _ctrl->num_entries; i++)
           {
             obj = dwg_ref_object (dwg, _ctrl->entries[i]);
@@ -1960,13 +1980,17 @@ dxfb_tables_write (Bit_Chain *restrict dat, Dwg_Data *restrict dwg)
   SINCE (R_9c1)
   {
     Dwg_Object *ctrl = dwg_get_first_object (dwg, DWG_TYPE_UCS_CONTROL);
-    Dwg_Object_UCS_CONTROL *_ctrl = ctrl->tio.object->tio.UCS_CONTROL;
     if (ctrl && ctrl->fixedtype == DWG_TYPE_UCS_CONTROL)
       {
+        Dwg_Object_UCS_CONTROL *_ctrl = ctrl->tio.object
+                                         ? ctrl->tio.object->tio.UCS_CONTROL
+                                         : NULL;
+
         Dwg_Object *obj = ctrl;
         TABLE (UCS);
         COMMON_TABLE_CONTROL_FLAGS;
         error |= dwg_dxfb_UCS_CONTROL (dat, ctrl);
+        if (_ctrl)
         for (i = 0; i < _ctrl->num_entries; i++)
           {
             obj = dwg_ref_object (dwg, _ctrl->entries[i]);
@@ -1981,13 +2005,17 @@ dxfb_tables_write (Bit_Chain *restrict dat, Dwg_Data *restrict dwg)
   SINCE (R_10c1)
   {
     Dwg_Object *ctrl = dwg_get_first_object (dwg, DWG_TYPE_APPID_CONTROL);
-    Dwg_Object_APPID_CONTROL *_ctrl = ctrl->tio.object->tio.APPID_CONTROL;
     if (ctrl && ctrl->fixedtype == DWG_TYPE_APPID_CONTROL)
       {
+        Dwg_Object_APPID_CONTROL *_ctrl = ctrl->tio.object
+                                         ? ctrl->tio.object->tio.APPID_CONTROL
+                                         : NULL;
+
         Dwg_Object *obj = ctrl;
         TABLE (APPID);
         COMMON_TABLE_CONTROL_FLAGS;
         error |= dwg_dxfb_APPID_CONTROL (dat, ctrl);
+        if (_ctrl)
         for (i = 0; i < _ctrl->num_entries; i++)
           {
             obj = dwg_ref_object (dwg, _ctrl->entries[i]);
@@ -2002,14 +2030,18 @@ dxfb_tables_write (Bit_Chain *restrict dat, Dwg_Data *restrict dwg)
   SINCE (R_10c1)
   {
     Dwg_Object *ctrl = dwg_get_first_object (dwg, DWG_TYPE_DIMSTYLE_CONTROL);
-    Dwg_Object_DIMSTYLE_CONTROL *_ctrl = ctrl->tio.object->tio.DIMSTYLE_CONTROL;
     if (ctrl && ctrl->fixedtype == DWG_TYPE_DIMSTYLE_CONTROL)
       {
+        Dwg_Object_DIMSTYLE_CONTROL *_ctrl = ctrl->tio.object
+                                         ? ctrl->tio.object->tio.DIMSTYLE_CONTROL
+                                         : NULL;
+
         Dwg_Object *obj = ctrl;
         TABLE (DIMSTYLE);
         COMMON_TABLE_CONTROL_FLAGS;
         dwg_dxfb_DIMSTYLE_CONTROL (dat, ctrl);
         // ignoring morehandles
+        if (_ctrl)
         for (i = 0; i < _ctrl->num_entries; i++)
           {
             obj = dwg_ref_object (dwg, _ctrl->entries[i]);
@@ -2026,13 +2058,17 @@ dxfb_tables_write (Bit_Chain *restrict dat, Dwg_Data *restrict dwg)
   if (0)
     {
       Dwg_Object *ctrl = dwg_get_first_object (dwg, DWG_TYPE_VX_CONTROL);
-      Dwg_Object_VX_CONTROL *_ctrl = ctrl->tio.object->tio.VX_CONTROL;
       if (ctrl && ctrl->fixedtype == DWG_TYPE_VX_CONTROL)
         {
+        Dwg_Object_VX_CONTROL *_ctrl = ctrl->tio.object
+                                         ? ctrl->tio.object->tio.VX_CONTROL
+                                         : NULL;
+
           Dwg_Object *obj = ctrl;
           TABLE (VX_TABLE_RECORD);
           COMMON_TABLE_CONTROL_FLAGS;
           error |= dwg_dxfb_VX_CONTROL (dat, ctrl);
+          if (_ctrl)
           for (i = 0; i < _ctrl->num_entries; i++)
             {
               obj = dwg_ref_object (dwg, _ctrl->entries[i]);
@@ -2091,6 +2127,8 @@ dxfb_tables_write (Bit_Chain *restrict dat, Dwg_Data *restrict dwg)
         error |= dwg_dxfb_BLOCK_HEADER (dat, pspace);
       }
 
+    if (_ctrl)
+
     for (i = 0; i < _ctrl->num_entries; i++)
       {
         obj = dwg_ref_object (dwg, _ctrl->entries[i]);