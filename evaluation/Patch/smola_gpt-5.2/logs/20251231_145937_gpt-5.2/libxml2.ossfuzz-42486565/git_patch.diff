diff --git a/xinclude.c b/xinclude.c
index 41ff4e5f..a80ef611 100644
--- a/xinclude.c
+++ b/xinclude.c
@@ -2464,7 +2464,15 @@ xmlXIncludeDoProcess(xmlXIncludeCtxtPtr ctxt, xmlDocPtr doc, xmlNodePtr tree) {
      * work ok.
      *
      */
-    for (i = ctxt->incBase;i < ctxt->incNr; i++) {
+    /*
+     * Only process XIncludes found during this call.
+     *
+     * xmlXIncludeDoProcess can be called multiple times with the same context
+     * (for example when processing fallback children). Re-processing older
+     * entries can access nodes which were already replaced and freed, leading
+     * to use-after-free.
+     */
+    for (i = start;i < ctxt->incNr; i++) {
 	if ((ctxt->incTab[i]->inc != NULL) ||
 		(ctxt->incTab[i]->xptr != NULL) ||
 		(ctxt->incTab[i]->emptyFb != 0))	/* (empty fallback) */