diff --git a/src/class.c b/src/class.c
index c761f46..fea95dd 100644
--- a/src/class.c
+++ b/src/class.c
@@ -1763,9 +1763,16 @@ mrb_class_path(mrb_state *mrb, struct RClass *c)
 MRB_API struct RClass*
 mrb_class_real(struct RClass* cl)
 {
-  if (cl == 0)
-    return NULL;
-  while ((cl->tt == MRB_TT_SCLASS) || (cl->tt == MRB_TT_ICLASS)) {
+  if (cl == 0) return NULL;
+
+  /*
+   * BasicObject has no superclass (super == NULL). If a module is included into
+   * BasicObject, the inserted ICLASS will also have super == NULL.
+   *
+   * mrb_class_real() is used in various places (e.g. class definition checks)
+   * and must not dereference a NULL superclass when unwrapping SCLASS/ICLASS.
+   */
+  while (cl && ((cl->tt == MRB_TT_SCLASS) || (cl->tt == MRB_TT_ICLASS))) {
     cl = cl->super;
   }
   return cl;