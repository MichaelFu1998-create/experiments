diff --git a/MagickCore/threshold.c b/MagickCore/threshold.c
index f9412bb..e4e8030 100644
--- a/MagickCore/threshold.c
+++ b/MagickCore/threshold.c
@@ -214,6 +214,14 @@ MagickExport Image *AdaptiveThresholdImage(const Image *image,
     return((Image *) NULL);
   if (width == 0)
     return(threshold_image);
+  /*
+    A zero-height neighborhood is invalid.  Without this guard the cache view
+    request below can return a pointer that does not reference any pixel
+    storage, yet we still dereference p[center+i], triggering a heap
+    over-read.
+  */
+  if (height == 0)
+    return(threshold_image);
   status=SetImageStorageClass(threshold_image,DirectClass,exception);
   if (status == MagickFalse)
     {