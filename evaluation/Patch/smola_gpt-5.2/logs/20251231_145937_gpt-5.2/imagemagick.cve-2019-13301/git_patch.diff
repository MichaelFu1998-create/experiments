diff --git a/MagickCore/annotate.c b/MagickCore/annotate.c
index a114578..cb130a4 100644
--- a/MagickCore/annotate.c
+++ b/MagickCore/annotate.c
@@ -265,16 +265,29 @@ MagickExport MagickBooleanType AnnotateImage(Image *image,
   if (*draw_info->text == '\0')
     return(MagickTrue);
   annotate=CloneDrawInfo((ImageInfo *) NULL,draw_info);
+  if (annotate == (DrawInfo *) NULL)
+    return(MagickFalse);
   text=annotate->text;
   annotate->text=(char *) NULL;
   annotate_info=CloneDrawInfo((ImageInfo *) NULL,draw_info);
+  if (annotate_info == (DrawInfo *) NULL)
+    {
+      annotate=DestroyDrawInfo(annotate);
+      text=DestroyString(text);
+      return(MagickFalse);
+    }
   number_lines=1;
   for (p=text; *p != '\0'; p++)
     if (*p == '\n')
       number_lines++;
   textlist=AcquireQuantumMemory(number_lines+1,sizeof(*textlist));
   if (textlist == (char **) NULL)
-    return(MagickFalse);
+    {
+      annotate_info=DestroyDrawInfo(annotate_info);
+      annotate=DestroyDrawInfo(annotate);
+      text=DestroyString(text);
+      return(MagickFalse);
+    }
   p=text;
   for (i=0; i < number_lines; i++)
   {
@@ -303,7 +316,10 @@ MagickExport MagickBooleanType AnnotateImage(Image *image,
       (void) ParseGeometry(annotate_info->geometry,&geometry_info);
     }
   if (SetImageStorageClass(image,DirectClass,exception) == MagickFalse)
-    return(MagickFalse);
+    {
+      status=MagickFalse;
+      goto relinquish;
+    }
   if (IsGrayColorspace(image->colorspace) != MagickFalse)
     (void) SetImageColorspace(image,sRGBColorspace,exception);
   status=MagickTrue;
@@ -517,9 +533,11 @@ MagickExport MagickBooleanType AnnotateImage(Image *image,
   /*
     Relinquish resources.
   */
+relinquish:
   annotate_info=DestroyDrawInfo(annotate_info);
   annotate=DestroyDrawInfo(annotate);
   textlist=(char **) RelinquishMagickMemory(textlist);
+  text=DestroyString(text);
   return(status);
 }