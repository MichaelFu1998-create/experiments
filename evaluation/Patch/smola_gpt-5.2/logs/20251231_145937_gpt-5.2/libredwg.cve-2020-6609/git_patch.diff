diff --git a/examples/dwg2svg2.c b/examples/dwg2svg2.c
index 60e3888..5212c98 100644
--- a/examples/dwg2svg2.c
+++ b/examples/dwg2svg2.c
@@ -80,17 +80,21 @@ help (void)
     exit (1);                                                                 \
   }
 #define dynget(obj, name, field, var)                                         \
-  if (!dwg_dynapi_entity_value (obj, "" name, "" field, var, NULL))           \
-    {                                                                         \
-      fprintf (stderr, "ERROR: %s.%s", name, field);                          \
-      exit (1);                                                               \
-    }
+  do {                                                                         \
+    if (!dwg_dynapi_entity_value (obj, "" name, "" field, var, NULL))           \
+      {                                                                         \
+        fprintf (stderr, "WARN: %s.%s\n", name, field);                          \
+        return;                                                                 \
+      }                                                                         \
+  } while (0)
 #define dynget_utf8(obj, name, field, var)                                    \
-  if (!dwg_dynapi_entity_utf8text (obj, "" name, "" field, var, NULL))        \
-    {                                                                         \
-      fprintf (stderr, "ERROR: %s.%s", name, field);                          \
-      exit (1);                                                               \
-    }
+  do {                                                                         \
+    if (!dwg_dynapi_entity_utf8text (obj, "" name, "" field, var, NULL))        \
+      {                                                                         \
+        fprintf (stderr, "WARN: %s.%s\n", name, field);                          \
+        return;                                                                 \
+      }                                                                         \
+  } while (0)
 
 static double
 transform_X (double x)
diff --git a/src/decode_r2007.c b/src/decode_r2007.c
index 37527b9..fd24c9d 100644
--- a/src/decode_r2007.c
+++ b/src/decode_r2007.c
@@ -992,8 +992,18 @@ read_pages_map (Bit_Chain *dat, int64_t size_comp, int64_t size_uncomp,
 
   LOG_TRACE ("\n=== System Section (Pages Map) ===\n")
 
+  /* Each entry is: uint64_t size + int64_t id.
+     The system page size (size_uncomp) is file-controlled.
+     Ensure we never read past the returned buffer when the
+     uncompressed size is not a multiple of 16. */
   while (ptr < ptr_end)
     {
+      if (ptr_end - ptr < 16)
+        {
+          LOG_WARN ("Truncated pages map entry: only %ld bytes left",
+                    (long)(ptr_end - ptr));
+          break;
+        }
       page = (r2007_page *)malloc (sizeof (r2007_page));
       if (page == NULL)
         {
diff --git a/src/dynapi.c b/src/dynapi.c
index 082d178..13f01d5 100644
--- a/src/dynapi.c
+++ b/src/dynapi.c
@@ -7756,10 +7756,10 @@ dwg_dynapi_entity_value (void *restrict _obj, const char *restrict name,
                          const char *restrict fieldname,
                          void *restrict out, Dwg_DYNAPI_field *restrict fp)
 {
-#ifndef HAVE_NONNULL
+  /* Always validate inputs at runtime: malformed files may lead to
+     partially decoded objects which can be NULL in callers. */
   if (!_obj || !name || !fieldname || !out)
     return false;
-#endif
   {
     int error;
     const Dwg_Object* obj = dwg_obj_generic_to_object (_obj, &error);