diff --git a/tools/plistutil.c b/tools/plistutil.c
index 6451604..e38c708 100644
--- a/tools/plistutil.c
+++ b/tools/plistutil.c
@@ -128,23 +128,65 @@ int main(int argc, char *argv[])
         return 1;
     }
 
-    stat(options->in_file, &filestats);
-    plist_entire = (char *) malloc(sizeof(char) * (filestats.st_size + 1));
-    read_size = fread(plist_entire, sizeof(char), filestats.st_size, iplist);
+    if (stat(options->in_file, &filestats) != 0) {
+        fclose(iplist);
+        free(options);
+        return 1;
+    }
+
+    if (filestats.st_size <= 0) {
+        fclose(iplist);
+        free(options);
+        fprintf(stderr, "ERROR: Input file is empty.\n");
+        return 1;
+    }
+
+    plist_entire = (char *) malloc((size_t)filestats.st_size + 1);
+    if (!plist_entire) {
+        fclose(iplist);
+        free(options);
+        return 1;
+    }
+
+    read_size = (int)fread(plist_entire, 1, (size_t)filestats.st_size, iplist);
     fclose(iplist);
 
+    if (read_size <= 0) {
+        free(plist_entire);
+        free(options);
+        fprintf(stderr, "ERROR: Failed to read input file.\n");
+        return 1;
+    }
+
+    /* Always NUL-terminate for safety, even though we pass an explicit length */
+    plist_entire[read_size] = 0;
+
+    /* Need at least 8 bytes to check for the binary plist magic */
+    if (read_size < 8) {
+        free(plist_entire);
+        free(options);
+        fprintf(stderr, "ERROR: Input file is too short to be a valid plist.\n");
+        return 1;
+    }
+
     // convert from binary to xml or vice-versa
     if (memcmp(plist_entire, "bplist00", 8) == 0)
     {
         plist_from_bin(plist_entire, read_size, &root_node);
-        plist_to_xml(root_node, &plist_out, &size);
+        if (root_node) {
+            plist_to_xml(root_node, &plist_out, &size);
+        }
     }
     else
     {
         plist_from_xml(plist_entire, read_size, &root_node);
-        plist_to_bin(root_node, &plist_out, &size);
+        if (root_node) {
+            plist_to_bin(root_node, &plist_out, &size);
+        }
+    }
+    if (root_node) {
+        plist_free(root_node);
     }
-    plist_free(root_node);
     free(plist_entire);
 
     if (plist_out)