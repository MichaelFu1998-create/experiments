diff --git a/include/yaml-cpp/exceptions.h b/include/yaml-cpp/exceptions.h
index 9c96859..78740f8 100644
--- a/include/yaml-cpp/exceptions.h
+++ b/include/yaml-cpp/exceptions.h
@@ -40,6 +40,7 @@ const char* const END_OF_MAP = "end of map not found";
 const char* const END_OF_MAP_FLOW = "end of map flow not found";
 const char* const END_OF_SEQ = "end of sequence not found";
 const char* const END_OF_SEQ_FLOW = "end of sequence flow not found";
+const char* const MAX_DEPTH_EXCEEDED = "maximum nesting depth exceeded";
 const char* const MULTIPLE_TAGS =
     "cannot assign multiple tags to the same node";
 const char* const MULTIPLE_ANCHORS =
diff --git a/src/singledocparser.cpp b/src/singledocparser.cpp
index a27c1c3..4158ea9 100644
--- a/src/singledocparser.cpp
+++ b/src/singledocparser.cpp
@@ -14,11 +14,22 @@
 #include "yaml-cpp/null.h"
 
 namespace YAML {
+namespace {
+struct RecursionGuard {
+  unsigned& depth;
+  explicit RecursionGuard(unsigned& d) : depth(d) { ++depth; }
+  ~RecursionGuard() { --depth; }
+};
+constexpr unsigned kMaxNestingDepth = 64;
+}  // namespace
+
+
 SingleDocParser::SingleDocParser(Scanner& scanner, const Directives& directives)
     : m_scanner(scanner),
       m_directives(directives),
       m_pCollectionStack(new CollectionStack),
-      m_curAnchor(0) {}
+      m_curAnchor(0),
+      m_nestingDepth(0) {}
 
 SingleDocParser::~SingleDocParser() {}
 
@@ -55,6 +66,10 @@ void SingleDocParser::HandleNode(EventHandler& eventHandler) {
   // save location
   Mark mark = m_scanner.peek().mark;
 
+  RecursionGuard depthGuard(m_nestingDepth);
+  if (m_nestingDepth > kMaxNestingDepth)
+    throw ParserException(mark, ErrorMsg::MAX_DEPTH_EXCEEDED);
+
   // special case: a value node by itself must be a map, with no header
   if (m_scanner.peek().type == Token::VALUE) {
     eventHandler.OnMapStart(mark, "?", NullAnchor, EmitterStyle::Default);
diff --git a/src/singledocparser.h b/src/singledocparser.h
index 2b92067..7afba85 100644
--- a/src/singledocparser.h
+++ b/src/singledocparser.h
@@ -59,6 +59,9 @@ class SingleDocParser : private noncopyable {
   Anchors m_anchors;
 
   anchor_t m_curAnchor;
+
+  // Protect against maliciously deep YAML structures causing stack overflow.
+  unsigned m_nestingDepth;
 };
 }