diff --git a/src/utils/xml_parser.c b/src/utils/xml_parser.c
index 49df338..ad91603 100644
--- a/src/utils/xml_parser.c
+++ b/src/utils/xml_parser.c
@@ -968,6 +968,8 @@ exit:
 static GF_Err xml_sax_append_string(GF_SAXParser *parser, char *string)
 {
 	u32 size = parser->line_size;
+	/* callers may pass NULL on error paths - treat as empty to avoid NULL deref */
+	if (!string) return GF_OK;
 	u32 nl_size = (u32) strlen(string);
 
 	if (!nl_size) return GF_OK;
@@ -990,6 +992,10 @@ static GF_Err xml_sax_append_string(GF_SAXParser *parser, char *string)
 static XML_Entity *gf_xml_locate_entity(GF_SAXParser *parser, char *ent_start, Bool *needs_text)
 {
 	u32 i, count;
+	if (!ent_start) {
+		*needs_text = GF_FALSE;
+		return NULL;
+	}
 	u32 len = (u32) strlen(ent_start);
 
 	*needs_text = GF_FALSE;
@@ -1015,6 +1021,7 @@ static XML_Entity *gf_xml_locate_entity(GF_SAXParser *parser, char *ent_start, B
 static GF_Err gf_xml_sax_parse_intern(GF_SAXParser *parser, char *current)
 {
 	u32 count;
+	if (!current) return GF_BAD_PARAM;
 	/*solve entities*/
 	count = gf_list_count(parser->entities);
 	while (count) {
@@ -1030,7 +1037,12 @@ static GF_Err gf_xml_sax_parse_intern(GF_SAXParser *parser, char *current)
 			char *name;
 			entityEnd = strstr(current, ";");
 			if (!entityEnd) return xml_sax_append_string(parser, current);
-			entityStart = strrchr(parser->buffer, '&');
+			entityStart = parser->buffer ? strrchr(parser->buffer, '&') : NULL;
+			if (!entityStart) {
+				/* corrupted state, avoid crashing on strlen(NULL) */
+				parser->in_entity = GF_FALSE;
+				return GF_CORRUPTED_DATA;
+			}
 
 			entityEnd[0] = 0;
 			len = (u32) strlen(entityStart) + (u32) strlen(current) + 1;