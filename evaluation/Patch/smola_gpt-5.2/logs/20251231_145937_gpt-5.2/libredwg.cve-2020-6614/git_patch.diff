diff --git a/src/decode.c b/src/decode.c
index 205056a..1e8ab6d 100644
--- a/src/decode.c
+++ b/src/decode.c
@@ -2020,6 +2020,13 @@ read_R2004_section_info (Bit_Chain *restrict dat, Dwg_Data *restrict dwg,
     }
 
   ptr = decomp;
+  decomp_end = decomp + decomp_data_size + 1024;
+  if ((size_t)(decomp_end - ptr) < 20)
+    {
+      free (decomp);
+      LOG_ERROR ("read_R2004_section_info out of range");
+      return DWG_ERR_INVALIDDWG;
+    }
   bfr_read (&dwg->header.section_infohdr, &ptr, 20);
   LOG_TRACE ("\n#### Read 2004 section_infohdr ####\n")
   LOG_TRACE ("num_desc:   %d\n", dwg->header.section_infohdr.num_desc)
@@ -2050,7 +2057,7 @@ read_R2004_section_info (Bit_Chain *restrict dat, Dwg_Data *restrict dwg,
       uint64_t sum_decomp = 0;
       uint64_t prev_address = 0;
 
-      if (ptr + 64 >= decomp_end)
+      if ((size_t)(decomp_end - ptr) < (32 + 64))
         {
           free (decomp);
           dwg->header.section_infohdr.num_desc = i;
@@ -2073,7 +2080,8 @@ read_R2004_section_info (Bit_Chain *restrict dat, Dwg_Data *restrict dwg,
                  info->encrypted)
       LOG_TRACE ("name:            %s\n\n", info->name)
 
-      if (ptr + (16 * info->num_sections) >= decomp_end)
+      if (info->num_sections >= 1000000
+          || (size_t)info->num_sections > (size_t)(decomp_end - ptr) / 16u)
         {
           info->name[0] = '\0';
           info->num_sections = 0;