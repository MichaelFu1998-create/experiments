diff --git a/coders/dcm.c b/coders/dcm.c
index 08d497f..94f13a8 100644
--- a/coders/dcm.c
+++ b/coders/dcm.c
@@ -2986,7 +2986,23 @@ static Image *ReadDCMImage(const ImageInfo *image_info,ExceptionInfo *exception)
   if (data != (unsigned char *) NULL) \
     data=(unsigned char *) RelinquishMagickMemory(data); \
   if (stream_info != (DCMStreamInfo *) NULL) \
-    stream_info=(DCMStreamInfo *) RelinquishMagickMemory(stream_info); \
+    { \
+      if (stream_info->offsets != (ssize_t *) NULL) \
+        stream_info->offsets=(ssize_t *) \
+          RelinquishMagickMemory(stream_info->offsets); \
+      stream_info=(DCMStreamInfo *) RelinquishMagickMemory(stream_info); \
+    } \
+  if (info.scale != (Quantum *) NULL) \
+    info.scale=(Quantum *) RelinquishMagickMemory(info.scale); \
+  if (graymap != (int *) NULL) \
+    graymap=(int *) RelinquishMagickMemory(graymap); \
+  if (bluemap != (int *) NULL) \
+    bluemap=(int *) RelinquishMagickMemory(bluemap); \
+  if (greenmap != (int *) NULL) \
+    greenmap=(int *) RelinquishMagickMemory(greenmap); \
+  if (redmap != (int *) NULL) \
+    redmap=(int *) RelinquishMagickMemory(redmap); \
+  (void) CloseBlob(image); \
   ThrowReaderException((exception),(message)); \
 }
 
@@ -3270,7 +3286,7 @@ static Image *ReadDCMImage(const ImageInfo *image_info,ExceptionInfo *exception)
           if ((quantum != 0) && (length != 0))
             {
               if (length > GetBlobSize(image))
-                ThrowReaderException(CorruptImageError,
+                ThrowDCMException(CorruptImageError,
                   "InsufficientImageDataInFile");
               if (~length >= 1)
                 data=(unsigned char *) AcquireQuantumMemory(length+1,quantum*
@@ -3850,6 +3866,24 @@ static Image *ReadDCMImage(const ImageInfo *image_info,ExceptionInfo *exception)
         (void) RelinquishUniqueFileResource(filename);
       }
       read_info=DestroyImageInfo(read_info);
+      if (stream_info != (DCMStreamInfo *) NULL)
+        {
+          if (stream_info->offsets != (ssize_t *) NULL)
+            stream_info->offsets=(ssize_t *)
+              RelinquishMagickMemory(stream_info->offsets);
+          stream_info=(DCMStreamInfo *) RelinquishMagickMemory(stream_info);
+        }
+      if (info.scale != (Quantum *) NULL)
+        info.scale=(Quantum *) RelinquishMagickMemory(info.scale);
+      if (graymap != (int *) NULL)
+        graymap=(int *) RelinquishMagickMemory(graymap);
+      if (bluemap != (int *) NULL)
+        bluemap=(int *) RelinquishMagickMemory(bluemap);
+      if (greenmap != (int *) NULL)
+        greenmap=(int *) RelinquishMagickMemory(greenmap);
+      if (redmap != (int *) NULL)
+        redmap=(int *) RelinquishMagickMemory(redmap);
+      (void) CloseBlob(image);
       image=DestroyImage(image);
       return(GetFirstImageInList(images));
     }
@@ -4121,6 +4155,25 @@ static Image *ReadDCMImage(const ImageInfo *image_info,ExceptionInfo *exception)
         AcquireNextImage(image_info,image,exception);
         if (GetNextImageInList(image) == (Image *) NULL)
           {
+            if (stream_info != (DCMStreamInfo *) NULL)
+              {
+                if (stream_info->offsets != (ssize_t *) NULL)
+                  stream_info->offsets=(ssize_t *)
+                    RelinquishMagickMemory(stream_info->offsets);
+                stream_info=(DCMStreamInfo *)
+                  RelinquishMagickMemory(stream_info);
+              }
+            if (info.scale != (Quantum *) NULL)
+              info.scale=(Quantum *) RelinquishMagickMemory(info.scale);
+            if (graymap != (int *) NULL)
+              graymap=(int *) RelinquishMagickMemory(graymap);
+            if (bluemap != (int *) NULL)
+              bluemap=(int *) RelinquishMagickMemory(bluemap);
+            if (greenmap != (int *) NULL)
+              greenmap=(int *) RelinquishMagickMemory(greenmap);
+            if (redmap != (int *) NULL)
+              redmap=(int *) RelinquishMagickMemory(redmap);
+            (void) CloseBlob(image);
             image=DestroyImageList(image);
             return((Image *) NULL);
           }