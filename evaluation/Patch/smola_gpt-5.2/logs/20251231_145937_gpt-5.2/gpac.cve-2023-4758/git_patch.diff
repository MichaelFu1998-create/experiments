diff --git a/src/media_tools/avilib.c b/src/media_tools/avilib.c
index 7cdca7d..a1a8e4a 100644
--- a/src/media_tools/avilib.c
+++ b/src/media_tools/avilib.c
@@ -1995,7 +1995,12 @@ int avi_parse_input_file(avi_t *AVI, int getIndex)
 
 				n = str2ulong(hdrl_data+i+4);
 				n = PAD_EVEN(n);
-				if (i+n>hdrl_len) ERR_EXIT(AVI_ERR_READ)
+				/*
+				 * Each tag is composed of 8 bytes header (4cc + size) followed by
+				 * n bytes of payload. The original check only validated i+n, which
+				 * allows reading up to 8 bytes past end of hdrl_data.
+				 */
+				if (((u64) i + 8 + n) > (u64) hdrl_len) ERR_EXIT(AVI_ERR_READ)
 
 
 				/* Interpret the tag and its args */
@@ -2008,6 +2013,7 @@ int avi_parse_input_file(avi_t *AVI, int getIndex)
 #endif
 					if(strnicmp((char *)hdrl_data+i,"vids",4) == 0 && !vids_strh_seen)
 					{
+						if ((u32) (hdrl_len - i) < sizeof(alAVISTREAMHEADER)) ERR_EXIT(AVI_ERR_READ)
 						memcpy(AVI->compressor,hdrl_data+i+4,4);
 						AVI->compressor[4] = 0;
 
@@ -2027,6 +2033,7 @@ int avi_parse_input_file(avi_t *AVI, int getIndex)
 					}
 					else if (strnicmp ((char *)hdrl_data+i,"auds",4) ==0 && ! auds_strh_seen)
 					{
+						if ((u32) (hdrl_len - i) < sizeof(alAVISTREAMHEADER)) ERR_EXIT(AVI_ERR_READ)
 
 						//inc audio tracks
 						AVI->aptr=AVI->anum;
@@ -2075,13 +2082,29 @@ int avi_parse_input_file(avi_t *AVI, int getIndex)
 					if(lasttag == 1)
 					{
 						alBITMAPINFOHEADER bih;
+						u32 bi_size;
+						u32 max_copy;
 
+						/* Make sure we can at least read the fixed header */
+						if ((u32) (hdrl_len - i) < sizeof(alBITMAPINFOHEADER)) ERR_EXIT(AVI_ERR_READ)
+						if (n < sizeof(alBITMAPINFOHEADER)) ERR_EXIT(AVI_ERR_READ)
 						memcpy(&bih, hdrl_data + i, sizeof(alBITMAPINFOHEADER));
+						bi_size = str2ulong((unsigned char *)&bih.bi_size);
+
+						/*
+						 * bi_size comes from the bitstream and is used for allocation and
+						 * memcpy. Validate it against the current chunk size and remaining
+						 * hdr buffer to prevent heap OOB reads.
+						 */
+						max_copy = (u32) (hdrl_len - i);
+						if (bi_size < sizeof(alBITMAPINFOHEADER)) ERR_EXIT(AVI_ERR_READ)
+						if ((u64) bi_size > n) ERR_EXIT(AVI_ERR_READ)
+						if (bi_size > max_copy) ERR_EXIT(AVI_ERR_READ)
 						AVI->bitmap_info_header = (alBITMAPINFOHEADER *)
-						                          gf_malloc(str2ulong((unsigned char *)&bih.bi_size));
+						                          gf_malloc(bi_size);
 						if (AVI->bitmap_info_header != NULL)
 							memcpy(AVI->bitmap_info_header, hdrl_data + i,
-							       str2ulong((unsigned char *)&bih.bi_size));
+							       bi_size);
 
 						AVI->width  = str2ulong(hdrl_data+i+4);
 						AVI->height = str2ulong(hdrl_data+i+8);