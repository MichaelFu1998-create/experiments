diff --git a/src/njs_value.c b/src/njs_value.c
index 3f4783c..25977a9 100644
--- a/src/njs_value.c
+++ b/src/njs_value.c
@@ -198,8 +198,19 @@ njs_value_enumerate(njs_vm_t *vm, njs_value_t *value,
     njs_value_t         keys;
     njs_object_value_t  obj_val;
     njs_exotic_slots_t  *slots;
+    njs_object_t        *object;
 
     if (njs_is_object(value)) {
+        /*
+         * njs_is_object() checks only the value type.  The object pointer may
+         * still be NULL for a malformed/uninitialized value.  Avoid NULL
+         * dereferences in njs_object_slots() and enumeration.
+         */
+        object = njs_object(value);
+        if (njs_slow_path(object == NULL)) {
+            return njs_array_alloc(vm, 1, 0, NJS_ARRAY_SPARE);
+        }
+
         if (kind == NJS_ENUM_KEYS && (type & NJS_ENUM_STRING)) {
             slots = njs_object_slots(value);
             if (slots != NULL && slots->keys != NULL) {
@@ -212,7 +223,7 @@ njs_value_enumerate(njs_vm_t *vm, njs_value_t *value,
             }
         }
 
-        return njs_object_enumerate(vm, njs_object(value), kind, type, all);
+        return njs_object_enumerate(vm, object, kind, type, all);
     }
 
     if (value->type != NJS_STRING) {
@@ -234,8 +245,19 @@ njs_value_own_enumerate(njs_vm_t *vm, njs_value_t *value,
     njs_value_t         keys;
     njs_object_value_t  obj_val;
     njs_exotic_slots_t  *slots;
+    njs_object_t        *object;
 
     if (njs_is_object(value)) {
+        /*
+         * njs_is_object() checks only the value type.  The object pointer may
+         * still be NULL for a malformed/uninitialized value.  Avoid NULL
+         * dereferences in njs_object_slots() and enumeration.
+         */
+        object = njs_object(value);
+        if (njs_slow_path(object == NULL)) {
+            return njs_array_alloc(vm, 1, 0, NJS_ARRAY_SPARE);
+        }
+
         if (kind == NJS_ENUM_KEYS && (type & NJS_ENUM_STRING)) {
             slots = njs_object_slots(value);
             if (slots != NULL && slots->keys != NULL) {
@@ -248,7 +270,7 @@ njs_value_own_enumerate(njs_vm_t *vm, njs_value_t *value,
             }
         }
 
-        return njs_object_own_enumerate(vm, njs_object(value), kind, type, all);
+        return njs_object_own_enumerate(vm, object, kind, type, all);
     }
 
     if (value->type != NJS_STRING) {