diff --git a/programs/sndfile-deinterleave.c b/programs/sndfile-deinterleave.c
index e27593e..bafdf89 100644
--- a/programs/sndfile-deinterleave.c
+++ b/programs/sndfile-deinterleave.c
@@ -89,6 +89,18 @@ main (int argc, char **argv)
 		exit (1) ;
 		} ;
 
+	/*
+	** The STATE struct contains fixed sized arrays based on MAX_CHANNELS.
+	** Refuse files with more channels to avoid out-of-bounds writes which can
+	** corrupt pointers and later crash inside libsndfile.
+	*/
+	if (sfinfo.channels > MAX_CHANNELS)
+	{	printf ("\nError : Input file \'%s\' has too many channels (%d). Maximum supported is %d.\n",
+			argv [1], sfinfo.channels, MAX_CHANNELS) ;
+		exit (1) ;
+		} ;
+
+
 	state.channels = sfinfo.channels ;
 	sfinfo.channels = 1 ;
 
diff --git a/src/sndfile.c b/src/sndfile.c
index b76bfe9..c2e23e4 100644
--- a/src/sndfile.c
+++ b/src/sndfile.c
@@ -1642,6 +1642,11 @@ sf_read_short	(SNDFILE *sndfile, short *ptr, sf_count_t len)
 
 	VALIDATE_SNDFILE_AND_ASSIGN_PSF (sndfile, psf, 1) ;
 
+	if (ptr == NULL)
+	{	psf->error = SFE_BAD_INT_PTR ;
+		return 0 ;
+		} ;
+
 	if (len <= 0)
 	{	psf->error = SFE_NEGATIVE_RW_LEN ;
 		return 0 ;
@@ -2256,6 +2261,11 @@ sf_write_int	(SNDFILE *sndfile, const int *ptr, sf_count_t len)
 
 	VALIDATE_SNDFILE_AND_ASSIGN_PSF (sndfile, psf, 1) ;
 
+	if (ptr == NULL)
+	{	psf->error = SFE_BAD_INT_PTR ;
+		return 0 ;
+		} ;
+
 	if (len <= 0)
 	{	psf->error = SFE_NEGATIVE_RW_LEN ;
 		return 0 ;