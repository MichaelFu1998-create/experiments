diff --git a/src/decode_r2007.c b/src/decode_r2007.c
index ca1f23d..50ccda4 100644
--- a/src/decode_r2007.c
+++ b/src/decode_r2007.c
@@ -581,6 +581,16 @@ decode_rs (const BITCODE_RC *src, int block_count, int data_size,
   BITCODE_RC *dst_base, *dst;
   // TODO: round up data_size from 239 to 255
 
+  /* A malformed file may yield a zero/negative block_count or data_size.
+     In such cases calloc(0, ...) may return a non-NULL tiny allocation and
+     subsequent callers may memcpy beyond it. Treat these as invalid. */
+  if (block_count <= 0 || data_size <= 0)
+    {
+      LOG_ERROR ("decode_rs invalid params: block_count=%d data_size=%d",
+                 block_count, data_size)
+      return NULL;
+    }
+
   if ((unsigned long)block_count * data_size > src_size)
     {
       LOG_ERROR ("decode_rs src overflow: %ld > %u",
@@ -663,7 +673,17 @@ read_system_page (Bit_Chain *dat, int64_t size_comp, int64_t size_uncomp,
   if (size_comp < size_uncomp)
     error = decompress_r2007 (data, size_uncomp, pedata, MIN (pedata_size, size_comp));
   else
-    memcpy (data, pedata, size_uncomp);
+    {
+      if (pedata_size < size_uncomp)
+        {
+          LOG_ERROR ("Invalid system page: decoded size %ld < required %ld",
+                     (long)pedata_size, (long)size_uncomp);
+          free (pedata);
+          free (data);
+          return NULL;
+        }
+      memcpy (data, pedata, size_uncomp);
+    }
   free (pedata);
 
   if (error >= DWG_ERR_CRITICAL)
@@ -702,13 +722,25 @@ read_data_page (Bit_Chain *restrict dat, BITCODE_RC *restrict decomp,
   bit_read_fixed (dat, rsdata, page_size);
   pedata = decode_rs (rsdata, block_count, 0xFB, page_size);
   if (!pedata)
-    return DWG_ERR_OUTOFMEM;
+    {
+      free (rsdata);
+      return DWG_ERR_OUTOFMEM;
+    }
 
   if (size_comp < size_uncomp)
     error = decompress_r2007 (decomp, size_uncomp, pedata,
                               MIN (pedata_size, size_comp));
   else
-    memcpy (decomp, pedata, size_uncomp);
+    {
+      if (pedata_size < size_uncomp)
+        {
+          LOG_ERROR ("Invalid data page: decoded size %ld < required %ld",
+                     (long)pedata_size, (long)size_uncomp);
+          error = DWG_ERR_INTERNALERROR;
+        }
+      else
+        memcpy (decomp, pedata, size_uncomp);
+    }
 
   free (pedata);
   free (rsdata);