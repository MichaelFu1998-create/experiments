diff --git a/MagickCore/composite.c b/MagickCore/composite.c
index 78d6dff..dbd008a 100644
--- a/MagickCore/composite.c
+++ b/MagickCore/composite.c
@@ -663,7 +663,14 @@ MagickExport MagickBooleanType CompositeImage(Image *image,
             if (traits == UndefinedPixelTrait)
               continue;
             if (source_traits != UndefinedPixelTrait)
-              SetPixelChannel(image,channel,p[i],q);
+              /*
+                Do not index the source pixel by the destination channel index.
+                The source and destination images may have different channel
+                counts / layouts, and using p[i] can read past the end of the
+                source pixel.
+              */
+              SetPixelChannel(image,channel,GetPixelChannel(source_image,
+                channel,p),q);
             else if (channel == AlphaPixelChannel)
               SetPixelChannel(image,channel,OpaqueAlpha,q);
           }