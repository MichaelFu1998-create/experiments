diff --git a/coders/pnm.c b/coders/pnm.c
index a54bc60..391b4b8 100644
--- a/coders/pnm.c
+++ b/coders/pnm.c
@@ -1765,6 +1765,11 @@ static MagickBooleanType WritePNMImage(const ImageInfo *image_info,Image *image,
               }
             p+=GetPixelChannels(image);
           }
+          if (((size_t) (q-pixels)+1) >= sizeof(pixels))
+            {
+              (void) WriteBlob(image,q-pixels,pixels);
+              q=pixels;
+            }
           *q++='\n';
           (void) WriteBlob(image,q-pixels,pixels);
           q=pixels;
@@ -1777,9 +1782,23 @@ static MagickBooleanType WritePNMImage(const ImageInfo *image_info,Image *image,
             }
         }
         if (q != pixels)
+
           {
+
+            if (((size_t) (q-pixels)+1) >= sizeof(pixels))
+
+              {
+
+                (void) WriteBlob(image,q-pixels,pixels);
+
+                q=pixels;
+
+              }
+
             *q++='\n';
+
             (void) WriteBlob(image,q-pixels,pixels);
+
           }
         break;
       }
@@ -1824,16 +1843,27 @@ static MagickBooleanType WritePNMImage(const ImageInfo *image_info,Image *image,
                 count=(ssize_t) FormatLocaleString(buffer,MagickPathExtent,
                   "%u ",ScaleQuantumToLong(index));
             extent=(size_t) count;
-            (void) strncpy((char *) q,buffer,extent);
-            q+=extent;
-            if ((q-pixels+extent+2) >= sizeof(pixels))
+
+            if (((size_t) (q-pixels)+extent) >= sizeof(pixels))
+
               {
-                *q++='\n';
+
                 (void) WriteBlob(image,q-pixels,pixels);
+
                 q=pixels;
+
               }
+
+            (void) memcpy(q,buffer,extent);
+
+            q+=extent;
             p+=GetPixelChannels(image);
           }
+          if (((size_t) (q-pixels)+1) >= sizeof(pixels))
+            {
+              (void) WriteBlob(image,q-pixels,pixels);
+              q=pixels;
+            }
           *q++='\n';
           (void) WriteBlob(image,q-pixels,pixels);
           q=pixels;
@@ -1846,9 +1876,23 @@ static MagickBooleanType WritePNMImage(const ImageInfo *image_info,Image *image,
             }
         }
         if (q != pixels)
+
           {
+
+            if (((size_t) (q-pixels)+1) >= sizeof(pixels))
+
+              {
+
+                (void) WriteBlob(image,q-pixels,pixels);
+
+                q=pixels;
+
+              }
+
             *q++='\n';
+
             (void) WriteBlob(image,q-pixels,pixels);
+
           }
         break;
       }
@@ -1899,19 +1943,30 @@ static MagickBooleanType WritePNMImage(const ImageInfo *image_info,Image *image,
                   ScaleQuantumToLong(GetPixelGreen(image,p)),
                   ScaleQuantumToLong(GetPixelBlue(image,p)));
             extent=(size_t) count;
-            (void) strncpy((char *) q,buffer,extent);
-            q+=extent;
-            if ((q-pixels+extent+2) >= sizeof(pixels))
+
+            if (((size_t) (q-pixels)+extent) >= sizeof(pixels))
+
               {
-                *q++='\n';
+
                 (void) WriteBlob(image,q-pixels,pixels);
+
                 q=pixels;
+
               }
+
+            (void) memcpy(q,buffer,extent);
+
+            q+=extent;
             p+=GetPixelChannels(image);
           }
-          *q++='\n';
-          (void) WriteBlob(image,q-pixels,pixels);
-          q=pixels;
+if (((size_t) (q-pixels)+1) >= sizeof(pixels))
+  {
+    (void) WriteBlob(image,q-pixels,pixels);
+    q=pixels;
+  }
+*q++='\n';
+(void) WriteBlob(image,q-pixels,pixels);
+q=pixels;
           if (image->previous == (Image *) NULL)
             {
               status=SetImageProgress(image,SaveImageTag,(MagickOffsetType) y,
@@ -1921,9 +1976,23 @@ static MagickBooleanType WritePNMImage(const ImageInfo *image_info,Image *image,
             }
         }
         if (q != pixels)
+
           {
+
+            if (((size_t) (q-pixels)+1) >= sizeof(pixels))
+
+              {
+
+                (void) WriteBlob(image,q-pixels,pixels);
+
+                q=pixels;
+
+              }
+
             *q++='\n';
+
             (void) WriteBlob(image,q-pixels,pixels);
+
           }
         break;
       }