diff --git a/src/media_tools/isom_tools.c b/src/media_tools/isom_tools.c
index 21f8905..dcdde3d 100644
--- a/src/media_tools/isom_tools.c
+++ b/src/media_tools/isom_tools.c
@@ -3289,12 +3289,21 @@ GF_Err gf_media_change_pl(GF_ISOFile *file, u32 track, u32 profile, u32 compat,
 	}
 
 	avcc = gf_isom_avc_config_get(file, track, 1);
+	/*
+		gf_isom_avc_config_get() may return NULL for malformed/partial files or
+		when the track is signaled as AVC but has no avcC box. Avoid NULL writes.
+	*/
+	if (!avcc)
+		return GF_OK;
 	if (level) avcc->AVCLevelIndication = level;
 	if (compat) avcc->profile_compatibility = compat;
 	if (profile) avcc->AVCProfileIndication = profile;
-	count = gf_list_count(avcc->sequenceParameterSets);
+	count = avcc->sequenceParameterSets ? gf_list_count(avcc->sequenceParameterSets) : 0;
 	for (i=0; i<count; i++) {
 		GF_NALUFFParam *slc = gf_list_get(avcc->sequenceParameterSets, i);
+		/* Ensure SPS is large enough before patching profile/level bytes */
+		if (!slc || !slc->data || (slc->size < 4))
+			continue;
 		if (profile) slc->data[1] = profile;
 		if (level) slc->data[3] = level;
 	}