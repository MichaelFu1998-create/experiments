diff --git a/src/mat.c b/src/mat.c
index a0bc257..8b37b76 100644
--- a/src/mat.c
+++ b/src/mat.c
@@ -1448,8 +1448,18 @@ Mat_VarFree(matvar_t *matvar)
     if ( NULL != matvar->internal ) {
 #if defined(HAVE_ZLIB)
         if ( matvar->compression == MAT_COMPRESSION_ZLIB ) {
-            inflateEnd(matvar->internal->z);
-            free(matvar->internal->z);
+            /*
+             * Some code paths (e.g. memory-optimization when reading
+             * compressed variables) intentionally free and NULL the
+             * inflate stream while keeping the compression flag.
+             * Be defensive here to avoid dereferencing/freeing NULL or
+             * invalid pointers.
+             */
+            if ( matvar->internal->z != NULL ) {
+                inflateEnd(matvar->internal->z);
+                free(matvar->internal->z);
+                matvar->internal->z = NULL;
+            }
             if ( (matvar->internal->data != NULL) && (matvar->class_type == MAT_C_SPARSE) ) {
                 mat_sparse_t *sparse;
                 sparse = (mat_sparse_t*)matvar->internal->data;