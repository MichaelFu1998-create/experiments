diff --git a/coders/dcm.c b/coders/dcm.c
index 5f9cb02..6ea6fcb 100644
--- a/coders/dcm.c
+++ b/coders/dcm.c
@@ -3573,6 +3573,7 @@ static Image *ReadDCMImage(const ImageInfo *image_info,ExceptionInfo *exception)
             unsigned short
               index;
 
+
             /*
               Populate redmap.
             */
@@ -3580,6 +3581,8 @@ static Image *ReadDCMImage(const ImageInfo *image_info,ExceptionInfo *exception)
               break;
             colors=(size_t) (length/2);
             datum=(int) colors;
+            if (redmap != (int *) NULL)
+              redmap=(int *) RelinquishMagickMemory(redmap);
             redmap=(int *) AcquireQuantumMemory((size_t) colors,
               sizeof(*redmap));
             if (redmap == (int *) NULL)
@@ -3594,6 +3597,7 @@ static Image *ReadDCMImage(const ImageInfo *image_info,ExceptionInfo *exception)
               redmap[i]=(int) index;
               p+=2;
             }
+
             break;
           }
           case 0x1202:
@@ -3601,6 +3605,7 @@ static Image *ReadDCMImage(const ImageInfo *image_info,ExceptionInfo *exception)
             unsigned short
               index;
 
+
             /*
               Populate greenmap.
             */
@@ -3608,6 +3613,8 @@ static Image *ReadDCMImage(const ImageInfo *image_info,ExceptionInfo *exception)
               break;
             colors=(size_t) (length/2);
             datum=(int) colors;
+            if (greenmap != (int *) NULL)
+              greenmap=(int *) RelinquishMagickMemory(greenmap);
             greenmap=(int *) AcquireQuantumMemory((size_t) colors,
               sizeof(*greenmap));
             if (greenmap == (int *) NULL)
@@ -3622,6 +3629,7 @@ static Image *ReadDCMImage(const ImageInfo *image_info,ExceptionInfo *exception)
               greenmap[i]=(int) index;
               p+=2;
             }
+
             break;
           }
           case 0x1203:
@@ -3629,6 +3637,7 @@ static Image *ReadDCMImage(const ImageInfo *image_info,ExceptionInfo *exception)
             unsigned short
               index;
 
+
             /*
               Populate bluemap.
             */
@@ -3636,6 +3645,8 @@ static Image *ReadDCMImage(const ImageInfo *image_info,ExceptionInfo *exception)
               break;
             colors=(size_t) (length/2);
             datum=(int) colors;
+            if (bluemap != (int *) NULL)
+              bluemap=(int *) RelinquishMagickMemory(bluemap);
             bluemap=(int *) AcquireQuantumMemory((size_t) colors,
               sizeof(*bluemap));
             if (bluemap == (int *) NULL)
@@ -3650,6 +3661,7 @@ static Image *ReadDCMImage(const ImageInfo *image_info,ExceptionInfo *exception)
               bluemap[i]=(int) index;
               p+=2;
             }
+
             break;
           }
           default: