diff --git a/coders/png.c b/coders/png.c
index c15a4db..7796642 100644
--- a/coders/png.c
+++ b/coders/png.c
@@ -2300,6 +2300,14 @@ static Image *ReadOnePNGImage(MngInfo *mng_info,
       if (pixel_info != (MemoryInfo *) NULL)
         pixel_info=RelinquishVirtualMemory(pixel_info);
 
+      /*
+        Ensure we release any QuantumInfo that may have been allocated
+        before libpng raised an error (png_error triggers a longjmp).
+        Otherwise, crafted PNG files can cause memory leaks.
+      */
+      if (quantum_info != (QuantumInfo *) NULL)
+        quantum_info=DestroyQuantumInfo(quantum_info);
+
       if (logging != MagickFalse)
         (void) LogMagickEvent(CoderEvent,GetMagickModule(),
           "  exit ReadOnePNGImage() with error.");