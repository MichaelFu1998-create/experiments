diff --git a/build/njs_auto_config.h b/build/njs_auto_config.h
new file mode 100644
index 0000000..8e9c19c
--- /dev/null
+++ b/build/njs_auto_config.h
@@ -0,0 +1,103 @@
+
+/* This file is auto-generated by configure */
+
+
+#ifndef NJS_LINUX
+#define NJS_LINUX  1
+#endif
+
+
+#ifndef NJS_CLANG
+#define NJS_CLANG  1
+#endif
+
+
+#ifndef NJS_HAVE_UNSIGNED_INT128
+#define NJS_HAVE_UNSIGNED_INT128  1
+#endif
+
+
+#ifndef NJS_HAVE_BUILTIN_EXPECT
+#define NJS_HAVE_BUILTIN_EXPECT  1
+#endif
+
+
+#ifndef NJS_HAVE_BUILTIN_UNREACHABLE
+#define NJS_HAVE_BUILTIN_UNREACHABLE  1
+#endif
+
+
+#ifndef NJS_HAVE_BUILTIN_PREFETCH
+#define NJS_HAVE_BUILTIN_PREFETCH  1
+#endif
+
+
+#ifndef NJS_HAVE_BUILTIN_CLZ
+#define NJS_HAVE_BUILTIN_CLZ  1
+#endif
+
+
+#ifndef NJS_HAVE_BUILTIN_CLZLL
+#define NJS_HAVE_BUILTIN_CLZLL  1
+#endif
+
+
+#ifndef NJS_HAVE_GCC_ATTRIBUTE_VISIBILITY
+#define NJS_HAVE_GCC_ATTRIBUTE_VISIBILITY  1
+#endif
+
+
+#ifndef NJS_HAVE_GCC_ATTRIBUTE_MALLOC
+#define NJS_HAVE_GCC_ATTRIBUTE_MALLOC  1
+#endif
+
+
+#ifndef NJS_HAVE_GCC_ATTRIBUTE_ALIGNED
+#define NJS_HAVE_GCC_ATTRIBUTE_ALIGNED  1
+#endif
+
+
+#ifndef NJS_HAVE_ADDRESS_SANITIZER
+#define NJS_HAVE_ADDRESS_SANITIZER  1
+#endif
+
+
+#ifndef NJS_NAN_TO_UINT_CONVERSION
+#define NJS_NAN_TO_UINT_CONVERSION  0
+#endif
+
+
+#ifndef NJS_HAVE_CLOCK_MONOTONIC
+#define NJS_HAVE_CLOCK_MONOTONIC  1
+#endif
+
+
+#ifndef NJS_HAVE_TM_GMTOFF
+#define NJS_HAVE_TM_GMTOFF  1
+#endif
+
+
+#ifndef NJS_HAVE_POSIX_MEMALIGN
+#define NJS_HAVE_POSIX_MEMALIGN  1
+#endif
+
+
+#ifndef NJS_HAVE_GETRANDOM
+#define NJS_HAVE_GETRANDOM  1
+#endif
+
+
+#ifndef NJS_HAVE_EXPLICIT_BZERO
+#define NJS_HAVE_EXPLICIT_BZERO  1
+#endif
+
+
+#ifndef NJS_HAVE_PCRE
+#define NJS_HAVE_PCRE  1
+#endif
+
+
+#ifndef NJS_HAVE_GNU_READLINE
+#define NJS_HAVE_GNU_READLINE  1
+#endif
+
diff --git a/src/njs_disassembler.c b/src/njs_disassembler.c
index ed02285..d17962a 100644
--- a/src/njs_disassembler.c
+++ b/src/njs_disassembler.c
@@ -452,7 +452,7 @@ njs_disassemble(u_char *start, u_char *end)
                     code3 = (njs_vmcode_3addr_t *) p;
 
                     njs_printf("%05uz %*s  %04Xz %04Xz %04Xz\n",
-                               p - start, name->length, name->start,
+                               p - start, (size_t) (name->length), name->start,
                                (size_t) code3->dst, (size_t) code3->src1,
                                (size_t) code3->src2);
 
@@ -460,14 +460,14 @@ njs_disassemble(u_char *start, u_char *end)
                     code2 = (njs_vmcode_2addr_t *) p;
 
                     njs_printf("%05uz %*s  %04Xz %04Xz\n",
-                               p - start, name->length, name->start,
+                               p - start, (size_t) (name->length), name->start,
                                (size_t) code2->dst, (size_t) code2->src);
 
                 } else if (code_name->size == sizeof(njs_vmcode_1addr_t)) {
                     code1 = (njs_vmcode_1addr_t *) p;
 
                     njs_printf("%05uz %*s  %04Xz\n",
-                               p - start, name->length, name->start,
+                               p - start, (size_t) (name->length), name->start,
                                (size_t) code1->index);
                 }
 
diff --git a/src/njs_regexp.c b/src/njs_regexp.c
index c488ce0..5202377 100644
--- a/src/njs_regexp.c
+++ b/src/njs_regexp.c
@@ -366,9 +366,20 @@ njs_regexp_literal(njs_vm_t *vm, njs_parser_t *parser, njs_value_t *value)
             flags = njs_regexp_flags(&p, lexer->end, 0);
 
             if (njs_slow_path(flags < 0)) {
+
+                /*
+                 * njs_regexp_flags() may set p to lexer->end + 1 on error.
+                 * Clamp it to the input boundaries to avoid OOB reads when
+                 * formatting the error message.
+                 */
+                if (p > lexer->end) {
+                    p = lexer->end;
+                }
+
                 njs_parser_syntax_error(vm, parser,
                                         "Invalid RegExp flags \"%*s\"",
-                                        p - lexer->start, lexer->start);
+                                        (size_t) (p - lexer->start),
+                                        lexer->start);
 
                 return NJS_TOKEN_ILLEGAL;
             }
@@ -390,8 +401,17 @@ njs_regexp_literal(njs_vm_t *vm, njs_parser_t *parser, njs_value_t *value)
 
 failed:
 
+    /*
+     * The main scanning loop may advance p to lexer->end and then the
+     * for-loop increment makes it lexer->end + 1.  Clamp it to avoid
+     * out-of-bounds reads when reporting an unterminated RegExp.
+     */
+    if (p > lexer->end) {
+        p = lexer->end;
+    }
+
     njs_parser_syntax_error(vm, parser, "Unterminated RegExp \"%*s\"",
-                            p - (lexer->start - 1), lexer->start - 1);
+                            (size_t) (p - (lexer->start - 1)), lexer->start - 1);
 
     return NJS_TOKEN_ILLEGAL;
 }
@@ -642,11 +662,11 @@ njs_regexp_compile_trace_handler(njs_trace_t *trace, njs_trace_data_t *td,
     p = trace->handler(trace, td, start);
 
     if (vm->parser != NULL && vm->parser->lexer != NULL) {
-        njs_syntax_error(vm, "%*s in %uD", p - start, start,
+        njs_syntax_error(vm, "%*s in %uD", (size_t) (p - start), start,
                          vm->parser->lexer->line);
 
     } else {
-        njs_syntax_error(vm, "%*s", p - start, start);
+        njs_syntax_error(vm, "%*s", (size_t) (p - start), start);
     }
 
     return p;
diff --git a/src/njs_shell.c b/src/njs_shell.c
index 7f0c685..518bbeb 100644
--- a/src/njs_shell.c
+++ b/src/njs_shell.c
@@ -932,7 +932,7 @@ next:
             }
 
             njs_sprintf((u_char *) completion, (u_char *) completion + len,
-                        "%*s%V%Z", p - text, text, suffix);
+                        "%*s%V%Z", (size_t) (p - text), text, suffix);
             return completion;
         }
 
diff --git a/src/njs_sprintf.c b/src/njs_sprintf.c
index 1f7358e..dbc090e 100644
--- a/src/njs_sprintf.c
+++ b/src/njs_sprintf.c
@@ -92,6 +92,7 @@ njs_vsprintf(u_char *buf, u_char *end, const char *fmt, va_list args)
     njs_str_t      *v;
     njs_uint_t     scale, n;
     njs_bool_t     sign;
+    njs_bool_t     escape;
     njs_sprintf_t  spf;
 
     static const u_char  hexadecimal[16] = "0123456789abcdef";
@@ -144,6 +145,10 @@ njs_vsprintf(u_char *buf, u_char *end, const char *fmt, va_list args)
             continue;
 
         case '*':
+            /*
+             * njs %*s expects a size_t length followed by the string pointer.
+             * All call sites must pass size_t to avoid varargs type mismatch.
+             */
             length = va_arg(args, size_t);
 
             fmt++;
@@ -153,6 +158,7 @@ njs_vsprintf(u_char *buf, u_char *end, const char *fmt, va_list args)
                 p = va_arg(args, u_char *);
 
                 if (njs_fast_path(p != NULL)) {
+                    escape = 1;
                     goto copy;
                 }
             }
@@ -163,6 +169,8 @@ njs_vsprintf(u_char *buf, u_char *end, const char *fmt, va_list args)
             break;
         }
 
+        escape = 0;
+
         spf.hex = NULL;
         spf.width = 0;
         spf.frac_width = -1;
@@ -418,7 +426,39 @@ njs_vsprintf(u_char *buf, u_char *end, const char *fmt, va_list args)
 
     copy:
 
-        buf = njs_cpymem(buf, p, njs_min((size_t) (end - buf), length));
+        if (!escape) {
+            buf = njs_cpymem(buf, p, njs_min((size_t) (end - buf), length));
+
+        } else {
+            /*
+             * %*s is used to print slices of the input stream which may
+             * contain arbitrary bytes (not necessarily valid UTF-8).  Since
+             * error output is typically treated as text, escape non-ASCII and
+             * control bytes to keep output valid and avoid toolchain decode
+             * failures.
+             */
+            size_t  n;
+            u_char  ch;
+
+            for (n = 0; n < length && buf < end; n++) {
+                ch = p[n];
+
+                if (ch >= 0x20 && ch < 0x7F) {
+                    *buf++ = ch;
+                    continue;
+                }
+
+                if (end - buf < 4) {
+                    break;
+                }
+
+                *buf++ = '\\';
+                *buf++ = 'x';
+                *buf++ = hexadecimal[ch >> 4];
+                *buf++ = hexadecimal[ch & 0xF];
+            }
+        }
+
         continue;
     }
 
diff --git a/src/njs_value.c b/src/njs_value.c
index 9a034d1..b1c436e 100644
--- a/src/njs_value.c
+++ b/src/njs_value.c
@@ -66,7 +66,7 @@ njs_value_retain(njs_value_t *value)
             string = value->long_string.data;
 
             njs_thread_log_debug("retain:%uxD \"%*s\"", string->retain,
-                                 value->long_string.size, string->start);
+                                 (size_t) (value->long_string.size), string->start);
 
             if (string->retain != 0xffff) {
                 string->retain++;
@@ -87,7 +87,7 @@ njs_value_release(njs_vm_t *vm, njs_value_t *value)
             string = value->long_string.data;
 
             njs_thread_log_debug("release:%uxD \"%*s\"", string->retain,
-                                 value->long_string.size, string->start);
+                                 (size_t) (value->long_string.size), string->start);
 
             if (string->retain != 0xffff) {
                 string->retain--;