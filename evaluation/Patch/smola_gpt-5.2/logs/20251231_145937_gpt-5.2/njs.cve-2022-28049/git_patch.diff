diff --git a/src/njs_vmcode.c b/src/njs_vmcode.c
index ef0beb5..8ecd2ee 100644
--- a/src/njs_vmcode.c
+++ b/src/njs_vmcode.c
@@ -1058,11 +1058,17 @@ njs_vmcode_array(njs_vm_t *vm, u_char *pc)
             value = array->start;
             length = array->length;
 
-            do {
+            /*
+             * The array may legitimately have zero length (e.g. fuzzed bytecode
+             * with ctor flag set).  The previous do-while loop would execute
+             * once even when length is zero and would dereference array->start
+             * which can be NULL for an empty array.
+             */
+            while (length != 0) {
                 njs_set_invalid(value);
                 value++;
                 length--;
-            } while (length != 0);
+            }
 
         } else {
             /* Array of the form [], [,,1], [1,2,3]. */