diff --git a/src/decode_r2007.c b/src/decode_r2007.c
index 3d422ea..b60a052 100644
--- a/src/decode_r2007.c
+++ b/src/decode_r2007.c
@@ -513,7 +513,7 @@ decompress_r2007 (BITCODE_RC *restrict dst, const unsigned dst_size,
       if (length == 0)
         length = read_literal_length (&src, opcode);
 
-      if ((dst + length) >= dst_end || (src + length) > src_end)
+      if ((dst + length) > dst_end || (src + length) > src_end)
         {
           if (DWG_LOGLEVEL >= DWG_LOGLEVEL_HANDLE)
             {
@@ -1244,7 +1244,7 @@ read_file_header (Bit_Chain *restrict dat,
   LOG_TRACE ("len2:          %d\n", (int)len2);      // 0 when compressed
 
   if (compr_len > 0)
-    error = decompress_r2007 ((BITCODE_RC *)file_header, sizeof (r2007_file_header) + 1,
+    error = decompress_r2007 ((BITCODE_RC *)file_header, sizeof (r2007_file_header),
                               &pedata[32], MIN (compr_len, pedata_size - 32));
   else
     memcpy (file_header, &pedata[32], sizeof (r2007_file_header));