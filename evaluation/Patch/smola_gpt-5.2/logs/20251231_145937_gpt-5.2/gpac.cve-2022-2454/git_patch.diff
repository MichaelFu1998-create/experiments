diff --git a/src/laser/lsr_dec.c b/src/laser/lsr_dec.c
index 99d16aa..6e524d3 100644
--- a/src/laser/lsr_dec.c
+++ b/src/laser/lsr_dec.c
@@ -838,9 +838,17 @@ static void lsr_read_id(GF_LASeRCodec *lsr, GF_Node *n)
 
 static Fixed lsr_translate_coords(GF_LASeRCodec *lsr, u32 val, u32 nb_bits)
 {
+	/*
+	 * nb_bits comes from the bitstream and may be 0 or larger than the size
+	 * of the type. Using it directly would lead to undefined behaviour when
+	 * shifting (nb_bits-1) or computing (1<<nb_bits).
+	 */
+	if (!nb_bits || (nb_bits > 31)) {
+		return 0;
+	}
 #ifdef GPAC_FIXED_POINT
 	if (val >> (nb_bits-1) ) {
-		s32 neg = (s32) val - (1<<nb_bits);
+		s32 neg = (s32) ((s64) (s32) val - (s64) (1ULL<<nb_bits));
 		if (neg < -FIX_ONE / 2)
 			return 2 * gf_divfix(INT2FIX(neg/2), lsr->res_factor);
 		return gf_divfix(INT2FIX(neg), lsr->res_factor);
@@ -851,7 +859,7 @@ static Fixed lsr_translate_coords(GF_LASeRCodec *lsr, u32 val, u32 nb_bits)
 	}
 #else
 	if (val >> (nb_bits-1) ) {
-		s32 neg = (s32) val - (1<<nb_bits);
+		s32 neg = (s32) ((s64) (s32) val - (s64) (1ULL<<nb_bits));
 		return gf_divfix(INT2FIX(neg), lsr->res_factor);
 	} else {
 		return gf_divfix(INT2FIX(val), lsr->res_factor);