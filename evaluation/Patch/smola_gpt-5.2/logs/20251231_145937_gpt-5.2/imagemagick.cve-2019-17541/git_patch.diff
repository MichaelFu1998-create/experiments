diff --git a/coders/jpeg.c b/coders/jpeg.c
index 275be95..ee97645 100644
--- a/coders/jpeg.c
+++ b/coders/jpeg.c
@@ -564,6 +564,7 @@ static boolean ReadICCProfile(j_decompress_ptr jpeg_info)
       break;
     *p++=(unsigned char) c;
   }
+  error_manager->profile=NULL;
   if (i != (ssize_t) length)
     {
       profile=DestroyStringInfo(profile);
@@ -572,7 +573,6 @@ static boolean ReadICCProfile(j_decompress_ptr jpeg_info)
         image->filename);
       return(FALSE);
     }
-  error_manager->profile=NULL;
   icc_profile=(StringInfo *) GetImageProfile(image,"icc");
   if (icc_profile != (StringInfo *) NULL)
     {