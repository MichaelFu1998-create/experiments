diff --git a/src/media_tools/isom_hinter.c b/src/media_tools/isom_hinter.c
index c05d38ccc..3f1edecba 100644
--- a/src/media_tools/isom_hinter.c
+++ b/src/media_tools/isom_hinter.c
@@ -1193,7 +1193,18 @@ GF_Err gf_hinter_finalize(GF_ISOFile *file, GF_SDP_IODProfile IOD_Profile, u32 b
 
 		/*get OD esd, and embbed stream data if possible*/
 		if (odT) {
-			esd = gf_isom_get_esd(file, odT, 1);
+	esd = gf_isom_get_esd(file, odT, 1);
+	/* ensure esd and decoderConfig present before use */
+	if (!esd || !esd->decoderConfig) {
+		is_ok = 0;
+		if (esd) { gf_odf_desc_del((GF_Descriptor *) esd); esd = NULL; }
+	} else {
+
+	/* validate ESD and decoderConfig before any dereference */
+	if (!esd || !esd->decoderConfig) {
+		if (esd) { GF_LOG(GF_LOG_WARNING, GF_LOG_RTP, ("[rtp hinter] OD ESD missing or has no decoderConfig - ISMA disabled\n")); gf_odf_desc_del((GF_Descriptor *) esd); esd = NULL; }
+		is_ok = 0;
+	} else {
 			if (gf_isom_get_sample_count(file, odT)==1) {
 				samp = gf_isom_get_sample(file, odT, 1, &descIndex);
 				if (samp && gf_hinter_can_embbed_data(samp->data, samp->dataLength, GF_STREAM_OD)) {
@@ -1227,10 +1238,24 @@ GF_Err gf_hinter_finalize(GF_ISOFile *file, GF_SDP_IODProfile IOD_Profile, u32 b
 			else if (esd->OCRESID == esd->ESID) esd->OCRESID = 0;
 
 			//OK, add this to our IOD
-			gf_list_add(iod->ESDescriptors, esd);
+			
+	}	}
+
+	if (esd) gf_list_add(iod->ESDescriptors, esd);
 		}
 
 		esd = gf_isom_get_esd(file, sceneT, 1);
+	/* ensure esd and decoderConfig present before use */
+	if (!esd || !esd->decoderConfig) {
+		is_ok = 0;
+		if (esd) { gf_odf_desc_del((GF_Descriptor *) esd); esd = NULL; }
+	} else {
+
+	/* validate ESD and decoderConfig before any dereference */
+	if (!esd || !esd->decoderConfig) {
+		if (esd) { GF_LOG(GF_LOG_WARNING, GF_LOG_RTP, ("[rtp hinter] Scene ESD missing or has no decoderConfig - ISMA disabled\n")); gf_odf_desc_del((GF_Descriptor *) esd); esd = NULL; }
+		is_ok = 0;
+	} else {
 		if (gf_isom_get_sample_count(file, sceneT)==1) {
 			samp = gf_isom_get_sample(file, sceneT, 1, &descIndex);
 			if (gf_hinter_can_embbed_data(samp->data, samp->dataLength, GF_STREAM_SCENE)) {
@@ -1260,7 +1285,10 @@ GF_Err gf_hinter_finalize(GF_ISOFile *file, GF_SDP_IODProfile IOD_Profile, u32 b
 		if (remove_ocr) esd->OCRESID = 0;
 		else if (esd->OCRESID == esd->ESID) esd->OCRESID = 0;
 
-		gf_list_add(iod->ESDescriptors, esd);
+		
+	}	}
+
+	if (esd) gf_list_add(iod->ESDescriptors, esd);
 
 		if (is_ok) {
 			u32 has_a, has_v, has_i_a, has_i_v;
@@ -1268,6 +1296,7 @@ GF_Err gf_hinter_finalize(GF_ISOFile *file, GF_SDP_IODProfile IOD_Profile, u32 b
 			for (i=0; i<gf_isom_get_track_count(file); i++) {
 				esd = gf_isom_get_esd(file, i+1, 1);
 				if (!esd) continue;
+					if (!esd->decoderConfig) { gf_odf_desc_del((GF_Descriptor *)esd); continue; }
 				if (esd->decoderConfig->streamType==GF_STREAM_VISUAL) {
 					if (esd->decoderConfig->objectTypeIndication==GF_CODECID_MPEG4_PART2) has_i_v ++;
 					else has_v++;