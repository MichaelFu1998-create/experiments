diff --git a/ext/date/php_date.c b/ext/date/php_date.c
index c64ef6afe11..f8854f67f04 100644
--- a/ext/date/php_date.c
+++ b/ext/date/php_date.c
@@ -2323,21 +2323,54 @@ PHPAPI bool php_date_initialize(php_date_obj *dateobj, const char *time_str, siz
 		dateobj->time = timelib_strtotime(time_str, time_str_len, &err, DATE_TIMEZONEDB, php_date_parse_tzfile_wrapper);
 	}
 
-	/* update last errors and warnings */
+	/* Copy any error info we need before update_errors_warnings() may free the
+	 * timelib_error_container. update_errors_warnings() takes ownership of the
+	 * pointer in some cases and may free it, so accessing 'err' after that
+	 * call can lead to a use-after-free. Copy the minimal data required for
+	 * throwing exceptions or cleanup below. */
+	int err_error_count = 0;
+	int err_position = 0;
+	char err_character = 0;
+	char *err_message = NULL;
+
+	if (err) {
+		err_error_count = err->error_count;
+		if (err_error_count) {
+			err_position = err->error_messages[0].position;
+			err_character = err->error_messages[0].character;
+			if (err->error_messages[0].message) {
+				/* duplicate the message so it remains valid after the free */
+				err_message = strdup(err->error_messages[0].message);
+			}
+		}
+	}
+
+	/* update last errors and warnings (may free 'err') */
 	update_errors_warnings(err);
 
-	/* If called from a constructor throw an exception */
-	if ((flags & PHP_DATE_INIT_CTOR) && err && err->error_count) {
-		/* spit out the first library error message, at least */
+	/* If called from a constructor throw an exception using the copied data */
+	if ((flags & PHP_DATE_INIT_CTOR) && err_error_count) {
 		zend_throw_exception_ex(NULL, 0, "Failed to parse time string (%s) at position %d (%c): %s", time_str,
-			err->error_messages[0].position, err->error_messages[0].character, err->error_messages[0].message);
+			err_position, err_character, err_message ? err_message : "");
 	}
-	if (err && err->error_count) {
-		timelib_time_dtor(dateobj->time);
-		dateobj->time = 0;
+
+	if (err_error_count) {
+		if (dateobj->time) {
+			timelib_time_dtor(dateobj->time);
+			dateobj->time = 0;
+		}
+		if (err_message) {
+			free(err_message);
+			err_message = NULL;
+		}
 		return 0;
 	}
 
+	if (err_message) {
+		free(err_message);
+		err_message = NULL;
+	}
+
 	if (timezone_object) {
 		php_timezone_obj *tzobj;