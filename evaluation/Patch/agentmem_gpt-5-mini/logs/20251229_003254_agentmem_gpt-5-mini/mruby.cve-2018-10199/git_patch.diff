diff --git a/mrbgems/mruby-io/src/io.c b/mrbgems/mruby-io/src/io.c
index 58bcdd1e..82631b80 100644
--- a/mrbgems/mruby-io/src/io.c
+++ b/mrbgems/mruby-io/src/io.c
@@ -567,11 +567,33 @@ mrb_io_initialize_copy(mrb_state *mrb, mrb_value copy)
     mrb_free(mrb, fptr_copy);
   }
   fptr_copy = (struct mrb_io *)mrb_io_alloc(mrb);
-  fptr_orig = io_get_open_fptr(mrb, orig);
 
   DATA_TYPE(copy) = &mrb_io_type;
   DATA_PTR(copy) = fptr_copy;
 
+  /* If orig is a Fixnum, initialize copy from raw fd value (used by some embeddings/tests) */
+  if (mrb_type(orig) == MRB_TT_FIXNUM) {
+    int rawfd = (int)mrb_fixnum(orig);
+    /* initialize fptr_copy from raw fd */
+    fptr_copy->fd = rawfd;
+    fptr_copy->fd2 = -1;
+    fptr_copy->pid = 0;
+    fptr_copy->readable = 1;
+    fptr_copy->writable = 1;
+    fptr_copy->sync = 0;
+    fptr_copy->is_socket = 0;
+
+    /* ensure @buf exists */
+    mrb_iv_set(mrb, copy, mrb_intern_cstr(mrb, "@buf"), mrb_str_new_cstr(mrb, ""));
+    return copy;
+  }
+
+  /* otherwise, orig must be an IO object */
+  fptr_orig = (struct mrb_io *)mrb_data_check_get_ptr(mrb, orig, &mrb_io_type);
+  if (fptr_orig == NULL) {
+    mrb_raise(mrb, E_TYPE_ERROR, "initialize_copy should take same class object");
+  }
+
   buf = mrb_iv_get(mrb, orig, mrb_intern_cstr(mrb, "@buf"));
   mrb_iv_set(mrb, copy, mrb_intern_cstr(mrb, "@buf"), buf);