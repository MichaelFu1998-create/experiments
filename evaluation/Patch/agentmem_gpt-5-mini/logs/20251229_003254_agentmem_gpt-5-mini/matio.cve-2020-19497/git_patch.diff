diff --git a/src/mat5.c b/src/mat5.c
index abdb351..3f380be 100644
--- a/src/mat5.c
+++ b/src/mat5.c
@@ -4874,6 +4874,27 @@ Mat_VarReadNextInfo5( mat_t *mat )
                         len_pad = len;
                     else
                         len_pad = len + 8 - (len % 8);
+            /* Validate name length to prevent integer overflow and excessive allocation */
+            {
+                size_t tmp_len = (size_t)len;
+                const size_t MATIO_MAX_NAME = 1024*1024; /* 1MB cap */
+                size_t safe_len_pad;
+                if ( tmp_len > MATIO_MAX_NAME ) {
+                    Mat_VarFree(matvar);
+                    matvar = NULL;
+                    break;
+                }
+                if ( tmp_len % 8 == 0 )
+                    safe_len_pad = tmp_len;
+                else
+                    safe_len_pad = tmp_len + 8 - (tmp_len % 8);
+                if ( safe_len_pad + 1 < safe_len_pad || safe_len_pad + 1 > MATIO_MAX_NAME + 1 ) {
+                    Mat_VarFree(matvar);
+                    matvar = NULL;
+                    break;
+                }
+                len_pad = (mat_uint32_t)safe_len_pad;
+            }
                     matvar->name = (char*)malloc(len_pad + 1);
                     if ( NULL != matvar->name ) {
                         /* Variable name */
@@ -4976,6 +4997,29 @@ Mat_VarReadNextInfo5( mat_t *mat )
                     len_pad = len;
                 else
                     len_pad = len + 8 - (len % 8);
+            /* Validate name length to prevent integer overflow and excessive allocation */
+            {
+                size_t tmp_len = (size_t)len;
+                const size_t MATIO_MAX_NAME = 1024*1024; /* 1MB cap */
+                size_t safe_len_pad;
+                if ( tmp_len > MATIO_MAX_NAME ) {
+                    Mat_VarFree(matvar);
+                    matvar = NULL;
+                    (void)fseek((FILE*)mat->fp, fpos, SEEK_SET);
+                    break;
+                }
+                if ( tmp_len % 8 == 0 )
+                    safe_len_pad = tmp_len;
+                else
+                    safe_len_pad = tmp_len + 8 - (tmp_len % 8);
+                if ( safe_len_pad + 1 < safe_len_pad || safe_len_pad + 1 > MATIO_MAX_NAME + 1 ) {
+                    Mat_VarFree(matvar);
+                    matvar = NULL;
+                    (void)fseek((FILE*)mat->fp, fpos, SEEK_SET);
+                    break;
+                }
+                len_pad = (mat_uint32_t)safe_len_pad;
+            }
                 matvar->name = (char*)malloc(len_pad + 1);
                 if ( NULL != matvar->name ) {
                     readresult = fread(matvar->name, 1, len_pad, (FILE*)mat->fp);