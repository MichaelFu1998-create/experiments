diff --git a/src/filters/reframe_mpgvid.c b/src/filters/reframe_mpgvid.c
index 328db2855..7e95a094c 100644
--- a/src/filters/reframe_mpgvid.c
+++ b/src/filters/reframe_mpgvid.c
@@ -582,8 +582,11 @@ GF_Err mpgviddmx_process(GF_Filter *filter)
 		if (ctx->hdr_store_alloc < ctx->hdr_store_size + pck_size) {
 			ctx->hdr_store_alloc = ctx->hdr_store_size + pck_size;
 			ctx->hdr_store = gf_realloc(ctx->hdr_store, sizeof(char)*ctx->hdr_store_alloc);
+			if (!ctx->hdr_store) return GF_OUT_OF_MEM;
+		}
+		if (pck_size > 0) {
+			memcpy(ctx->hdr_store + ctx->hdr_store_size, data, sizeof(char)*pck_size);
 		}
-		memcpy(ctx->hdr_store + ctx->hdr_store_size, data, sizeof(char)*pck_size);
 		if (byte_offset != GF_FILTER_NO_BO) {
 			if (byte_offset >= ctx->hdr_store_size)
 				byte_offset -= ctx->hdr_store_size;
@@ -622,7 +625,7 @@ GF_Err mpgviddmx_process(GF_Filter *filter)
 	}
 
 
-	while (remain) {
+	while (remain > 0) {
 		Bool full_frame;
 		u8 *pck_data;
 		s32 current;
@@ -650,7 +653,17 @@ GF_Err mpgviddmx_process(GF_Filter *filter)
 		//if not, dispatch these bytes as continuation of the data
 		if (ctx->bytes_in_header) {
 
-			memcpy(ctx->hdr_store + ctx->bytes_in_header, start, 8 - ctx->bytes_in_header);
+			{
+	int _copy_len = 8 - ctx->bytes_in_header;
+	if (_copy_len > 0) {
+		if (ctx->hdr_store_alloc < ctx->bytes_in_header + (u32)_copy_len) {
+			ctx->hdr_store_alloc = ctx->bytes_in_header + (u32)_copy_len;
+			ctx->hdr_store = gf_realloc(ctx->hdr_store, sizeof(char)*ctx->hdr_store_alloc);
+			if (!ctx->hdr_store) return GF_OUT_OF_MEM;
+		}
+		memcpy(ctx->hdr_store + ctx->bytes_in_header, start, (size_t)_copy_len);
+	}
+}
 			current = mpgviddmx_next_start_code(ctx->hdr_store, 8);
 
 			//no start code in stored buffer
@@ -717,7 +730,7 @@ GF_Err mpgviddmx_process(GF_Filter *filter)
 				if (!dst_pck) return GF_OUT_OF_MEM;
 
 				if (ctx->src_pck) gf_filter_pck_merge_properties(ctx->src_pck, dst_pck);
-				memcpy(pck_data, start, (size_t) size);
+				if (size > 0) memcpy(pck_data, start, (size_t) size);
 				gf_filter_pck_set_framing(dst_pck, GF_FALSE, GF_FALSE);
 				gf_filter_pck_set_cts(dst_pck, GF_FILTER_NO_TS);
 				gf_filter_pck_set_dts(dst_pck, GF_FILTER_NO_TS);
@@ -728,7 +741,15 @@ GF_Err mpgviddmx_process(GF_Filter *filter)
 
 				mpgviddmx_enqueue_or_dispatch(ctx, dst_pck, GF_FALSE, GF_FALSE);
 				if (copy_last_bytes) {
-					memcpy(ctx->hdr_store, start+remain-3, 3);
+					if (remain >= 3) {
+	if (ctx->hdr_store_alloc < 3) {
+		ctx->hdr_store_alloc = 3;
+		ctx->hdr_store = gf_realloc(ctx->hdr_store, sizeof(char)*ctx->hdr_store_alloc);
+		if (!ctx->hdr_store) return GF_OUT_OF_MEM;
+	}
+	memcpy(ctx->hdr_store, start+remain-3, 3);
+}
+
 				}
 				break;
 			}
@@ -806,15 +827,34 @@ GF_Err mpgviddmx_process(GF_Filter *filter)
 				if (e==GF_EOS) {
 					if (vosh_start<0) vosh_start = 0;
 					if (data == ctx->hdr_store) {
-						memmove(ctx->hdr_store, start, remain);
+						if (remain > 0) {
+	if (ctx->hdr_store_alloc < (u32)remain) {
+		ctx->hdr_store_alloc = (u32)remain;
+		ctx->hdr_store = gf_realloc(ctx->hdr_store, sizeof(char)*ctx->hdr_store_alloc);
+		if (!ctx->hdr_store) return GF_OUT_OF_MEM;
+	}
+	memmove(ctx->hdr_store, start, (size_t)remain);
+}
+
 						ctx->hdr_store_size = remain;
 					} else {
 						if (ctx->hdr_store_alloc < ctx->hdr_store_size + pck_size - vosh_start) {
 							ctx->hdr_store_alloc = (u32) (ctx->hdr_store_size + pck_size - vosh_start);
 							ctx->hdr_store = gf_realloc(ctx->hdr_store, sizeof(char)*ctx->hdr_store_alloc);
 						}
-						memcpy(ctx->hdr_store + ctx->hdr_store_size, data + vosh_start, (size_t) (pck_size - vosh_start) );
-						ctx->hdr_store_size += pck_size - (u32) vosh_start;
+						{
+    s32 _copy_len = (s32)pck_size - (s32)vosh_start;
+    if (_copy_len > 0) {
+        if (ctx->hdr_store_alloc < ctx->hdr_store_size + (u32)_copy_len) {
+            ctx->hdr_store_alloc = ctx->hdr_store_size + (u32)_copy_len;
+            ctx->hdr_store = gf_realloc(ctx->hdr_store, sizeof(char)*ctx->hdr_store_alloc);
+            if (!ctx->hdr_store) return GF_OUT_OF_MEM;
+        }
+        memcpy(ctx->hdr_store + ctx->hdr_store_size, data + (u32)vosh_start, (size_t)_copy_len );
+        ctx->hdr_store_size += (u32)_copy_len;
+    }
+}
+
 					}
 					gf_filter_pid_drop_packet(ctx->ipid);
 					return GF_OK;
@@ -850,15 +890,34 @@ GF_Err mpgviddmx_process(GF_Filter *filter)
 				if (e==GF_EOS) {
 					if (vosh_start<0) vosh_start = 0;
 					if (data == ctx->hdr_store) {
-						memmove(ctx->hdr_store, start, remain);
+						if (remain > 0) {
+	if (ctx->hdr_store_alloc < (u32)remain) {
+		ctx->hdr_store_alloc = (u32)remain;
+		ctx->hdr_store = gf_realloc(ctx->hdr_store, sizeof(char)*ctx->hdr_store_alloc);
+		if (!ctx->hdr_store) return GF_OUT_OF_MEM;
+	}
+	memmove(ctx->hdr_store, start, (size_t)remain);
+}
+
 						ctx->hdr_store_size = remain;
 					} else {
 						if (ctx->hdr_store_alloc < ctx->hdr_store_size + pck_size - vosh_start) {
 							ctx->hdr_store_alloc = (u32) (ctx->hdr_store_size + pck_size - (u32) vosh_start);
 							ctx->hdr_store = gf_realloc(ctx->hdr_store, sizeof(char)*ctx->hdr_store_alloc);
 						}
-						memcpy(ctx->hdr_store + ctx->hdr_store_size, data + vosh_start, (size_t) (pck_size - vosh_start) );
-						ctx->hdr_store_size += pck_size - (u32) vosh_start;
+						{
+    s32 _copy_len = (s32)pck_size - (s32)vosh_start;
+    if (_copy_len > 0) {
+        if (ctx->hdr_store_alloc < ctx->hdr_store_size + (u32)_copy_len) {
+            ctx->hdr_store_alloc = ctx->hdr_store_size + (u32)_copy_len;
+            ctx->hdr_store = gf_realloc(ctx->hdr_store, sizeof(char)*ctx->hdr_store_alloc);
+            if (!ctx->hdr_store) return GF_OUT_OF_MEM;
+        }
+        memcpy(ctx->hdr_store + ctx->hdr_store_size, data + (u32)vosh_start, (size_t)_copy_len );
+        ctx->hdr_store_size += (u32)_copy_len;
+    }
+}
+
 					}
 					gf_filter_pid_drop_packet(ctx->ipid);
 					return GF_OK;
@@ -1003,10 +1062,10 @@ GF_Err mpgviddmx_process(GF_Filter *filter)
 			if (byte_offset != GF_FILTER_NO_BO) {
 				gf_filter_pck_set_byte_offset(dst_pck, byte_offset - bytes_from_store);
 			}
-			memcpy(pck_data + bytes_from_store, start, (size_t) size);
+			if (size > 0) memcpy(pck_data + bytes_from_store, start, (size_t) size);
 		} else {
 			//bytes only come the data packet
-			memcpy(pck_data, start, (size_t) size);
+			if (size > 0) memcpy(pck_data, start, (size_t) size);
 			if (byte_offset != GF_FILTER_NO_BO) {
 				gf_filter_pck_set_byte_offset(dst_pck, byte_offset + start - (u8 *) data);
 			}
@@ -1035,7 +1094,15 @@ GF_Err mpgviddmx_process(GF_Filter *filter)
 
 		if (!full_frame) {
 			if (copy_last_bytes) {
-				memcpy(ctx->hdr_store, start+remain-3, 3);
+				if (remain >= 3) {
+	if (ctx->hdr_store_alloc < 3) {
+		ctx->hdr_store_alloc = 3;
+		ctx->hdr_store = gf_realloc(ctx->hdr_store, sizeof(char)*ctx->hdr_store_alloc);
+		if (!ctx->hdr_store) return GF_OUT_OF_MEM;
+	}
+	memcpy(ctx->hdr_store, start+remain-3, 3);
+}
+
 			}
 			break;
 		}