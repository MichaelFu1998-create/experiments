diff --git a/src/class.c b/src/class.c
index 37fc4e68a..15d340371 100644
--- a/src/class.c
+++ b/src/class.c
@@ -934,6 +934,9 @@ mrb_get_args(mrb_state *mrb, const char *format, ...)
   int i = 0;
   va_list ap;
   mrb_callinfo *ci = mrb->c->ci;
+  if (ci == NULL || ci->stack == NULL) {
+    mrb_raise(mrb, E_RUNTIME_ERROR, "internal: invalid callinfo/stack");
+  }
   int argc = ci->n;
   const mrb_value *argv = ci->stack+1;
   mrb_bool argv_on_stack;
@@ -1005,6 +1008,11 @@ mrb_get_args(mrb_state *mrb, const char *format, ...)
 
   argv_on_stack = argc < 15;
   if (!argv_on_stack) {
+    /* defensive check: ensure argv[0] is an Array before dereferencing
+       to avoid out-of-bounds/NULL dereference when argv is unexpected. */
+    if (!mrb_array_p(*argv)) {
+      mrb_raise(mrb, E_TYPE_ERROR, "internal: expected Array for argv");
+    }
     struct RArray *a = mrb_ary_ptr(*argv);
     argv = ARY_PTR(a);
     argc = ARY_LEN(a);