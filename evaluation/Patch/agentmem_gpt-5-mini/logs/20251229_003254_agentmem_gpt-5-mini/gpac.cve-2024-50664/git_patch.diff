diff --git a/src/isomedia/sample_descs.c b/src/isomedia/sample_descs.c
index 8c1807518..27e3ceb0b 100644
--- a/src/isomedia/sample_descs.c
+++ b/src/isomedia/sample_descs.c
@@ -1792,11 +1792,23 @@ GF_Err gf_isom_new_mpha_description(GF_ISOFile *movie, u32 trackNumber, const ch
 		mpa->cfg_mha->mha_pl_indication = dsi[1];
 		mpa->cfg_mha->reference_channel_layout = dsi[2];
 		mpa->cfg_mha->mha_config_size = dsi[3];
-		mpa->cfg_mha->mha_config_size <<= 8;
-		mpa->cfg_mha->mha_config_size |= dsi[4];
-		mpa->cfg_mha->mha_config = gf_malloc(sizeof(u8) * mpa->cfg_mha->mha_config_size);
-		if (!mpa->cfg_mha->mha_config) return GF_OUT_OF_MEM;
-		memcpy(mpa->cfg_mha->mha_config, dsi+5, dsi_size-5);
+			mpa->cfg_mha->mha_config_size <<= 8;
+			mpa->cfg_mha->mha_config_size |= dsi[4];
+			/* Validate declared mha_config_size fits within provided DSI payload */
+			{
+				u32 declared_size = mpa->cfg_mha->mha_config_size;
+				u32 avail = (dsi_size > 5) ? (dsi_size - 5) : 0;
+				if (declared_size > avail) return GF_BAD_PARAM;
+				if (declared_size) {
+					mpa->cfg_mha->mha_config = gf_malloc(sizeof(u8) * declared_size);
+					if (!mpa->cfg_mha->mha_config) return GF_OUT_OF_MEM;
+					memcpy(mpa->cfg_mha->mha_config, dsi+5, declared_size);
+				} else {
+					mpa->cfg_mha->mha_config = NULL;
+				}
+				mpa->cfg_mha->mha_config_size = declared_size;
+			}
+
 	}
 	return GF_OK;
 }