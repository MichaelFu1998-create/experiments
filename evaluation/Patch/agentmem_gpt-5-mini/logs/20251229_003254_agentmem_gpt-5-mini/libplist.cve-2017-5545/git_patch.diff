diff --git a/tools/plistutil.c b/tools/plistutil.c
index 6451604..80d3ad1 100644
--- a/tools/plistutil.c
+++ b/tools/plistutil.c
@@ -128,13 +128,36 @@ int main(int argc, char *argv[])
         return 1;
     }
 
-    stat(options->in_file, &filestats);
-    plist_entire = (char *) malloc(sizeof(char) * (filestats.st_size + 1));
-    read_size = fread(plist_entire, sizeof(char), filestats.st_size, iplist);
+    if (stat(options->in_file, &filestats) != 0 || filestats.st_size <= 0) {
+        /* stat failed or file empty/invalid */
+        fclose(iplist);
+        free(options);
+        printf("ERROR: Failed to stat input file or file is empty.\n");
+        return 1;
+    }
+
+    /* allocate buffer using the size reported by stat; check allocation */
+    plist_entire = (char *) malloc((size_t)filestats.st_size + 1);
+    if (!plist_entire) {
+        fclose(iplist);
+        free(options);
+        printf("ERROR: Memory allocation failed.\n");
+        return 1;
+    }
+
+    /* read actual bytes and use read_size for subsequent bounds checks */
+    read_size = (int)fread(plist_entire, 1, (size_t)filestats.st_size, iplist);
     fclose(iplist);
 
-    // convert from binary to xml or vice-versa
-    if (memcmp(plist_entire, "bplist00", 8) == 0)
+    if (read_size < 0) /* fread returns size_t, but keep defensive check */
+        read_size = 0;
+
+    /* null-terminate to be safe for string operations */
+    plist_entire[read_size] = '\0';
+
+    /* convert from binary to xml or vice-versa
+       Only inspect the buffer header if we actually read at least 8 bytes. */
+    if (read_size >= 8 && memcmp(plist_entire, "bplist00", 8) == 0)
     {
         plist_from_bin(plist_entire, read_size, &root_node);
         plist_to_xml(root_node, &plist_out, &size);