diff --git a/src/njs_function.c b/src/njs_function.c
index c221573..5078a9a 100644
--- a/src/njs_function.c
+++ b/src/njs_function.c
@@ -505,6 +505,12 @@ njs_function_call2(njs_vm_t *vm, njs_function_t *function,
 {
     njs_int_t  ret;
 
+    /* Defensive check: ensure the function pointer is valid. */
+    if (njs_slow_path(function == NULL || (uintptr_t) function < 0x1000)) {
+        return NJS_ERROR;
+    }
+
+
     ret = njs_function_frame(vm, function, this, args, nargs, ctor);
     if (njs_slow_path(ret != NJS_OK)) {
         return ret;
diff --git a/src/njs_function.h b/src/njs_function.h
index c6299cd..c9cf0bd 100644
--- a/src/njs_function.h
+++ b/src/njs_function.h
@@ -1,4 +1,3 @@
-
 /*
  * Copyright (C) Igor Sysoev
  * Copyright (C) NGINX, Inc.
@@ -152,6 +151,11 @@ njs_function_frame(njs_vm_t *vm, njs_function_t *function,
     const njs_value_t *this, const njs_value_t *args, njs_uint_t nargs,
     njs_bool_t ctor)
 {
+    if (njs_slow_path(function == NULL || (uintptr_t) function < 0x1000)) {
+    return NJS_ERROR;
+}
+
+
     if (function->native) {
         return njs_function_native_frame(vm, function, this, args, nargs, ctor);
 
diff --git a/src/njs_object_prop.c b/src/njs_object_prop.c
index 6bf1c28..4e42c9a 100644
--- a/src/njs_object_prop.c
+++ b/src/njs_object_prop.c
@@ -128,7 +128,7 @@ found:
         return NJS_OK;
     }
 
-    if (njs_prop_getter(prop) == NULL) {
+    if (njs_prop_getter(prop) == NULL || njs_prop_getter(prop) == NJS_PROP_PTR_UNSET) {
         njs_set_undefined(retval);
         return NJS_OK;
     }
diff --git a/src/njs_value.c b/src/njs_value.c
index 296f057..4d5ee10 100644
--- a/src/njs_value.c
+++ b/src/njs_value.c
@@ -1130,7 +1130,7 @@ slow_path:
                 break;
             }
 
-            if (njs_prop_getter(prop) == NULL) {
+            if (njs_prop_getter(prop) == NULL || njs_prop_getter(prop) == NJS_PROP_PTR_UNSET) {
                 njs_set_undefined(retval);
                 break;
             }
@@ -1465,7 +1465,7 @@ slow_path:
             break;
         }
 
-        if (njs_prop_getter(prop) == NULL) {
+        if (njs_prop_getter(prop) == NULL || njs_prop_getter(prop) == NJS_PROP_PTR_UNSET) {
             njs_set_undefined(removed);
             break;
         }