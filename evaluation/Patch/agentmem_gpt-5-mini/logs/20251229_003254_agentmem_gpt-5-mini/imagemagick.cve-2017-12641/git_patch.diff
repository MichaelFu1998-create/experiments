diff --git a/coders/png.c b/coders/png.c
index dc8be5220..99efdcd31 100644
--- a/coders/png.c
+++ b/coders/png.c
@@ -4306,6 +4306,8 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
 
   size_t
     length;
+  unsigned char *chunk = (unsigned char *) NULL;
+
 
   jng_alpha_compression_method=0;
   jng_alpha_sample_depth=8;
@@ -4346,14 +4348,14 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
 
   read_JSEP=MagickFalse;
   reading_idat=MagickFalse;
+#define JNG_CLEAN_THROW(code,reason)   do {     if (chunk != (unsigned char *) NULL) chunk=(unsigned char *) RelinquishMagickMemory(chunk);     if (alpha_image != (Image *) NULL) alpha_image=DestroyImage(alpha_image);     if (color_image != (Image *) NULL) color_image=DestroyImage(color_image);     if (alpha_image_info != (ImageInfo *) NULL) alpha_image_info=DestroyImageInfo(alpha_image_info);     if (color_image_info != (ImageInfo *) NULL) color_image_info=DestroyImageInfo(color_image_info);     ThrowReaderException(code, reason);   } while (0)
+
+
   for (;;)
   {
     char
       type[MagickPathExtent];
 
-    unsigned char
-      *chunk;
-
     unsigned int
       count;
 
@@ -4377,7 +4379,7 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
         type[0],type[1],type[2],type[3],(double) length);
 
     if (length > PNG_UINT_31_MAX || count == 0)
-      ThrowReaderException(CorruptImageError,"CorruptImage");
+      JNG_CLEAN_THROW(CorruptImageError,"CorruptImage");
 
     p=NULL;
     chunk=(unsigned char *) NULL;
@@ -4385,12 +4387,12 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
     if (length != 0)
       {
         if (length > GetBlobSize(image))
-          ThrowReaderException(CorruptImageError,"InsufficientImageDataInFile");
+          JNG_CLEAN_THROW(CorruptImageError,"InsufficientImageDataInFile");
         chunk=(unsigned char *) AcquireQuantumMemory(length+MagickPathExtent,
           sizeof(*chunk));
 
         if (chunk == (unsigned char *) NULL)
-          ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
+          JNG_CLEAN_THROW(ResourceLimitError,"MemoryAllocationFailed");
 
         for (i=0; i < (ssize_t) length; i++)
         {
@@ -4417,7 +4419,7 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
             jng_height=(size_t) ((p[4] << 24) | (p[5] << 16) |
               (p[6] << 8) | p[7]);
             if ((jng_width == 0) || (jng_height == 0))
-              ThrowReaderException(CorruptImageError,
+              JNG_CLEAN_THROW(CorruptImageError,
                 "NegativeOrZeroImageSize");
             jng_color_type=p[8];
             jng_image_sample_depth=p[9];
@@ -4479,13 +4481,13 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
         color_image_info=(ImageInfo *)AcquireMagickMemory(sizeof(ImageInfo));
 
         if (color_image_info == (ImageInfo *) NULL)
-          ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
+          JNG_CLEAN_THROW(ResourceLimitError,"MemoryAllocationFailed");
 
         GetImageInfo(color_image_info);
         color_image=AcquireImage(color_image_info,exception);
 
         if (color_image == (Image *) NULL)
-          ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
+          JNG_CLEAN_THROW(ResourceLimitError,"MemoryAllocationFailed");
 
         if (logging != MagickFalse)
           (void) LogMagickEvent(CoderEvent,GetMagickModule(),
@@ -4509,7 +4511,7 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
             if (alpha_image_info == (ImageInfo *) NULL)
               {
                 color_image=DestroyImage(color_image);
-                ThrowReaderException(ResourceLimitError,
+                JNG_CLEAN_THROW(ResourceLimitError,
                   "MemoryAllocationFailed");
               }
 
@@ -4520,7 +4522,7 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
               {
                 alpha_image_info=DestroyImageInfo(alpha_image_info);
                 color_image=DestroyImage(color_image);
-                ThrowReaderException(ResourceLimitError,
+                JNG_CLEAN_THROW(ResourceLimitError,
                   "MemoryAllocationFailed");
               }
 
@@ -4956,6 +4958,8 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
 
   return(image);
 }
+#undef JNG_CLEAN_THROW
+
 
 /*
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%