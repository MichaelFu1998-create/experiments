diff --git a/libqpdf/Pl_ASCII85Decoder.cc b/libqpdf/Pl_ASCII85Decoder.cc
index b8df3e87..2691c6a9 100644
--- a/libqpdf/Pl_ASCII85Decoder.cc
+++ b/libqpdf/Pl_ASCII85Decoder.cc
@@ -119,10 +119,14 @@ Pl_ASCII85Decoder::flush()
 
     QTC::TC("libtests", "Pl_ASCII85Decoder partial flush",
 	    (this->pos == 5) ? 0 : 1);
-    getNext()->write(outbuf, this->pos - 1);
-
+    /* Defensive change: capture output length and reset internal state before calling downstream write. */
+    unsigned long outlen = (this->pos > 0) ? (this->pos - 1) : 0;
     this->pos = 0;
     memset(this->inbuf, 117, 5);
+    if (outlen > 0)
+    {
+        getNext()->write(outbuf, outlen);
+    }
 }
 
 void