diff --git a/src/jp2image.cpp b/src/jp2image.cpp
index 07afef0a..8ca3e583 100644
--- a/src/jp2image.cpp
+++ b/src/jp2image.cpp
@@ -505,10 +505,31 @@ namespace Exiv2
 
                             // subBox.length makes no sense if it is larger than the rest of the file
                             if (subBox.length > io_->size() - io_->tell()) {
-                                throw Error(kerCorruptedMetadata);
+                                // Corrupted sub-box length; skip remaining sub-boxes in this container
+                                lf(out,bLF);
+                                break;
                             }
-                            DataBuf data(subBox.length-sizeof(box));
-                            io_->read(data.pData_,data.size_);
+                            if (subBox.length < static_cast<uint32_t>(sizeof(subBox))) {
+                                // Corrupted sub-box length; skip it
+                                lf(out,bLF);
+                                break;
+                            }
+                            size_t payload = static_cast<size_t>(subBox.length - sizeof(subBox));
+                            const size_t kMaxDataBufSize = 100 * 1024 * 1024; /* 100MB */
+                            if (payload > kMaxDataBufSize) {
+                                // Too large to allocate; skip payload safely
+                                io_->seek(static_cast<long>(payload), Exiv2::BasicIo::cur);
+                                if (io_->error()) throw Error(kerFailedToReadImageData);
+                                if (bPrint) {
+                                    out << Internal::stringFormat("%8ld | %8ld |  sub:",(size_t)address,(size_t)subBox.length)
+                                        << toAscii(subBox.type)
+                                        << " | " << "<payload too large to display>";
+                                    bLF = true;
+                                }
+                                continue;
+                            }
+                            DataBuf data(static_cast<long>(payload));
+                            io_->read(data.pData_, data.size_);
                             if ( bPrint ) {
                                 out << Internal::stringFormat("%8ld | %8ld |  sub:",(size_t)address,(size_t)subBox.length)
                                     << toAscii(subBox.type)
diff --git a/src/types.cpp b/src/types.cpp
index 17ab051e..06640dfe 100644
--- a/src/types.cpp
+++ b/src/types.cpp
@@ -138,13 +138,28 @@ namespace Exiv2 {
     DataBuf::DataBuf() : pData_(0), size_(0)
     {}
 
-    DataBuf::DataBuf(long size) : pData_(new byte[size]()), size_(size)
-    {}
+    DataBuf::DataBuf(long size) : pData_(0), size_(0)
+    {
+        const long kMaxDataBufSize = 100 * 1024 * 1024; // 100MB
+        if (size <= 0) {
+            // Do not allocate for non-positive sizes
+            return;
+        }
+        if (size > kMaxDataBufSize) {
+            throw std::length_error("DataBuf allocation size too large");
+        }
+        pData_ = new byte[size]();
+        size_ = size;
+    }
 
     DataBuf::DataBuf(const byte* pData, long size)
         : pData_(0), size_(0)
     {
         if (size > 0) {
+            const long kMaxDataBufSize = 100 * 1024 * 1024; // 100MB
+            if (size > kMaxDataBufSize) {
+                throw std::length_error("DataBuf allocation size too large");
+            }
             pData_ = new byte[size];
             std::memcpy(pData_, pData, size);
             size_ = size;
@@ -160,7 +175,12 @@ namespace Exiv2 {
 
     void DataBuf::alloc(long size)
     {
+        const long kMaxDataBufSize = 100 * 1024 * 1024; // 100MB
         if (size > size_) {
+            if (size <= 0) return;
+            if (size > kMaxDataBufSize) {
+                throw std::length_error("DataBuf allocation size too large");
+            }
             delete[] pData_;
             pData_ = 0;
             size_ = 0;