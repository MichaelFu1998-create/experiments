diff --git a/src/xls.c b/src/xls.c
index fcbcacc..3a30098 100644
--- a/src/xls.c
+++ b/src/xls.c
@@ -853,7 +853,7 @@ xls_error_t xls_parseWorkBook(xlsWorkBook* pWB)
  		if(xls_debug) xls_showBOF(&bof1);
 
         if (bof1.size) {
-            if ((buf = realloc(buf, bof1.size)) == NULL) {
+            if ((buf = realloc(buf, bof1.size + 1)) == NULL) {
                 if (xls_debug) fprintf(stderr, "Error: failed to allocate buffer of size %d\n", (int)bof1.size);
                 retval = LIBXLS_ERROR_MALLOC;
                 goto cleanup;
@@ -863,6 +863,7 @@ xls_error_t xls_parseWorkBook(xlsWorkBook* pWB)
                 retval = LIBXLS_ERROR_READ;
                 goto  cleanup;
             }
+            buf[bof1.size] = 0;
         }
 
         if (xls_isRecordTooSmall(pWB, &bof1)) {
@@ -1008,14 +1009,26 @@ xls_error_t xls_parseWorkBook(xlsWorkBook* pWB)
 				struct { unsigned short idx; unsigned char ident; unsigned char lvl; } *styl;
 				styl = (void *)buf;
 
-				printf("    idx: 0x%x\n", styl->idx & 0x07FF);
-				if(styl->idx & 0x8000) {
-					printf("  ident: 0x%x\n", styl->ident);
-					printf("  level: 0x%x\n", styl->lvl);
+				if (bof1.size >= sizeof(styl->idx)) {
+					printf("    idx: 0x%x\n", styl->idx & 0x07FF);
+					if(styl->idx & 0x8000) {
+						printf("  ident: 0x%x\n", styl->ident);
+						printf("  level: 0x%x\n", styl->lvl);
+					} else {
+						if (bof1.size > 2) {
+							char *s = get_string((char *)&buf[2], bof1.size - 2, 1, pWB);
+							if (s) {
+								printf("  name=%s\n", s);
+								free(s);
+							} else {
+								printf("  name=(null)\n");
+							}
+						} else {
+							printf("  name=(truncated)\n");
+						}
+					}
 				} else {
-					char *s = get_string((char *)&buf[2], bof1.size - 2, 1, pWB);
-					printf("  name=%s\n", s);
-                    free(s);
+					printf("  name=(truncated)\n");
 				}
 			}
 			break;