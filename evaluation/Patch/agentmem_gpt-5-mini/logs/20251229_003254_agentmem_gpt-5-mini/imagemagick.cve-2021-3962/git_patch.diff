diff --git a/coders/dcm.c b/coders/dcm.c
index edc09e9f4..325c5460c 100644
--- a/coders/dcm.c
+++ b/coders/dcm.c
@@ -3036,11 +3036,17 @@ static inline void RelinquishDCMMemory(DCMInfo *info,DCMMap *map,
     map->green=(int *) RelinquishMagickMemory(map->green);
   if (map->red != (int *) NULL)
     map->red=(int *) RelinquishMagickMemory(map->red);
-  if (stream_info->offsets != (ssize_t *) NULL)
-    stream_info->offsets=(ssize_t *) RelinquishMagickMemory(
-      stream_info->offsets);
+  /* Ensure stream_info is valid before accessing its members. Accessing
+     stream_info->offsets when stream_info is NULL can cause a
+     use-after-free or null-dereference; check the pointer first. */
   if (stream_info != (DCMStreamInfo *) NULL)
-    stream_info=(DCMStreamInfo *) RelinquishMagickMemory(stream_info);
+    {
+      if (stream_info->offsets != (ssize_t *) NULL)
+        stream_info->offsets=(ssize_t *) RelinquishMagickMemory(
+          stream_info->offsets);
+      stream_info=(DCMStreamInfo *) RelinquishMagickMemory(stream_info);
+      stream_info=(DCMStreamInfo *) NULL;
+    }
   if (stack != (LinkedListInfo *) NULL)
     stack=DestroyLinkedList(stack,RelinquishDCMInfo);
   if (data != (unsigned char *) NULL)
@@ -3049,11 +3055,10 @@ static inline void RelinquishDCMMemory(DCMInfo *info,DCMMap *map,
 
 static Image *ReadDCMImage(const ImageInfo *image_info,ExceptionInfo *exception)
 {
-#define ThrowDCMException(exception,message) \
-{ \
-  RelinquishDCMMemory(&info,&map,stream_info,stack,data); \
-  ThrowReaderException((exception),(message)); \
-}
+#define ThrowDCMException(exception,message) {   /* Avoid dereferencing possibly-stale stream_info or stack on error paths.
+     Pass NULL for stream_info and stack to the cleanup function to prevent
+     use-after-free; this trades a small leak on error paths for safety. */   RelinquishDCMMemory(&info,&map,(DCMStreamInfo *) NULL,(LinkedListInfo *) NULL,data);   ThrowReaderException((exception),(message)); }
+
 
   char
     explicit_vr[MagickPathExtent],