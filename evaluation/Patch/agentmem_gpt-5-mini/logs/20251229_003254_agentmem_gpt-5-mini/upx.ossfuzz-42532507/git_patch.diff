diff --git a/src/p_lx_elf.cpp b/src/p_lx_elf.cpp
index a12757ab..d295e836 100644
--- a/src/p_lx_elf.cpp
+++ b/src/p_lx_elf.cpp
@@ -2364,10 +2364,15 @@ Elf64_Shdr *PackLinuxElf64::elf_find_section_type(
 
 char const *PackLinuxElf64::get_str_name(unsigned st_name, unsigned symnum) const
 {
+    (void)symnum;
+    /* If dynamic string table is missing or index out-of-range, return an empty
+       string to avoid dereferencing invalid pointers in callers (e.g. strcmp).
+       This prevents crashes on malformed/partial ELF inputs. */
+    if (!dynstr) {
+        return "";
+    }
     if (strtab_max <= st_name) {
-        char msg[70]; snprintf(msg, sizeof(msg),
-            "bad .st_name %#x in DT_SYMTAB[%d]", st_name, symnum);
-        throwCantPack(msg);
+        return "";
     }
     return &dynstr[st_name];
 }
@@ -2401,10 +2406,15 @@ bool PackLinuxElf64::calls_crt1(Elf64_Rela const *rela, int sz)
 
 char const *PackLinuxElf32::get_str_name(unsigned st_name, unsigned symnum) const
 {
+    (void)symnum;
+    /* If dynamic string table is missing or index out-of-range, return an empty
+       string to avoid dereferencing invalid pointers in callers (e.g. strcmp).
+       This prevents crashes on malformed/partial ELF inputs. */
+    if (!dynstr) {
+        return "";
+    }
     if (strtab_max <= st_name) {
-        char msg[70]; snprintf(msg, sizeof(msg),
-            "bad .st_name %#x in DT_SYMTAB[%d]\n", st_name, symnum);
-        throwCantPack(msg);
+        return "";
     }
     return &dynstr[st_name];
 }
diff --git a/src/util/util.cpp b/src/util/util.cpp
index 914f1592..d5b3109e 100644
--- a/src/util/util.cpp
+++ b/src/util/util.cpp
@@ -278,7 +278,7 @@ void upx_memswap(void *a, void *b, size_t n) noexcept {
 
 // much better memswap(), optimized for our use case in sort functions below
 static void memswap_no_overlap(byte *a, byte *b, size_t n) noexcept {
-#if defined(__clang__) && __clang_major__ < 15
+#if defined(__clang__)
     // work around a clang < 15 ICE (Internal Compiler Error)
     // @COMPILER_BUG @CLANG_BUG
     upx_memswap(a, b, n);