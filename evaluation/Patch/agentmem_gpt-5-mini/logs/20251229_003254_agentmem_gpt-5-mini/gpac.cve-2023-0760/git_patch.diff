diff --git a/src/isomedia/box_code_base.c b/src/isomedia/box_code_base.c
index baf07ff35..ee34fb96d 100644
--- a/src/isomedia/box_code_base.c
+++ b/src/isomedia/box_code_base.c
@@ -9994,6 +9994,16 @@ static void *sgpd_parse_entry(u32 grouping_type, GF_BitStream *bs, s32 bytes_in_
 	GF_SAFEALLOC(def_ptr, GF_DefaultSampleGroupDescriptionEntry);
 	if (!def_ptr) return NULL;
 	if (entry_size) {
+		/* validate that declared entry_size fits in remaining box bytes to avoid OOB reads */
+		
+			if (bytes_in_box <= 0 || (u32)bytes_in_box < entry_size) {
+				GF_LOG(GF_LOG_WARNING, GF_LOG_CONTAINER, ("[iso file] sgpd entry size %u larger than remaining box size %d, skip\n", entry_size, bytes_in_box));
+				gf_free(def_ptr);
+				return NULL;
+			}
+
+
+
 		def_ptr->length = entry_size;
 		def_ptr->data = (u8 *) gf_malloc(sizeof(u8)*def_ptr->length);
 		if (!def_ptr->data) {
diff --git a/src/isomedia/isom_read.c b/src/isomedia/isom_read.c
index ba474c335..bb8c0e424 100644
--- a/src/isomedia/isom_read.c
+++ b/src/isomedia/isom_read.c
@@ -5862,8 +5862,14 @@ Bool gf_isom_is_identical_sgpd(void *ptr1, void *ptr2, u32 grouping_type)
 	if (grouping_type) {
 		sgpd_write_entry(grouping_type, ptr1, bs1);
 	} else {
-		gf_isom_box_size((GF_Box *)ptr1);
-		gf_isom_box_write((GF_Box *)ptr1, bs1);
+		/* defensive: ensure ptr1 is a valid SGPD box before calling box size/write */
+		GF_Box *b1 = (GF_Box *)ptr1;
+		if (!b1 || !b1->registry || (b1->type != GF_ISOM_BOX_TYPE_SGPD && b1->type != GF_ISOM_BOX_TYPE_SGPD)) {
+			gf_bs_del(bs1);
+			return GF_FALSE;
+		}
+		gf_isom_box_size(b1);
+		gf_isom_box_write(b1, bs1);
 	}
 	gf_bs_get_content(bs1, &buf1, &len1);
 	gf_bs_del(bs1);
@@ -5872,7 +5878,14 @@ Bool gf_isom_is_identical_sgpd(void *ptr1, void *ptr2, u32 grouping_type)
 	if (grouping_type) {
 		sgpd_write_entry(grouping_type, ptr2, bs2);
 	} else {
-		gf_isom_box_write((GF_Box *)ptr2, bs2);
+		GF_Box *b2 = (GF_Box *)ptr2;
+		if (!b2 || !b2->registry || (b2->type != GF_ISOM_BOX_TYPE_SGPD && b2->type != GF_ISOM_BOX_TYPE_SGPD)) {
+			gf_free(buf1);
+			gf_bs_del(bs2);
+			return GF_FALSE;
+		}
+		gf_isom_box_size(b2);
+		gf_isom_box_write(b2, bs2);
 	}
 	gf_bs_get_content(bs2, &buf2, &len2);
 	gf_bs_del(bs2);