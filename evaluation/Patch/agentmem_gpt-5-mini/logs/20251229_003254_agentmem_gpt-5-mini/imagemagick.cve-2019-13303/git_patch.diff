diff --git a/MagickCore/composite.c b/MagickCore/composite.c
index 78d6dff92..91ea1e472 100644
--- a/MagickCore/composite.c
+++ b/MagickCore/composite.c
@@ -662,7 +662,8 @@ MagickExport MagickBooleanType CompositeImage(Image *image,
               channel);
             if (traits == UndefinedPixelTrait)
               continue;
-            if (source_traits != UndefinedPixelTrait)
+            ssize_t source_channels=(ssize_t) GetPixelChannels(source_image);
+            if ((i < source_channels) && (source_traits != UndefinedPixelTrait))
               SetPixelChannel(image,channel,p[i],q);
             else if (channel == AlphaPixelChannel)
               SetPixelChannel(image,channel,OpaqueAlpha,q);
diff --git a/MagickCore/image.c b/MagickCore/image.c
index 169a4b1c8..973842e0c 100644
--- a/MagickCore/image.c
+++ b/MagickCore/image.c
@@ -1114,6 +1114,7 @@ MagickExport MagickBooleanType CopyImagePixels(Image *image,
         status=MagickFalse;
         continue;
       }
+    ssize_t source_channels=(ssize_t) GetPixelChannels(source_image);
     for (x=0; x < (ssize_t) geometry->width; x++)
     {
       register ssize_t
@@ -1128,7 +1129,8 @@ MagickExport MagickBooleanType CopyImagePixels(Image *image,
             ((traits & UpdatePixelTrait) == 0) ||
             (source_traits == UndefinedPixelTrait))
           continue;
-        SetPixelChannel(image,channel,p[i],q);
+        if (i < source_channels)
+          SetPixelChannel(image,channel,p[i],q);
       }
       p+=GetPixelChannels(source_image);
       q+=GetPixelChannels(image);