diff --git a/Zend/zend_object_handlers.c b/Zend/zend_object_handlers.c
index 60bfeb0f2a2..019b709c008 100644
--- a/Zend/zend_object_handlers.c
+++ b/Zend/zend_object_handlers.c
@@ -711,6 +711,7 @@ static zend_always_inline bool property_uses_strict_types() {
 ZEND_API zval *zend_std_write_property(zend_object *zobj, zend_string *name, zval *value, void **cache_slot) /* {{{ */
 {
 	zval *variable_ptr, tmp;
+	int zobj_protected = 0;
 	uintptr_t property_offset;
 	zend_property_info *prop_info = NULL;
 	ZEND_ASSERT(!Z_ISREF_P(value));
@@ -723,6 +724,8 @@ ZEND_API zval *zend_std_write_property(zend_object *zobj, zend_string *name, zva
 			Z_TRY_ADDREF_P(value);
 
 			if (UNEXPECTED(prop_info)) {
+				/* protect object during verification */
+				if (!zobj_protected) { GC_ADDREF(zobj); zobj_protected = 1; }
 				ZVAL_COPY_VALUE(&tmp, value);
 				if (UNEXPECTED(!zend_verify_property_type(prop_info, &tmp, property_uses_strict_types()))) {
 					Z_TRY_DELREF_P(value);
@@ -787,6 +790,8 @@ write_std_property:
 
 			Z_TRY_ADDREF_P(value);
 			if (UNEXPECTED(prop_info)) {
+				/* protect object during verification */
+				if (!zobj_protected) { GC_ADDREF(zobj); zobj_protected = 1; }
 				ZVAL_COPY_VALUE(&tmp, value);
 				if (UNEXPECTED(!zend_verify_property_type(prop_info, &tmp, property_uses_strict_types()))) {
 					zval_ptr_dtor(value);
@@ -814,6 +819,8 @@ write_std_property:
 	}
 
 exit:
+	/* ensure object is released if protected */
+	if (zobj_protected) { OBJ_RELEASE(zobj); zobj_protected = 0; }
 	return variable_ptr;
 }
 /* }}} */