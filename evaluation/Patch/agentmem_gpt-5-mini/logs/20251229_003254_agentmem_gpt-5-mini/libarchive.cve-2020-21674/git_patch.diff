diff --git a/libarchive/archive_string.c b/libarchive/archive_string.c
index bd39c96f..2bcc52bf 100644
--- a/libarchive/archive_string.c
+++ b/libarchive/archive_string.c
@@ -793,7 +793,7 @@ archive_string_append_from_wcs(struct archive_string *as,
 	 * We need this allocation here since it is possible that
 	 * as->s is still NULL.
 	 */
-	if (archive_string_ensure(as, as->length + len + 1) == NULL)
+	if (archive_string_ensure(as, as->length + len * MB_CUR_MAX + 1) == NULL)
 		return (-1);
 
 	p = as->s + as->length;
@@ -803,8 +803,7 @@ archive_string_append_from_wcs(struct archive_string *as,
 			as->length = p - as->s;
 			as->s[as->length] = '\0';
 			/* Re-allocate buffer for MBS. */
-			if (archive_string_ensure(as,
-			    as->length + len * 2 + 1) == NULL)
+			if (archive_string_ensure(as, as->length + len * MB_CUR_MAX + 1) == NULL)
 				return (-1);
 			p = as->s + as->length;
 			end = as->s + as->buffer_length - MB_CUR_MAX -1;
@@ -2643,7 +2642,7 @@ strncat_from_utf8_to_utf8(struct archive_string *as, const void *_p,
 
 	(void)sc; /* UNUSED */
 
-	if (archive_string_ensure(as, as->length + len + 1) == NULL)
+	if (archive_string_ensure(as, as->length + len * MB_CUR_MAX + 1) == NULL)
 		return (-1);
 
 	s = (const char *)_p;
@@ -3433,7 +3432,7 @@ strncat_from_utf8_libarchive2(struct archive_string *as,
 	 * We need this allocation here since it is possible that
 	 * as->s is still NULL.
 	 */
-	if (archive_string_ensure(as, as->length + len + 1) == NULL)
+	if (archive_string_ensure(as, as->length + len * MB_CUR_MAX + 1) == NULL)
 		return (-1);
 
 	s = (const char *)_p;
@@ -3445,8 +3444,7 @@ strncat_from_utf8_libarchive2(struct archive_string *as,
 		if (p >= end) {
 			as->length = p - as->s;
 			/* Re-allocate buffer for MBS. */
-			if (archive_string_ensure(as,
-			    as->length + len * 2 + 1) == NULL)
+			if (archive_string_ensure(as, as->length + len * MB_CUR_MAX + 1) == NULL)
 				return (-1);
 			p = as->s + as->length;
 			end = as->s + as->buffer_length - MB_CUR_MAX -1;