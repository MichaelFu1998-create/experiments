diff --git a/MagickCore/threshold.c b/MagickCore/threshold.c
index a3bb96a21..6c920cb24 100644
--- a/MagickCore/threshold.c
+++ b/MagickCore/threshold.c
@@ -208,6 +208,7 @@ MagickExport Image *AdaptiveThresholdImage(const Image *image,
   if (image->debug != MagickFalse)
     (void) LogMagickEvent(TraceEvent,GetMagickModule(),"%s",image->filename);
   assert(exception != (ExceptionInfo *) NULL);
+
   assert(exception->signature == MagickCoreSignature);
   threshold_image=CloneImage(image,0,0,MagickTrue,exception);
   if (threshold_image == (Image *) NULL)
@@ -223,7 +224,9 @@ MagickExport Image *AdaptiveThresholdImage(const Image *image,
   */
   status=MagickTrue;
   progress=0;
-  number_pixels=(MagickSizeType) width*height;
+    size_t window_width = width ? width : 1;
+  size_t window_height = height ? height : 1;
+number_pixels=(MagickSizeType) window_width*window_height;
   image_view=AcquireVirtualCacheView(image,exception);
   threshold_view=AcquireAuthenticCacheView(threshold_image,exception);
 #if defined(MAGICKCORE_OPENMP_SUPPORT)
@@ -254,8 +257,8 @@ MagickExport Image *AdaptiveThresholdImage(const Image *image,
 
     if (status == MagickFalse)
       continue;
-    p=GetCacheViewVirtualPixels(image_view,-((ssize_t) width/2L),y-(ssize_t)
-      (height/2L),image->columns+width,height,exception);
+    p=GetCacheViewVirtualPixels(image_view,-((ssize_t) window_width/2L),y-(ssize_t)
+      (window_height/2L),image->columns+window_width,window_height,exception);
     q=QueueCacheViewAuthenticPixels(threshold_view,0,y,threshold_image->columns,
       1,exception);
     if ((p == (const Quantum *) NULL) || (q == (Quantum *) NULL))
@@ -263,8 +266,8 @@ MagickExport Image *AdaptiveThresholdImage(const Image *image,
         status=MagickFalse;
         continue;
       }
-    center=(ssize_t) GetPixelChannels(image)*(image->columns+width)*(height/2L)+
-      GetPixelChannels(image)*(width/2);
+    center=(ssize_t) GetPixelChannels(image)*(image->columns+window_width)*(window_height/2L)+
+      GetPixelChannels(image)*(window_width/2);
     for (i=0; i < (ssize_t) GetPixelChannels(image); i++)
     {
       PixelChannel channel = GetPixelChannelChannel(image,i);
@@ -282,11 +285,11 @@ MagickExport Image *AdaptiveThresholdImage(const Image *image,
       pixels=p;
       channel_bias[channel]=0.0;
       channel_sum[channel]=0.0;
-      for (v=0; v < (ssize_t) height; v++)
+      for (v=0; v < (ssize_t) window_height; v++)
       {
-        for (u=0; u < (ssize_t) width; u++)
+        for (u=0; u < (ssize_t) window_width; u++)
         {
-          if (u == (ssize_t) (width-1))
+          if (u == (ssize_t) (window_width-1))
             channel_bias[channel]+=pixels[i];
           channel_sum[channel]+=pixels[i];
           pixels+=GetPixelChannels(image);
@@ -316,10 +319,10 @@ MagickExport Image *AdaptiveThresholdImage(const Image *image,
         channel_sum[channel]-=channel_bias[channel];
         channel_bias[channel]=0.0;
         pixels=p;
-        for (v=0; v < (ssize_t) height; v++)
+        for (v=0; v < (ssize_t) window_height; v++)
         {
           channel_bias[channel]+=pixels[i];
-          pixels+=(width-1)*GetPixelChannels(image);
+          pixels+=(window_width-1)*GetPixelChannels(image);
           channel_sum[channel]+=pixels[i];
           pixels+=GetPixelChannels(image)*(image->columns+1);
         }