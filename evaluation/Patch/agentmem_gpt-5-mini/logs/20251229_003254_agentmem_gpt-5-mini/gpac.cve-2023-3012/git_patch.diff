diff --git a/src/utils/xml_parser.c b/src/utils/xml_parser.c
index 49df33816..378b81b0e 100644
--- a/src/utils/xml_parser.c
+++ b/src/utils/xml_parser.c
@@ -48,7 +48,7 @@ static char *xml_translate_xml_string(char *str)
 {
 	char *value;
 	u32 size, i, j;
-	if (!str || !strlen(str)) return NULL;
+	if (!str || !strlen(str)) return gf_strdup("");
 	value = (char *)gf_malloc(sizeof(char) * 500);
 	size = 500;
 	i = j = 0;
@@ -1031,6 +1031,17 @@ static GF_Err gf_xml_sax_parse_intern(GF_SAXParser *parser, char *current)
 			entityEnd = strstr(current, ";");
 			if (!entityEnd) return xml_sax_append_string(parser, current);
 			entityStart = strrchr(parser->buffer, '&');
+				if (!entityStart) {
+					parser->in_entity = GF_FALSE;
+					return xml_sax_append_string(parser, current);
+				}
+
+			/* Defensive: if the stored entity start '&' is no longer present in the parser buffer (possible with truncated or malformed input), avoid calling strlen on NULL. Append the current chunk and continue parsing. */
+			if (!entityStart) {
+				parser->in_entity = GF_FALSE;
+				return xml_sax_append_string(parser, current);
+			}
+
 
 			entityEnd[0] = 0;
 			len = (u32) strlen(entityStart) + (u32) strlen(current) + 1;